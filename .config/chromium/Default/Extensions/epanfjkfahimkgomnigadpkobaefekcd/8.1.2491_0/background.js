/**
 * Blur Copyright (c) 2008-2015 by Abine, Inc. All Rights Reserved.
 *
 * This software is the confidential and proprietary information
 * of Abine, Inc. ("Confidential Information"), subject
 * to the Non-Disclosure Agreement and/or License Agreement you entered
 * into with Abine. You shall use such Confidential Information only
 * in accordance with the terms of said Agreement(s). Abine makes
 * no representations or warranties about the suitability of the
 * software. The software is provided with ABSOLUTELY NO WARRANTY
 * and Abine will NOT BE LIABLE for ANY DAMAGES resulting from
 * the use of the software.
 *
 * Contact license@getabine.com with any license-related questions.
 *
 * https://www.abine.com
 * @license
 *
 */
ABINE_DNTME.define("abine/url",function(){function e(e){return e?e.toLowerCase().replace(/\w+/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1)}):e}function t(e){var t=e.match(s);return t&&t.length>1?t[1].toString():e}function n(e){var n=t(e);if(n.match(o)||n.match(c))return n;var r=n.split(".");if(r.length<2)return n;var s=r.pop(),l=r.pop(),u=l+"."+s;if(i.test(u)&&r.length>0&&(s=u,l=r.pop(),u=l+"."+s),a.test(u)&&r.length>0&&!n.match(/signup.wordpress.com|new.aol.com|(oauth|www).squarespace.com|secure.onsugar.com|www.tumblr.com/i)){var d=r.pop();u=d+"."+u}return u}function r(t){if(t=n(t),t.match(o))return t;var r=t.split(".");if(r.length>2){var s=r.pop(),c=r.pop(),t=c+"."+s;if(i.test(t)&&r.length>0&&(s=t,c=r.pop(),t=c+"."+s),a.test(t)&&r.length>0){var l=r.pop();return e(c+" "+l)}return e(c)}return e(r[0])}var i=/^(((co|ac|go|ed|ga|mn|nj|nc|or|ne|in|gr|ca|on|pa|qc|bc|sh|at|va|us|il|tv|me|lg|at|ny|gv|com|edu|org|net|gov|mil|biz)\...)|(163\.com)|(kiev\.ua)|(gob\.pe)|(gen\.tr)|(waw.pl)|(jus.br))$/,a=/^(((go|typepad|tumblr|blogspot|squarespace|wordpress|myshopify|blogfa|blog|blogs|blinkweb|ning|posterous|over-blog|mihanblog|appspot|webs|weebly|onsugar|ucoz|uk|pch|ecwid)(\.com|\.in))|(nic\.in)|((ucoz|spb|narod)\.ru)|(blog\.163\.com)|((gouv|free)\.fr)|(uol\.com\.br)|(web\.id)|(gob\.mx)|(blogg\.se)|(home.pl))$/,s=/^http(?:s)?\:\/\/([^/\?\#]+)/im,o=/^[0-9\.]+(:[0-9]+)?$/,c=/^localhost(:[0-9]+)?$/,l={getHostname:t,getTLD:n,getSiteName:r};return l}),/**
 * Copyright (c) 2010 Zef Hemel <zef@zef.me>
 *
 * Permission is hereby granted, free of charge, to any person
 * obtaining a copy of this software and associated documentation
 * files (the "Software"), to deal in the Software without
 * restriction, including without limitation the rights to use,
 * copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the
 * Software is furnished to do so, subject to the following
 * conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 * OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 * WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 * OTHER DEALINGS IN THE SOFTWARE.
 */
ABINE_DNTME.define("persistence",[],function(){function initPersistence(e){if(e.isImmutable)return e;e.isImmutable=function(e){return"id"==e},e.defineProp=function(e,t,n,r){Object.defineProperty?Object.defineProperty(e,t,{get:function(){return r()},set:function(e){n(e)}}):(e.__defineSetter__(t,function(e){n(e)}),e.__defineGetter__(t,function(){return r()}))},e.set=function(t,n,r){if(e.isImmutable(n))throw new Error("immutable field: "+n);t[n]=r},e.get=function(e,t){return 1==arguments.length?e:e[t]},function(){function n(e){return _[e]}function r(e){this.trackedObjects={},this.trackedObjectsByEntity={},this.objectsToRemove={},this.objectsRemoved=[],this.globalPropertyListeners={},this.queryCollectionCache={},this.conn=e}function i(r){function a(n,i){var a=t.getArgs(arguments,[{name:"session",optional:!0,check:e.isSession,defaultValue:e},{name:"obj",optional:!0,check:function(e){return e},defaultValue:{}}]);if(c.isMixin)throw new Error("Cannot instantiate mixin");n=a.session,i=a.obj;var o=this;this.id=i.id||e.createUUID(),this._new=!0,this._type=r,this._dirtyProperties={},this._data={},this._data_obj={},this._session=n||e,this.subscribers={};for(var l in c.fields)!function(){if(c.fields.hasOwnProperty(l)){var t=l;e.defineProp(o,t,function(e){var r=o._data[t];(r!==e||r&&e&&r.getTime&&e.getTime)&&(o._data[t]=e,o._dirtyProperties[t]=r,o.triggerEvent("set",o,t,e),o.triggerEvent("change",o,t,e),n.propertyChanged(o,t,r,e))},function(){return o._data[t]}),o._data[l]=s(c.fields[l])}}();for(var u in c.hasOne)c.hasOne.hasOwnProperty(u)&&!function(){var t=u,r=c.hasOne[u].type.meta.isMixin?t+"_class":null;e.defineProp(o,t,function(e){var i=o._data[t],a=o._data_obj[t]||n.trackedObjects[o._data[t]];if(null==e?(o._data[t]=null,o._data_obj[t]=void 0,r&&(o[r]="")):e.id?(o._data[t]=e.id,o._data_obj[t]=e,r&&(o[r]=e._type),n.add(e),n.add(o)):o._data[t]=e,o._dirtyProperties[t]=i,o.triggerEvent("set",o,t,e),o.triggerEvent("change",o,t,e),c.hasOne[t].inverseProperty){var s=o[t];if(s){var l=s[c.hasOne[t].inverseProperty];l.list&&l._filter&&l.triggerEvent("change",o,t,e)}if(a){var l=a[c.hasOne[t].inverseProperty];l.list&&l._filter&&l.triggerEvent("change",o,t,e)}}},function(){if(o._data[t]){if(void 0!==o._data_obj[t])return o._data_obj[t];if(o._data[t]&&n.trackedObjects[o._data[t]])return o._data_obj[t]=n.trackedObjects[o._data[t]],o._data_obj[t];throw new Error("Property '"+t+"' of '"+c.name+"' with id: "+o._data[t]+" not fetched, either prefetch it or fetch it manually.")}return null})}();for(var u in c.hasMany)c.hasMany.hasOwnProperty(u)&&!function(){var t=u;c.hasMany[t].manyToMany?e.defineProp(o,t,function(n){if(!n||!n._items)throw new Error("Not yet supported.");for(var r=n._items,i=0;i<r.length;i++)e.get(o,t).add(r[i])},function(){if(o._data[t])return o._data[t];var r=c.hasMany[t],i=r.type.meta,a=i.hasMany[r.inverseProperty],s=r.mixin?r.mixin.meta.name:c.name,l=a.mixin?a.mixin.meta.name:i.name,u=new e.ManyToManyDbQueryCollection(n,i.name);return u.initManyToMany(o,t),u._manyToManyFetch={table:r.tableName,prop:s+"_"+t,inverseProp:l+"_"+r.inverseProperty,id:o.id},o._data[t]=u,n.uniqueQueryCollection(u)}):e.defineProp(o,t,function(n){if(!n||!n._items)throw new Error("Not yet supported.");for(var r=n._items,i=0;i<r.length;i++)e.get(o,t).add(r[i])},function(){if(o._data[t])return o._data[t];var r=n.uniqueQueryCollection(new e.DbQueryCollection(n,c.hasMany[t].type.meta.name).filter(c.hasMany[t].inverseProperty,"=",o));return o._data[t]=r,r})}();this.initialize&&this.initialize();for(var d in i)i.hasOwnProperty(d)&&"id"!==d&&e.set(o,d,i[d])}function o(t,r,i,a){var s=(t._session,[]),c=n(t._type),l=c.fields;for(var u in i)i.hasOwnProperty(u)&&s.push(u);var d=[],h=[];s.forEach(function(e){i[e]!==!0||c.hasMany[e]?h.push(e):d.push(e)});var f=t._data,p={};d.forEach(function(n){"id"===n?p.id=t.id:c.hasOne[n]?p[n]=f[n]?{id:f[n]}:null:p[n]=e.entityValToJson(f[n],l[n])}),s=h.slice(),e.asyncForEach(s,function(n,a){c.hasOne[n]?t.fetch(r,n,function(e){e?o(e,r,i[n],function(e){p[n]=e,a()}):(p[n]=null,a())}):c.hasMany[n]&&e.get(t,n).list(function(t){p[n]=[],e.asyncForEach(t,function(e,a){var e=t.pop();i[n]===!0?(p[n].push({id:e.id}),a()):o(e,r,i[n],function(e){p[n].push(e),a()})},a)})},function(){a(p)})}if(w[r])return w[r];var c=_[r];a.prototype=new u,a.meta=c,a.prototype.equals=function(e){return this.id==e.id},a.prototype.toJSON=function(){var e={id:this.id};for(var t in this._data)this._data.hasOwnProperty(t)&&("object"==typeof this._data[t]&&null!=this._data[t]?void 0!=this._data[t].toJSON&&(e[t]=this._data[t].toJSON()):e[t]=this._data[t]);return e},a.prototype.selectJSON=function(n,r,i){var a=this,s=t.getArgs(arguments,[{name:"tx",optional:!0,check:e.isTransaction,defaultValue:null},{name:"props",optional:!1},{name:"callback",optional:!1}]);if(n=s.tx,r=s.props,i=s.callback,!n)return void this._session.transaction(function(e){a.selectJSON(e,r,i)});var l={};r.forEach(function(e){for(var t=l,n=e.split("."),r=0;r<n.length;r++){var i=n[r];if(r===n.length-1)if("*"===i){t.id=!0;for(var a in c.fields)c.fields.hasOwnProperty(a)&&(t[a]=!0);for(var a in c.hasOne)c.hasOne.hasOwnProperty(a)&&(t[a]=!0);for(var a in c.hasMany)c.hasMany.hasOwnProperty(a)&&(t[a]=!0)}else if("["===i[0]){i=i.substring(1,i.length-1);var s=i.split(/,\s*/);s.forEach(function(e){t[e]=!0})}else t[i]=!0;else t[i]=t[i]||{},t=t[i]}}),o(this,n,l,i)},a.prototype.fetch=function(n,r,a){var s=t.getArgs(arguments,[{name:"tx",optional:!0,check:e.isTransaction,defaultValue:null},{name:"rel",optional:!1,check:t.hasType("string")},{name:"callback",optional:!1,check:t.isCallback()}]);n=s.tx,r=s.rel,a=s.callback;var o=this,l=this._session;if(!n)return void l.transaction(function(e){o.fetch(e,r,a)});if(this._data[r])if(this._data_obj[r])a&&a(this._data_obj[r]);else{var u=c.hasOne[r].type;u.meta.isMixin&&(u=i(this._data[r+"_class"])),u.load(l,n,this._data[r],function(e){o._data_obj[r]=e,a&&a(e)})}else a&&a(null)},a.prototype.markDirty=function(e){this._dirtyProperties[e]=!0},a.all=function(n){var i=t.getArgs(arguments,[{name:"session",optional:!0,check:e.isSession,defaultValue:e}]);return n=i.session,n.uniqueQueryCollection(new y(n,r))},a.query=function(t,n){e.transaction(function(e){var i="";t&&(i=" where "+t),e.executeSql("SELECT * FROM "+r+i,null,function(e){n(e)})})},a.deleteQuery=function(t,n){e.transaction(function(e){var i="";t&&(i=" where "+t),e.executeSql("DELETE FROM "+r+i,null,function(e){n(e)})})},a.fromSelectJSON=function(n,r,i,s){function o(t){t||(t=new a(n),i.id&&(t.id=i.id)),n.add(t);var o=[];for(var l in i)if(i.hasOwnProperty(l)){if("id"===l)continue;c.fields[l]?e.set(t,l,e.jsonToEntityVal(i[l],c.fields[l])):(c.hasOne[l]||c.hasMany[l])&&o.push(l)}e.asyncForEach(o,function(a,s){if(c.hasOne[a])c.hasOne[a].type.fromSelectJSON(n,r,i[a],function(n){e.set(t,a,n),s()});else if(c.hasMany[a]){var o=e.get(t,a),l=i[a].slice(0),u=c.hasMany[a].type;o.list(r,function(t){e.asyncForEach(l,function(e,i){u.fromSelectJSON(n,r,e,function(e){for(var n=0;n<t.length;n++)if(t[n].id===e.id)return void i();o.add(e),i()})},function(){s()})})}},function(){s(t)})}var l=t.getArgs(arguments,[{name:"session",optional:!0,check:e.isSession,defaultValue:e},{name:"tx",optional:!0,check:e.isTransaction,defaultValue:null},{name:"jsonObj",optional:!1},{name:"callback",optional:!1,check:t.isCallback()}]);return n=l.session,r=l.tx,i=l.jsonObj,s=l.callback,r?("string"==typeof i&&(i=JSON.parse(i)),i?void(i.id?a.load(n,r,i.id,o):o(new a(n))):void s(null)):void n.transaction(function(e){a.fromSelectJSON(n,e,i,s)})},a.load=function(){var n=t.getArgs(arguments,[{name:"session",optional:!0,check:e.isSession,defaultValue:e},{name:"tx",optional:!0,check:e.isTransaction,defaultValue:null},{name:"id",optional:!1,check:t.hasType("string")},{name:"callback",optional:!0,check:t.isCallback(),defaultValue:function(){}}]);a.findBy(n.session,n.tx,"id",n.id,n.callback)},a.findBy=function(n,r,i,s,o){var c=t.getArgs(arguments,[{name:"session",optional:!0,check:e.isSession,defaultValue:e},{name:"tx",optional:!0,check:e.isTransaction,defaultValue:null},{name:"property",optional:!1,check:t.hasType("string")},{name:"value",optional:!1},{name:"callback",optional:!0,check:t.isCallback(),defaultValue:function(){}}]);if(n=c.session,r=c.tx,i=c.property,s=c.value,o=c.callback,"id"===i&&s in n.trackedObjects)return void o(n.trackedObjects[s]);var l=a.meta;if(l.alternatePK&&i===l.alternatePK&&n.trackedObjectsByEntity){var u=l.name+"."+l.alternatePK;if(!(u in n.trackedObjectsByEntity&&s in n.trackedObjectsByEntity[u]))return a.cached?void o(null):void a.initCache(function(){a.findBy(n,r,i,s,o)});if(n.trackedObjectsByEntity[u][s]in n.trackedObjects)return void o(n.trackedObjects[n.trackedObjectsByEntity[u][s]]);delete n.trackedObjectsByEntity[u][s]}return r?void a.all(n).filter(i,"=",s).one(r,function(e){o(e)}):void n.transaction(function(e){a.findBy(n,e,i,s,o)})},a.index=function(e,t){var n=t||{};"string"==typeof e&&(e=[e]),n.columns=e,c.indexes.push(n)},a.hasMany=function(t,n,r){var i=n.meta;if(i.hasMany[r]){var s=c.name+"_"+t+"_"+i.name,o=i.name+"_"+r+"_"+c.name;s>o&&(s=o),c.hasMany[t]={type:n,inverseProperty:r,manyToMany:!0,tableName:s},i.hasMany[r]={type:a,inverseProperty:t,manyToMany:!0,tableName:s},delete c.hasOne[t],delete c.fields[t+"_class"]}else c.hasMany[t]={type:n,inverseProperty:r},i.hasOne[r]={type:a,inverseProperty:t},c.isMixin&&(i.fields[r+"_class"]=e.typeMapper?e.typeMapper.classNameType:"TEXT")},a.hasOne=function(t,n,r){c.hasOne[t]={type:n,inverseProperty:r},n.meta.isMixin&&(c.fields[t+"_class"]=e.typeMapper?e.typeMapper.classNameType:"TEXT")},a.is=function(e){var t=e.meta;if(!t.isMixin)throw new Error("not a mixin: "+e);e.meta.mixedIns=e.meta.mixedIns||[],e.meta.mixedIns.push(c);for(var n in t.fields)t.fields.hasOwnProperty(n)&&(c.fields[n]=t.fields[n]);for(var r in t.hasOne)t.hasOne.hasOwnProperty(r)&&(c.hasOne[r]=t.hasOne[r]);for(var r in t.hasMany)t.hasMany.hasOwnProperty(r)&&(t.hasMany[r].mixin=e,c.hasMany[r]=t.hasMany[r])};for(var l=e.entityDecoratorHooks,d=0;d<l.length;d++)l[d](a);return w[r]=a,a}function a(){if(e.typeMapper&&e.typeMapper.newUuid)return e.typeMapper.newUuid();for(var t=[],n="0123456789ABCDEF",r=0;r<32;r++)t[r]=n.substr(Math.floor(16*Math.random()),1);t[12]="4",t[16]=n.substr(3&t[16]|8,1);var i=t.join("");return i}function s(t){if(e.typeMapper&&e.typeMapper.defaultValue)return e.typeMapper.defaultValue(t);switch(t){case"TEXT":return"";case"BOOL":return!1;default:return t.indexOf("INT")!==-1?0:t.indexOf("CHAR")!==-1?"":null}}function o(e,t){for(var n=e.length,r=0;r<n;r++){var i=e[r];if(i.equals&&i.equals(t))return!0;if(i===t)return!0}return!1}function c(e,t){for(var n=e.length,r=0;r<n;r++){var i=e[r];if(i.equals&&i.equals(t))return void e.splice(r,1);if(i===t)return void e.splice(r,1)}}function l(e,t,n){this.obj=e,this.eventType=t,this.fn=n}function u(){this.subscribers={}}function d(){}function h(e,t){this.left=e,this.right=t}function f(e,t){this.left=e,this.right=t}function p(e,t,n){this.property=e,this.operator=t.toLowerCase(),this.value=n}function m(){}function g(e,t){this.init(e,t,g)}function y(e,t){this.init(e,t,y)}function b(t,n){this.init(t,n,e.ManyToManyDbQueryCollection),this._localAdded=[],this._localRemoved=[]}function v(t){this.init(e,null,v),this._items=t||[]}var _={},w={};e.getEntityMeta=function(){return _},e.trackedObjects={},e.trackedObjectsByEntity={},e.objectsToRemove={},e.objectsRemoved=[],e.globalPropertyListeners={},e.queryCollectionCache={},e.getObjectsToRemove=function(){return this.objectsToRemove},e.getTrackedObjects=function(){return this.trackedObjects},e.entityDecoratorHooks=[],e.flushHooks=[],e.schemaSyncHooks=[],e.debug=!1,e.subscribeToGlobalPropertyListener=function(e,t,n){var r=t+"__"+n;if(r in this.globalPropertyListeners){for(var i=this.globalPropertyListeners[r],a=0;a<i.length;a++)if(i[a]===e)return;this.globalPropertyListeners[r].push(e)}else this.globalPropertyListeners[r]=[e]},e.unsubscribeFromGlobalPropertyListener=function(e,t,n){for(var r=t+"__"+n,i=this.globalPropertyListeners[r],a=0;a<i.length;a++)if(i[a]===e)return void i.splice(a,1)},e.propertyChanged=function(e,t,n,r){if(this.trackedObjects[e.id]){var i=e._type,a=i+"__"+t;if(a in this.globalPropertyListeners)for(var s=this.globalPropertyListeners[a],o=0;o<s.length;o++){var c=s[o],l=e._data;l[t]=n;var u=c._filter.match(l);l[t]=r;var d=c._filter.match(l);u!=d&&c.triggerEvent("change",c,e)}}},e.objectRemoved=function(e){var t=e._type;if(this.queryCollectionCache[t]){var n=this.queryCollectionCache[t];for(var r in n)if(n.hasOwnProperty(r)){var i=n[r];i._filter.match(e)&&i.triggerEvent("change",i,e)}}},e.getMeta=n,r.prototype=e,e.Session=r,e.undefine=function(e){w[e]&&delete w[e],e in _&&delete _[e]},e.define=function(e,t){if(_[e])return i(e);var n={name:e,fields:t,isMixin:!1,indexes:[],hasMany:{},hasOne:{}};return _[e]=n,i(e)},e.isDefined=function(e){return!!_[e]},e.defineMixin=function(e,t){var n=this.define(e,t);return n.meta.isMixin=!0,n},e.isTransaction=function(e){return!e||e&&e.executeSql},e.isSession=function(e){return!e||e&&e.schemaSync},e.addToEntityCache=function(e){var t=w[e._type];if(t.meta.cached){var n=t.meta.alternatePK||"id";if(n){var r=e._type+"."+n;r in this.trackedObjectsByEntity||(this.trackedObjectsByEntity[r]={}),this.trackedObjectsByEntity[r][e[n]]=e.id}}this.addIndex(e)},e.clearFromEntityCache=function(e){if(e){var t=w[e._type];if(t.meta.cached){var n=t.meta.alternatePK||"id";if(n){var r=e._type+"."+n;r in this.trackedObjectsByEntity&&(e.id==this.trackedObjectsByEntity[r][e[n]]&&delete this.trackedObjectsByEntity[r][e[n]],e.id in this.trackedObjects&&delete this.trackedObjects[e.id])}}this.removeIndex(e)}},e.addIndex=function(e){if(e){var t=w[e._type];if(t.meta.indexed){var n=(e[t.meta.indexed]||"").toString().toLowerCase(),r=e._type+"."+n;r in this.trackedObjectsByEntity||(this.trackedObjectsByEntity[r]={}),this.trackedObjectsByEntity[r][e.id]=!0}}},e.removeIndex=function(e){if(e){var t=w[e._type];if(t.meta.indexed){var n=(e[t.meta.indexed]||"").toString().toLowerCase(),r=e._type+"."+n;r in this.trackedObjectsByEntity&&delete this.trackedObjectsByEntity[r][e.id]}}},e.getEntityByAlternatePK=function(e,t){var n=e.meta.alternatePK;if(n){var r=e.meta.name+"."+n;if(r in this.trackedObjectsByEntity&&t in this.trackedObjectsByEntity[r])return this.trackedObjects[this.trackedObjectsByEntity[r][t]]}return null},e.getEntitiesByIndex=function(e,t){var n=e.meta.indexed;if(n){t=(t||"").toString().toLowerCase();var r=e.meta.name+"."+t;if(r in this.trackedObjectsByEntity){var i=[];for(var a in this.trackedObjectsByEntity[r])this.trackedObjectsByEntity[r].hasOwnProperty(a)&&a in this.trackedObjects&&this.trackedObjects[a][n]==t&&i.push(this.trackedObjects[a]);return i}}return[]},e.getCachedEntities=function(e){var t=[];if(e.meta.cached){var n=e.meta.alternatePK||"id";if(n){var r=e.meta.name+"."+n;if(r in this.trackedObjectsByEntity){var i=this.trackedObjectsByEntity[r];for(var a in i)i[a]in this.trackedObjects?t.push(this.trackedObjects[i[a]]):delete i[a]}}}return t},e.add=function(e){if(e){if(!this.trackedObjects[e.id]&&(this.trackedObjects[e.id]=e,this.addToEntityCache(e),e._new))for(var t in e._data)e._data.hasOwnProperty(t)&&this.propertyChanged(e,t,void 0,e._data[t]);return this}},e.forceAdd=function(t){if(t){if(!this.trackedObjects[t.id]||this.trackedObjects[t.id]!=t){var n=w[t._type];if(n.meta.cached){var r=n.meta.alternatePK;if(r){var i=e.getEntityByAlternatePK(n,t[r]);!i||i.id in this.objectsToRemove||i.id!=t.id&&(t.id=i.id)}}if(this.trackedObjects[t.id]=t,this.addToEntityCache(t),t._new)for(var a in t._data)t._data.hasOwnProperty(a)&&this.propertyChanged(t,a,void 0,t._data[a])}return this}},e.remove=function(e){this.objectsToRemove[e.id]||(this.objectsToRemove[e.id]=e),this.objectsRemoved.push({id:e.id,entity:e._type});try{delete this.trackedObjects[e.id]}catch(e){}return this.clearFromEntityCache(e),this.objectRemoved(e),this},e.clean=function(){this.trackedObjects={},this.objectsToRemove={},this.objectsRemoved=[],this.globalPropertyListeners={},this.queryCollectionCache={},this.trackedObjectsByEntity={},e.GlobalEvent.triggerEvent("clean")},e.asyncForEach=function(e,t,n){function r(){var i=e.pop();t(i,function(t,i){e.length>0?r():n(t,i)})}e=e.slice(0),e.length>0?r():n()},e.asyncParForEach=function(e,t,n){var r=0,i=e.length;0===i&&n();for(var a=0;a<i;a++)t(e[a],function(e,t){r++,r===i&&n(e,t)})},e.jsonToEntityVal=function(e,t){if(!t)return e;switch(t){case"DATE":return"number"==typeof e?e>1e12?new Date(e):new Date(1e3*e):null;default:return e}},e.entityValToJson=function(e,t){if(!t)return e;switch(t){case"DATE":return e?(e=new Date(e),Math.round(e.getTime()/1e3)):null;default:return e}},e.dump=function(n,r,i){var a=t.getArgs(arguments,[{name:"tx",optional:!0,check:e.isTransaction,defaultValue:null},{name:"entities",optional:!0,check:function(e){return!e||e&&e.length&&!e.apply},defaultValue:null},{name:"callback",optional:!1,check:t.isCallback(),defaultValue:function(){}}]);if(n=a.tx,r=a.entities,i=a.callback,!r){r=[];for(var s in w)w.hasOwnProperty(s)&&r.push(w[s])}var o={};e.asyncParForEach(r,function(t,r){t.all().list(n,function(i){var a=[];e.asyncParForEach(i,function(r,i){var s={},o=t.meta.fields;for(var c in o)o.hasOwnProperty(c)&&(s[c]=e.entityValToJson(r._data[c],o[c]));var l=t.meta.hasOne;for(var u in l)l.hasOwnProperty(u)&&(s[u]=r._data[u]);var d=t.meta.hasMany,h=[];for(var f in d)d.hasOwnProperty(f)&&h.push(f);e.asyncParForEach(h,function(t,i){var a=e.get(r,t);a.list(n,function(e){s[t]=e.map(function(e){return e.id}),i()})},function(){s.id=r.id,a.push(s),i()})},function(){o[t.meta.name]=a,r()})})},function(){i(o)})},e.load=function(n,r,a){var s=t.getArgs(arguments,[{name:"tx",optional:!0,check:e.isTransaction,defaultValue:null},{name:"dump",optional:!1},{name:"callback",optional:!0,check:t.isCallback(),defaultValue:function(){}}]);n=s.tx,r=s.dump,a=s.callback;var o=[],c=this;for(var l in r)if(r.hasOwnProperty(l))for(var u=i(l),d=u.meta.fields,h=r[l],f=0;f<h.length;f++){var p=h[f],m=new u;m.id=p.id;for(var g in p)if(p.hasOwnProperty(g))if(e.isImmutable(g))m[g]=p[g];else if(u.meta.hasMany[g]){var y=u.meta.hasMany[g];if(y.manyToMany&&u.meta.name<y.type.meta.name)continue;var b=e.get(m,g);p[g].length>0&&p[g].forEach(function(e){o.push({Entity:u,coll:b,id:e})})}else e.set(m,g,e.jsonToEntityVal(p[g],d[g]));this.add(m)}c.flush(n,function(){e.asyncForEach(o,function(e,t){e.Entity.load(c,n,e.id,function(n){e.coll.add(n),t()})},function(){c.flush(n,a)})})},e.dumpToJson=function(n,r,i){var a=t.getArgs(arguments,[{name:"tx",optional:!0,check:e.isTransaction,defaultValue:null},{name:"entities",optional:!0,check:function(e){return e&&e.length&&!e.apply},defaultValue:null},{name:"callback",optional:!1,check:t.isCallback(),defaultValue:function(){}}]);n=a.tx,r=a.entities,i=a.callback,this.dump(n,r,function(e){i(JSON.stringify(e))})},e.dumpDatabaseForSync=function(n,r){var i=t.getArgs(arguments,[{name:"entities",optional:!1,check:function(e){return e},defaultValue:null},{name:"callback",optional:!1,check:t.isCallback(),defaultValue:function(){}}]);n=i.entities,r=i.callback,ABINE_DNTME.require(["documentcloud/underscore"],function(t){var i={};t.async.forEach(t.keys(n),function(t,r){e.transaction(function(e){var a="";"all"!=n[t]&&(a=" where "+n[t]),e.executeSql("SELECT * FROM "+t+a,null,function(e){i[t]=e,r()})})},function(){r(i)})})},e.loadFromJson=function(n,r,i){var a=t.getArgs(arguments,[{name:"tx",optional:!0,check:e.isTransaction,defaultValue:null},{name:"jsonDump",optional:!1},{name:"callback",optional:!0,check:t.isCallback(),defaultValue:function(){}}]);n=a.tx,r=a.jsonDump,i=a.callback,this.load(n,JSON.parse(r),i)},e.createUUID=a,l.prototype.unsubscribe=function(){this.obj.removeEventListener(this.eventType,this.fn)},u.prototype.addEventListener=function(e,t){return this.subscribers[e]||(this.subscribers[e]=[]),this.subscribers[e].push(t),new l(this,e,t)},u.prototype.removeEventListener=function(e,t){for(var n=this.subscribers[e],r=0;r<n.length;r++)if(n[r]==t)return this.subscribers[e].splice(r,1),!0;return!1},u.prototype.triggerEvent=function(e){if(this.subscribers[e])for(var t=this.subscribers[e].slice(0),n=0;n<t.length;n++)t[n].apply(null,arguments)},d.prototype.match=function(){return!0},d.prototype.makeFit=function(){},d.prototype.makeNotFit=function(){},d.prototype.toUniqueString=function(){return"NULL"},d.prototype.subscribeGlobally=function(){},d.prototype.unsubscribeGlobally=function(){},h.prototype.match=function(e){return this.left.match(e)&&this.right.match(e)},h.prototype.makeFit=function(e){this.left.makeFit(e),this.right.makeFit(e)},h.prototype.makeNotFit=function(e){this.left.makeNotFit(e),this.right.makeNotFit(e)},h.prototype.toUniqueString=function(){return this.left.toUniqueString()+" AND "+this.right.toUniqueString()},h.prototype.subscribeGlobally=function(e,t){this.left.subscribeGlobally(e,t),this.right.subscribeGlobally(e,t)},h.prototype.unsubscribeGlobally=function(e,t){this.left.unsubscribeGlobally(e,t),this.right.unsubscribeGlobally(e,t)},f.prototype.match=function(e){return this.left.match(e)||this.right.match(e)},f.prototype.makeFit=function(e){this.left.makeFit(e),this.right.makeFit(e)},f.prototype.makeNotFit=function(e){this.left.makeNotFit(e),this.right.makeNotFit(e)},f.prototype.toUniqueString=function(){return this.left.toUniqueString()+" OR "+this.right.toUniqueString()},f.prototype.subscribeGlobally=function(e,t){this.left.subscribeGlobally(e,t),this.right.subscribeGlobally(e,t)},f.prototype.unsubscribeGlobally=function(e,t){this.left.unsubscribeGlobally(e,t),this.right.unsubscribeGlobally(e,t)},p.prototype.match=function(t){var n=this.value,r=e.get(t,this.property);switch(n&&n.getTime&&(n=1e3*Math.round(n.getTime()/1e3),r&&r.getTime&&(r=1e3*Math.round(r.getTime()/1e3))),this.operator){case"=":return r===n;case"!=":return r!==n;case"<":return r<n;case"<=":return r<=n;case">":return r>n;case">=":return r>=n;case"in":return o(n,r);case"not in":return!o(n,r)}},p.prototype.makeFit=function(t){if("="!==this.operator)throw new Error("Sorry, can't perform makeFit for other filters than =");e.set(t,this.property,this.value)},p.prototype.makeNotFit=function(t){if("="!==this.operator)throw new Error("Sorry, can't perform makeNotFit for other filters than =");e.set(t,this.property,null)},p.prototype.subscribeGlobally=function(t,n){e.subscribeToGlobalPropertyListener(t,n,this.property)},p.prototype.unsubscribeGlobally=function(t,n){e.unsubscribeFromGlobalPropertyListener(t,n,this.property)},p.prototype.toUniqueString=function(){var e=this.value;return e&&e._type&&(e=e.id),this.property+this.operator+e},e.NullFilter=d,e.AndFilter=h,e.OrFilter=f,e.PropertyFilter=p,e.uniqueQueryCollection=function(e){var t=e._entityName;if(e._items)return e;this.queryCollectionCache[t]||(this.queryCollectionCache[t]={});var n=e.toUniqueString();return this.queryCollectionCache[t][n]||(this.queryCollectionCache[t][n]=e),this.queryCollectionCache[t][n]},m.prototype=new u,m.prototype.oldAddEventListener=m.prototype.addEventListener,m.prototype.setupSubscriptions=function(){this._filter.subscribeGlobally(this,this._entityName)},m.prototype.teardownSubscriptions=function(){this._filter.unsubscribeGlobally(this,this._entityName)},m.prototype.addEventListener=function(e,t){var n=this,r=this.oldAddEventListener(e,t);return 1===this.subscribers[e].length&&this.setupSubscriptions(),r.oldUnsubscribe=r.unsubscribe,r.unsubscribe=function(){this.oldUnsubscribe(),0===n.subscribers[e].length&&n.teardownSubscriptions()},r},m.prototype.persistQueries=function(){return[]},m.prototype.init=function(t,n,r){this._filter=new d,this._orderColumns=[],this._prefetchFields=[],this._entityName=n,this._constructor=r,this._limit=-1,this._skip=0,this._reverse=!1,this._session=t||e,this.subscribers={}},m.prototype.toUniqueString=function(){var e=this._constructor.name+": "+this._entityName;e+="|Filter:";var t=[];e+=this._filter.toUniqueString(),e+="|Values:";for(var n=0;n<t.length;n++)e+=t+"|^|";e+="|Order:";for(var n=0;n<this._orderColumns.length;n++){var r=this._orderColumns[n];e+=r[0]+", "+r[1]+", "+r[2]}e+="|Prefetch:";for(var n=0;n<this._prefetchFields.length;n++)e+=this._prefetchFields[n];return e+="|Limit:",e+=this._limit,e+="|Skip:",e+=this._skip,e+="|Reverse:",e+=this._reverse},m.prototype.clone=function(e){var t=new this._constructor(this._session,this._entityName);if(t._filter=this._filter,t._prefetchFields=this._prefetchFields.slice(0),t._orderColumns=this._orderColumns.slice(0),t._limit=this._limit,t._skip=this._skip,t._reverse=this._reverse,e){var n={};for(var r in this.subscribers)this.subscribers.hasOwnProperty(r)&&(n[r]=this.subscribers[r].slice(0));t.subscribers=n}else t.subscribers=this.subscribers;return t},m.prototype.filter=function(e,t,n){var r=this.clone(!0);r._filter=new h(this._filter,new p(e,t,n));var i=this._session;return r=i.uniqueQueryCollection(r),i.uniqueQueryCollection(r)},m.prototype.or=function(e){var t=this.clone(!0);return t._filter=new f(this._filter,e),this._session.uniqueQueryCollection(t)},m.prototype.and=function(e){var t=this.clone(!0);return t._filter=new h(this._filter,e),this._session.uniqueQueryCollection(t)},m.prototype.order=function(e,t,n){t=void 0===t||t,n=void 0===n||n;var r=this.clone();return r._orderColumns.push([e,t,n]),this._session.uniqueQueryCollection(r)},m.prototype.limit=function(e){var t=this.clone();return t._limit=e,this._session.uniqueQueryCollection(t)},m.prototype.skip=function(e){var t=this.clone();return t._skip=e,this._session.uniqueQueryCollection(t)},m.prototype.reverse=function(){var e=this.clone();return e._reverse=!0,this._session.uniqueQueryCollection(e)},m.prototype.prefetch=function(e){var t=this.clone();return t._prefetchFields.push(e),this._session.uniqueQueryCollection(t)},m.prototype.selectJSON=function(n,r,a){var s=t.getArgs(arguments,[{name:"tx",optional:!0,check:e.isTransaction,defaultValue:null},{name:"props",optional:!1},{name:"callback",optional:!1}]),o=this._session,c=this;if(n=s.tx,r=s.props,a=s.callback,!n)return void o.transaction(function(e){c.selectJSON(e,r,a)});i(this._entityName);this.list(function(t){var i=[];e.asyncForEach(t,function(e,t){e.selectJSON(n,r,function(e){i.push(e),t()})},function(){a(i)})})},m.prototype.add=function(e){if(!e.id||!e._type)throw new Error("Cannot add object of non-entity type onto collection.");this._session.add(e),this._filter.makeFit(e),this.triggerEvent("add",this,e),this.triggerEvent("change",this,e)},m.prototype.addAll=function(e){for(var t=0;t<e.length;t++){var n=e[t];this._session.add(n),this._filter.makeFit(n),this.triggerEvent("add",this,n)}this.triggerEvent("change",this)},m.prototype.remove=function(e){if(!e.id||!e._type)throw new Error("Cannot remove object of non-entity type from collection.");this._filter.makeNotFit(e),this.triggerEvent("remove",this,e),this.triggerEvent("change",this,e)},m.prototype.each=function(n,r){var i=t.getArgs(arguments,[{name:"tx",optional:!0,check:e.isTransaction,defaultValue:null},{name:"eachFn",optional:!0,check:t.isCallback()}]);n=i.tx,r=i.eachFn,this.list(n,function(e){for(var t=0;t<e.length;t++)r(e[t])})},m.prototype.forEach=m.prototype.each,m.prototype.one=function(n,r){var i=t.getArgs(arguments,[{name:"tx",optional:!0,check:e.isTransaction,defaultValue:null},{name:"oneFn",optional:!1,check:t.isCallback()}]);n=i.tx,r=i.oneFn;this.limit(1).list(n,function(e){r(0===e.length?null:e[0])})},g.prototype=new m,y.prototype=new g,y.prototype.add=function(e){this._session.add(e),this.triggerEvent("add",this,e),this.triggerEvent("change",this,e)},y.prototype.remove=function(e){this._session.remove(e),this.triggerEvent("remove",this,e),this.triggerEvent("change",this,e)},b.prototype=new g,b.prototype.initManyToMany=function(e,t){this._obj=e,this._coll=t},b.prototype.add=function(e){o(this._localAdded,e)||(this._session.add(e),this._localAdded.push(e),this.triggerEvent("add",this,e),this.triggerEvent("change",this,e))},b.prototype.addAll=function(e){for(var t=0;t<e.length;t++){var n=e[t];o(this._localAdded,n)||(this._session.add(n),this._localAdded.push(n),this.triggerEvent("add",this,n))}this.triggerEvent("change",this)},b.prototype.clone=function(){var e=g.prototype.clone.call(this);return e._localAdded=this._localAdded,e._localRemoved=this._localRemoved,e._obj=this._obj,e._coll=this._coll,e},b.prototype.remove=function(e){o(this._localAdded,e)?c(this._localAdded,e):o(this._localRemoved,e)||this._localRemoved.push(e),this.triggerEvent("remove",this,e),this.triggerEvent("change",this,e)},v.prototype=new m,v.prototype.clone=function(){var e=g.prototype.clone.call(this);return e._items=this._items,e},v.prototype.add=function(e){o(this._items,e)||(this._session.add(e),this._items.push(e),this.triggerEvent("add",this,e),this.triggerEvent("change",this,e))},v.prototype.addAll=function(e){for(var t=0;t<e.length;t++){var n=e[t];o(this._items,n)||(this._session.add(n),this._items.push(n),this.triggerEvent("add",this,n))}this.triggerEvent("change",this)},v.prototype.remove=function(e){for(var t=this._items,n=0;n<t.length;n++)t[n]===e&&(this._items.splice(n,1),this.triggerEvent("remove",this,e),this.triggerEvent("change",this,e))},v.prototype.list=function(n,r){var i=t.getArgs(arguments,[{name:"tx",optional:!0,check:e.isTransaction,defaultValue:null},{name:"callback",optional:!0,check:t.isCallback()}]);r=i.callback,r&&!r.executeSql||(r=arguments[1]);for(var a=this._items.slice(0),s=this,o=[],c=0;c<a.length;c++)this._filter.match(a[c])&&o.push(a[c]);return o.sort(function(t,n){for(var r=0;r<s._orderColumns.length;r++){var i=s._orderColumns[r][0],a=s._orderColumns[r][1],o=s._orderColumns[r][2],c=e.get(t,i),l=e.get(n,i);if(o||(c=c.toLowerCase(),l=l.toLowerCase()),c<l)return a?-1:1;if(c>l)return a?1:-1}return 0}),this._skip&&o.splice(0,this._skip),this._limit>-1&&(o=o.slice(0,this._limit)),this._reverse&&o.reverse(),r?void r(o):o},v.prototype.destroyAll=function(e){e&&!e.executeSql||(e=arguments[1]),this._items=[],this.triggerEvent("change",this),e&&e()},v.prototype.count=function(n,r){var i=t.getArgs(arguments,[{name:"tx",optional:!0,check:e.isTransaction,defaultValue:null},{name:"callback",optional:!0,check:t.isCallback()}]);n=i.tx,r=i.callback;var a=this.list();return r?void r(a.length):a.length},e.QueryCollection=m,e.DbQueryCollection=g,e.ManyToManyDbQueryCollection=b,e.LocalQueryCollection=v,e.Observable=u,e.Subscription=l,e.AndFilter=h,e.OrFilter=f,e.PropertyFilter=p,e.GlobalEvent=new u}();var t={};return function(){t.getArgs=function(e,t){for(var n=0,r=0,i={};r<t.length;){var a=t[r],s=e[n];if(a.optional)void 0!==s&&a.check(s)?(i[a.name]=s,n++,r++):(void 0!==a.defaultValue&&(i[a.name]=a.defaultValue),r++);else{if(a.check&&!a.check(s))throw new Error("Invalid value for argument: "+a.name+" Value: "+s);i[a.name]=s,r++,n++}}return i},t.hasProperty=function(e){return function(t){return t&&void 0!==t[e]}},t.hasType=function(e){return function(t){return typeof t===e}},t.isCallback=function(){return function(e){return e&&e.apply}}}(),e.argspec=t,e}var persistence=initPersistence("undefined"!=typeof window&&window.persistence||{});return"undefined"==typeof JSON&&(JSON={}),JSON.stringify||!function(){function f(e){return e<10?"0"+e:e}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,r,i,a,s,o=gap,c=t[e];switch(c&&"object"==typeof c&&"function"==typeof c.toJSON&&(c=c.toJSON(e)),"function"==typeof rep&&(c=rep.call(t,e,c)),typeof c){case"string":return quote(c);case"number":return isFinite(c)?String(c):"null";case"boolean":case"null":return String(c);case"object":if(!c)return"null";if(gap+=indent,s=[],"[object Array]"===Object.prototype.toString.apply(c)){for(a=c.length,n=0;n<a;n+=1)s[n]=str(n,c)||"null";return i=0===s.length?"[]":gap?"[\n"+gap+s.join(",\n"+gap)+"\n"+o+"]":"["+s.join(",")+"]",gap=o,i}if(rep&&"object"==typeof rep)for(a=rep.length,n=0;n<a;n+=1)r=rep[n],"string"==typeof r&&(i=str(r,c),i&&s.push(quote(r)+(gap?": ":":")+i));else for(r in c)Object.hasOwnProperty.call(c,r)&&(i=str(r,c),i&&s.push(quote(r)+(gap?": ":":")+i));return i=0===s.length?"{}":gap?"{\n"+gap+s.join(",\n"+gap)+"\n"+o+"}":"{"+s.join(",")+"}",gap=o,i}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={
"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(e,t,n){var r;if(gap="",indent="","number"==typeof n)for(r=0;r<n;r+=1)indent+=" ";else"string"==typeof n&&(indent=n);if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(e,t){var n,r,i=e[t];if(i&&"object"==typeof i)for(n in i)Object.hasOwnProperty.call(i,n)&&(r=walk(i,n),void 0!==r?i[n]=r:delete i[n]);return reviver.call(e,t,i)}var j;if(cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),persistence}),ABINE_DNTME.define("persistence/store/memory",["persistence"],function(e){e.store||(e.store={}),e.store.memory={},e.store.memory.config=function(e,t){function n(t){var n=i[t._entityName];return n||(n=new e.LocalQueryCollection),n=n.clone(),n._filter=t._filter,n._prefetchFields=t._prefetchFields,n._orderColumns=t._orderColumns,n._limit=t._limit,n._skip=t._skip,n._reverse=t._reverse,n}var r=e.argspec;t=t||"persistenceData";var i={};e.getAllObjects=function(){return i};var a=e.add;e.add=function(t){if(!this.trackedObjects[t.id]){a.call(this,t);var n=t._type;i[n]||(i[n]=new e.LocalQueryCollection,i[n]._session=e),i[n].add(t)}return this};var s=e.forceAdd;e.forceAdd=function(t){if(t){if(!this.trackedObjects[t.id]||this.trackedObjects[t.id]!=t){s.call(this,t);var n=t._type;i[n]||(i[n]=new e.LocalQueryCollection,i[n]._session=e);try{i[n].remove(this.trackedObjects[t.id])}catch(e){}i[n].add(t)}return this}};var o=e.remove;e.remove=function(e){o.call(this,e);var t=e._type;i[t].remove(e)};var c=e.clearFromEntityCache;e.clearFromEntityCache=function(e){if(e){c.call(this,e);var t=e._type;i[t].remove(e)}},e.schemaSync=function(){var t=r.getArgs(arguments,[{name:"tx",optional:!0,check:e.isTransaction,defaultValue:null},{name:"callback",optional:!0,check:r.isCallback(),defaultValue:function(){}},{name:"emulate",optional:!0,check:r.hasType("boolean")}]);t.callback()},e.flush=function(t){var n=r.getArgs(arguments,[{name:"tx",optional:!0,check:e.isTransaction},{name:"callback",optional:!0,check:r.isCallback(),defaultValue:function(){}}]),i=e.flushHooks,a=this;e.asyncForEach(i,function(e,n){e(a,t,n)},function(){var t=e.trackedObjects;for(var r in t)t.hasOwnProperty(r)&&(e.objectsToRemove.hasOwnProperty(r)?delete t[r]:t[r]._dirtyProperties={});n.callback()})},e.transaction=function(e){e({executeSql:function(){}})},e.loadFromLocalStorage=function(e){var n=window.localStorage.getItem(t);n?this.loadFromJson(n,e):e&&e()},e.saveToLocalStorage=function(e){this.dumpToJson(function(n){window.localStorage.setItem(t,n),e&&e()})},e.reset=function(t,n){var a=r.getArgs(arguments,[{name:"tx",optional:!0,check:e.isTransaction,defaultValue:null},{name:"callback",optional:!0,check:r.isCallback(),defaultValue:function(){}}]);t=a.tx,n=a.callback,i={},this.clean(),n()},e.close=function(){},e.DbQueryCollection.prototype.list=function(t,i){var a=r.getArgs(arguments,[{name:"tx",optional:!0,check:e.isTransaction,defaultValue:null},{name:"callback",optional:!1,check:r.isCallback()}]);t=a.tx,i=a.callback;var s=n(this);s.list(null,i)},e.DbQueryCollection.prototype.destroyAll=function(t,i){var a=r.getArgs(arguments,[{name:"tx",optional:!0,check:e.isTransaction,defaultValue:null},{name:"callback",optional:!0,check:r.isCallback(),defaultValue:function(){}}]);t=a.tx,i=a.callback;var s=n(this);s.destroyAll(null,i)},e.DbQueryCollection.prototype.count=function(t,i){var a=r.getArgs(arguments,[{name:"tx",optional:!0,check:e.isTransaction,defaultValue:null},{name:"callback",optional:!1,check:r.isCallback()}]);t=a.tx,i=a.callback;var s=n(this);s.count(null,i)},e.ManyToManyDbQueryCollection=function(t,n){this.init(t,n,e.ManyToManyDbQueryCollection),this._items=[]},e.ManyToManyDbQueryCollection.prototype=new e.LocalQueryCollection,e.ManyToManyDbQueryCollection.prototype.initManyToMany=function(e,t){this._obj=e,this._coll=t},e.ManyToManyDbQueryCollection.prototype.add=function(t,n){if(e.LocalQueryCollection.prototype.add.call(this,t),!n){var r=e.getMeta(this._obj._type),i=r.hasMany[this._coll].inverseProperty;e.get(t,i).add(this._obj,!0)}},e.ManyToManyDbQueryCollection.prototype.remove=function(t,n){if(e.LocalQueryCollection.prototype.remove.call(this,t),!n){var r=e.getMeta(this._obj._type),i=r.hasMany[this._coll].inverseProperty;e.get(t,i).remove(this._obj,!0)}}}}),ABINE_DNTME.define("persistence/caching",["documentcloud/underscore","abine/core","persistence","abine/eventLogger","abine/timer"],function(e,t,n){return n.entityDecoratorHooks.push(function(e){e.enableCaching=function(t,r){"function"==typeof t&&(r=t,t=null),e.cached=!1,e.meta.cached=!0,e.meta.alternatePK=t,n.GlobalEvent.addEventListener("clean",function(){e.cached=!1,r&&r()})},e.enableIndexing=function(t){e.meta.indexed=t}}),null}),ABINE_DNTME.require("persistence/store/memory",function(e){console.log("defined memory: "+e)}),ABINE_DNTME.define("abine/ajax",["jquery"],function(e){return{ajax:e.ajax,get:e.get,getJSON:e.getJSON,post:e.post,getScript:e.getScript}}),ABINE_DNTME.define("abine/assets",["wycats/handlebars"],function(e){function t(e,t,n){return chrome.extension.getURL(e+("string"==typeof t?t+("string"==typeof n?n:""):""))}function n(e,t,n){var r=e+t+n;return chrome.extension.getURL(r)}return e.registerHelper("assetUrl",t),e.registerHelper("cardAssetUrl",n),{assetUrl:t,cardAssetUrl:n}}),ABINE_DNTME.define("abine/backgroundMessenger",["documentcloud/underscore","abine/core"],function(e,t){var n=function(e,t){if(t&&t.tab)return"FWD"==e.eventName?(e.via_bg=!0,void chrome.tabs.sendRequest(t.tab.id,e)):void this.trigger(e.eventName,e.payload,t.tab.id)},r=function(){throw"Error. Attempt to call destroyed BackgroundMessenger."},i=t.BaseClass.extend({initialize:function(){this.listener=e.bind(n,this),chrome.extension.onRequest.addListener(this.listener)},send:function(e,t,n){if(this.trigger(e,t,n),"test"!=n)if(n&&n!=-1||!chrome.tabs){if(!n||"background"==n||n==-1)return;chrome.tabs.sendRequest(n,{eventName:e,payload:"undefined"==typeof t?{}:t})}else chrome.tabs.getSelected(null,function(r){n=r.id,chrome.tabs.sendRequest(n,{eventName:e,payload:"undefined"==typeof t?{}:t})})},broadcast:function(t,n){n=n||{},this.trigger(t,n),chrome.tabs.query({url:chrome.extension.getURL("pages/index.html")},function(r){e(r).each(function(e){chrome.tabs.sendRequest(e.id,{eventName:t,payload:n})})})},broadcastToAllTabs:function(t,n){n=n||{},this.trigger(t,n),chrome.tabs.query({},function(r){e(r).each(function(e){chrome.tabs.sendRequest(e.id,{eventName:t,payload:n})})})},destroy:function(){this.off(),chrome.extension.onRequest.removeListener(n),this.on=this.off=this.trigger=r},sendToWebapp:function(t,n){ABINE_DNTME.require(["abine/window"],function(r){r.getWebappTabs(function(r){e.each(r,function(e){chrome.tabs.sendRequest(e,{eventName:t,payload:n})})})})}});return{implementation:"Chrome",BackgroundMessenger:i}}),ABINE_DNTME.define("abine/browserSyncStorage",["documentcloud/underscore","abine/core"],function(e,t){var n;n=chrome&&chrome.storage&&chrome.storage.sync?t.BaseClass.extend({initialize:function(){},set:function(e,t){chrome.storage.sync.set(e,t)},remove:function(e,t){chrome.storage.sync.remove(e,t)},get:function(e,t){chrome.storage.sync.get(e,t)},clear:function(e){chrome.storage.sync.clear(e)}}):t.BaseClass.extend({initialize:function(){this.storage={}},set:function(t,n){e.extend(this.storage,t),n&&n()},remove:function(t,n){t="string"==typeof t?[t]:t,e.each(t,e.bind(function(e){delete this.storage[e]},this)),n&&n()},get:function(t,n){t="string"==typeof t?[t]:t,n&&n(e.pick(this.storage,t))},clear:function(e){this.storage={},e&&e()}});var r=new n({});return r}),ABINE_DNTME.define("abine/clipboard",["abine/eventLogger"],function(){return{copyToClipboard:function(e){var t=document.createElement("textarea");document.getElementById("navbar").appendChild(t),t.focus(),t.value=e,document.execCommand("selectAll"),document.execCommand("copy"),document.getElementById("navbar").removeChild(t)}}}),ABINE_DNTME.define("abine/baseConfig",[],function(){var e=ABINE_DNTME.config={version:"8.1.2491",buildNum:"2491.8528eaa2bc1dff1159efa593e2e0fb4661835205",appName:"Blur",environment:"production",tags:["chromestore"],crypt:!0,silent:!1,payments:!0,browser:null,serverHost:"mm.abine.com",webHost:"www.abine.com",webAppHost:"dnt.abine.com",mappingServerHost:"mapping.abine.com",phoneServerHost:"phone.abine.com",licenseServerHost:"license.abine.com",emailServerHost:"emails.abine.com",pushNotificationUrl:"https://push.abine.com",disposableDomain:"opayq.com",paymentsServerHost:"payments.abine.com",logLevel:"ERROR",pfVersion:".790 Chrome development",mmVersion:"0.0.1 development",features:"accounts,wallet,abinestore,shareWebsocket",buildTag:"chromestore",stripe_key:"pk_live_J13Da0TuELwopBJeF4HlBwU9",overriddenKeys:{}};return e.protocol="development"===ABINE_DNTME.config.environment?"http://":"https://",e.tellWebapp=function(t,n){if(t.documentElement.hasAttribute("abine_webapp")&&(t.documentElement.setAttribute("dnt",e.version),t.documentElement.setAttribute("dnt-features",e.features),t.documentElement.setAttribute("dnt-tag",e.tags[0]),t.documentElement.setAttribute("dnt-build-tag",e.buildTag),n)){var r=t.createEvent("Event");r.initEvent("data:tag:changed",!0,!0),t.dispatchEvent(r)}},e.updateTag=function(t,n){e.tags[0]!=t&&(e.tags[0]=t,n&&e.tellWebapp(n,!0))},e}),ABINE_DNTME.define("abine/config",["abine/baseConfig"],function(e){return e.browser="Chrome",e.tellWebapp(document),e}),ABINE_DNTME.require("abine/config"),ABINE_DNTME.define("abine/conflict_handler",["storage","persistence","abine/localStorage","abine/timer"],function(e,t,n,r){function i(){return openDatabase("idme_data","1.0","Storage for the idme extension",5242880)}function a(e,t,n,r){e.transaction(function(e){e.executeSql(t,null,function(e,t){r(t.rows.length>0?t.rows.item(0)[n]:null)},function(){r(null)})})}function s(e){e=e||function(){};var t=i();a(t,"SELECT * FROM sqlite_master WHERE type='table' AND name='Preferences'","name",function(n){c="Preferences"==n,ABINE_DNTME.merged_data_available=c,c?a(t,"select * from Preferences where key = 'regEmail' ","value",function(n){a(t,"select * from Preferences where key = 'entitledToPhone' ","value",function(r){a(t,"select count(*) as cnt from DisposableEmails ","cnt",function(t){e(c,!n||t>1||"true"==r)})})}):e(c)})}function o(n,r){if(r=r||function(){},!n)return void r();var s=i();a(s,"select * from Preferences where key = 'installAuthToken' ","value",function(n){n&&""!=n?e.Preference.findOrCreate({key:"installAuthToken"},function(e){e.value=n,e.modifiedAt=l(),t.flush(function(){r()})}):r()})}var c=null,l=function(){var e=new Date;return e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e};return{installAuthTokenCheck:o,checkForMergedAddon:s,checkForMaskme:function(e){function t(i){if(i<=0)return ABINE_DNTME.maskme_installed=!1,n.setItem("maskme.installed","0"),void e(!1);var a=r.setTimeout(function(){t(i-1)},200);_.each(ABINE_DNTME.MASKME_EXTENSION_ID,function(t,i){chrome.runtime.sendMessage(i,{message:"ping"},function(t){t&&t.installed&&(r.clearTimeout(a),n.setItem("maskme.installed","1"),ABINE_DNTME.maskme_installed=!0,ABINE_DNTME.maskme_can_export=!1,chrome.runtime.sendMessage(i,{message:"can_export"},function(e){e===!0&&(ABINE_DNTME.maskme_can_export=!0)}),e(!0))})})}return"undefined"!=typeof ABINE_DNTME.maskme_installed?void e(ABINE_DNTME.maskme_installed):("0"===n.getItem("maskme.installed")&&(ABINE_DNTME.maskme_installed=!1,e(!1)),void t(3))}}}),ABINE_DNTME.define("abine/contentMessenger",["documentcloud/underscore","abine/core"],function(e,t){var n=function(e){"FWD"==e.eventName?e.via_bg&&e.payload.to==ABINE_DNTME.context&&this.trigger(e.payload.eventName,e.payload.payload,e.payload.from):this.trigger(e.eventName,e.payload)},r=function(){throw"Error. Attempt to call destroyed ContentMessenger."},i=t.BaseClass.extend({initialize:function(){this.listener=e.bind(n,this),chrome.extension.onRequest.addListener(this.listener)},sendToCS:function(e,t,n){chrome&&chrome.extension&&chrome.extension.sendRequest({eventName:"FWD",payload:{to:e,from:ABINE_DNTME.context,eventName:t,payload:"undefined"==typeof n?{}:n}})},send:function(e,t){this.trigger(e,t),chrome&&chrome.extension&&chrome.extension.sendRequest({eventName:e,payload:"undefined"==typeof t?{}:t})},destroy:function(){this.off();try{chrome.extension.onRequest.removeListener(this.listener)}catch(e){}this.on=this.off=this.trigger=r}});return{ContentMessenger:i}}),ABINE_DNTME.define("abine/contextMenu",["documentcloud/underscore","abine/core","abine/contextHelper","storage","abine/securityManager"],function(e,t,n,r,i){var a=["editable"],s=t.BaseClass.extend({init:function(t){chrome.contextMenus.onClicked.addListener(e.bind(this.onClick,this)),t.on("contentscript:contextmenu:refresh",this.refreshMenu,this),t.on("background:contextmenu:refresh",this.refreshMenu,this),i.on("background:securityManager:unlocked",e.bind(function(){this.previousDomain=null},this)),i.on("background:securityManager:locked",e.bind(function(){this.previousDomain=null},this)),this.messenger=t},refreshMenu:function(t){if(this.previousDomain!=t.domain&&(this.previousDomain=t.domain,!this.alreadyRefreshing)){this.domain=t.domain,this.alreadyRefreshing=!0;var n=e.bind(function(){this.mappingMenu(e.bind(function(){this.alreadyRefreshing=!1},this))},this);chrome.contextMenus.removeAll(e.bind(function(){return"abine.com"==this.domain?void(this.alreadyRefreshing=!1):this.domain.indexOf("chrome-extension://")>=0||ABINE_DNTME.maskme_installed?void(this.alreadyRefreshing=!1):void r.Preference.findBy("key","hasRegistered",e.bind(function(s){return!s||s.isFalse()?void r.Preference.batchFindBy([{by:"key",value:"mapping:mapper"},{by:"key",value:"autofill:mapper"}],e.bind(function(e){e["mapping:mapper"]||e["autofill:mapper"]?chrome.contextMenus.create({title:"Blur",contexts:a,id:"abine_dntme_context_root"},n):this.alreadyRefreshing=!1},this)):void(i.isLocked()?chrome.contextMenus.create({title:"Blur",contexts:a,id:"abine_dntme_context_root"},e.bind(function(){chrome.contextMenus.create({title:"locked, click to unlock",contexts:a,id:"abine_dntme_unlock",parentId:"abine_dntme_context_root"},n)},this)):this.createStaticMenu(t.domain,e.bind(function(){this.createDynamicMenu(t.domain,n)},this)))},this))},this))}},onClick:function(e,t){n.onClick(this.messenger,e.menuItemId,t.id,this.domain)},createDynamicMenu:function(t,n){e.async.series([e.bind(function(n){chrome.contextMenus.create({title:"Accounts for "+t,contexts:a,id:"abine_dntme_logins",parentId:"abine_dntme_context_root"},e.bind(function(){r.Account.listCached("domain",t,e.bind(function(t){0==t.length?chrome.contextMenus.create({title:"You have no accounts here",contexts:a,id:"abine_dntme_no_accounts",parentId:"abine_dntme_logins"},n):e.async.forEachSeries(t,e.bind(this.addLoginItem,this),n)},this))},this))},this),e.bind(function(t){r.Preference.findBy("key","masked_card_auth",e.bind(function(n){n&&"biometric"==n.value?t():r.RealCard.index(null,e.bind(function(n){0==n.length?t():e.async.forEachSeries(n,e.bind(this.addCardItem,this),t)},this))},this))},this),e.bind(function(t){r.Address.index(null,e.bind(function(n){0==n.length?t():chrome.contextMenus.create({title:"Addresses",contexts:a,id:"abine_dntme_address_parent",parentId:"abine_dntme_context_root"},e.bind(function(){e.async.forEachSeries(n,e.bind(this.addAddressItem,this),t)},this))},this))},this),n])},addLoginItem:function(e,t){return e.mfa?void chrome.contextMenus.create({title:(e.email||e.username||(e.password?"- Only Password -":"- Not Set -"))+" - protected",contexts:a,id:"abine_dntme_accountfield_parent_"+e.id,parentId:"abine_dntme_logins"},function(){t()}):void chrome.contextMenus.create({title:e.email||e.username||(e.password?"- Only Password -":"- Not Set -"),contexts:a,id:"abine_dntme_accountfield_parent_"+e.id,parentId:"abine_dntme_logins"},function(){e.email&&chrome.contextMenus.create({title:"Fill email",contexts:a,id:"abine_dntme_accountfield_email_"+e.id,parentId:"abine_dntme_accountfield_parent_"+e.id},function(){}),e.username&&chrome.contextMenus.create({title:"Fill username",contexts:a,id:"abine_dntme_accountfield_username_"+e.id,parentId:"abine_dntme_accountfield_parent_"+e.id},function(){}),e.password&&chrome.contextMenus.create({title:"Fill password",contexts:a,id:"abine_dntme_accountfield_password_"+e.id,parentId:"abine_dntme_accountfield_parent_"+e.id},function(){}),t()})},addCardItem:function(e,t){chrome.contextMenus.create({title:"Card ending in x"+e.number.substr(e.number.length-4),contexts:a,id:"abine_dntme_fillcard_parent_"+e.id,parentId:"abine_dntme_card_parent"},function(){e.number&&chrome.contextMenus.create({title:"Fill card number",contexts:a,id:"abine_dntme_fillcard_number_"+e.id,parentId:"abine_dntme_fillcard_parent_"+e.id},function(){}),(e.first_name||e.last_name)&&chrome.contextMenus.create({title:"Fill name - "+e.getFullName(),contexts:a,id:"abine_dntme_fillcard_name_"+e.id,parentId:"abine_dntme_fillcard_parent_"+e.id},function(){}),e.cvc&&chrome.contextMenus.create({title:"Fill CVC/CVV",contexts:a,id:"abine_dntme_fillcard_cvc_"+e.id,parentId:"abine_dntme_fillcard_parent_"+e.id},function(){}),chrome.contextMenus.create({title:"Fill expiry month - mm",contexts:a,id:"abine_dntme_fillcard_month_"+e.id,parentId:"abine_dntme_fillcard_parent_"+e.id},function(){}),chrome.contextMenus.create({title:"Fill expiry year - yyyy",contexts:a,id:"abine_dntme_fillcard_year_"+e.id,parentId:"abine_dntme_fillcard_parent_"+e.id},function(){}),chrome.contextMenus.create({title:"Fill expiry year - yy",contexts:a,id:"abine_dntme_fillcard_yy_"+e.id,parentId:"abine_dntme_fillcard_parent_"+e.id},function(){}),chrome.contextMenus.create({title:"Fill expiry - mm/yyyy",contexts:a,id:"abine_dntme_fillcard_mmyyyy_"+e.id,parentId:"abine_dntme_fillcard_parent_"+e.id},function(){}),chrome.contextMenus.create({title:"Fill expiry - mm/yy",contexts:a,id:"abine_dntme_fillcard_mmyy_"+e.id,parentId:"abine_dntme_fillcard_parent_"+e.id},function(){}),t()})},addAddressItem:function(e,t){chrome.contextMenus.create({title:e.label,contexts:a,id:"abine_dntme_address_parent_"+e.id,parentId:"abine_dntme_address_parent"},function(){e.address1&&chrome.contextMenus.create({title:"Line 1: "+e.address1,contexts:a,id:"abine_dntme_address_line1_"+e.id,parentId:"abine_dntme_address_parent_"+e.id},function(){}),e.address2&&chrome.contextMenus.create({title:"Line 2: "+e.address2,contexts:a,id:"abine_dntme_address_line2_"+e.id,parentId:"abine_dntme_address_parent_"+e.id},function(){}),e.city&&chrome.contextMenus.create({title:"City: "+e.city,contexts:a,id:"abine_dntme_address_city_"+e.id,parentId:"abine_dntme_address_parent_"+e.id},function(){}),e.state&&chrome.contextMenus.create({title:"State: "+e.state,contexts:a,id:"abine_dntme_address_state_"+e.id,parentId:"abine_dntme_address_parent_"+e.id},function(){}),e.country&&chrome.contextMenus.create({title:"Country: "+e.country,contexts:a,id:"abine_dntme_address_country_"+e.id,parentId:"abine_dntme_address_parent_"+e.id},function(){}),e.zip&&chrome.contextMenus.create({title:"Zip: "+e.zip,contexts:a,id:"abine_dntme_address_zip_"+e.id,parentId:"abine_dntme_address_parent_"+e.id},function(){}),t()})},mappingMenu:function(e){r.Preference.batchFindBy([{by:"key",value:"mapping:mapper"},{by:"key",value:"mapping:reviewer"},{by:"key",value:"autofill:mapper"}],function(t){t["mapping:mapper"]||t["mapping:reviewer"]?chrome.contextMenus.create({title:"Map this form",contexts:a,parentId:"abine_dntme_context_root",id:"abine_dntme_map_form"},e):t["autofill:mapper"]?chrome.contextMenus.create({title:"Autofill this form",contexts:a,parentId:"abine_dntme_context_root",id:"abine_dntme_autofill_form"},e):chrome.contextMenus.create({title:"Ignore this field",contexts:a,parentId:"abine_dntme_context_root",id:"abine_dntme_ignore"},e)})},addPhoneMenu:function(e,t){var n="abine_dntme_phone_"+t+"_parent",r=e.country_code,i=e.number;if(chrome.contextMenus.create({title:"Full: "+i,contexts:a,id:"abine_dntme_phone_"+t+"_full",parentId:n},function(){}),1==r&&10==i.length){var s=i.substr(0,3),o=i.substr(3,3),c=i.substr(6,4),l=i.substr(3,7);chrome.contextMenus.create({title:"Last 7: "+l,contexts:a,id:"abine_dntme_phone_"+t+"_last7",parentId:n},function(){}),chrome.contextMenus.create({title:"Area: "+s,contexts:a,id:"abine_dntme_phone_"+t+"_area",parentId:n},function(){}),chrome.contextMenus.create({title:"Exchange: "+o,contexts:a,id:"abine_dntme_phone_"+t+"_exchange",parentId:n},function(){}),chrome.contextMenus.create({title:"Local: "+c,contexts:a,id:"abine_dntme_phone_"+t+"_local",parentId:n},function(){})}},createStaticMenu:function(t,n){var i=this;e.async.series([function(e){chrome.contextMenus.create({title:"Blur",contexts:a,id:"abine_dntme_context_root"},e)},function(e){chrome.contextMenus.create({title:"Email",contexts:a,parentId:"abine_dntme_context_root",id:"abine_dntme_email_parent"},e)},function(e){chrome.contextMenus.create({title:"Mask My Email",contexts:a,parentId:"abine_dntme_email_parent",id:"abine_dntme_email_mask"},e)},function(e){chrome.contextMenus.create({title:"Use My Email",contexts:a,parentId:"abine_dntme_email_parent",id:"abine_dntme_email_disclose"},e)},function(e){chrome.contextMenus.create({title:"Password",contexts:a,parentId:"abine_dntme_context_root",id:"abine_dntme_password_parent"},e)},function(e){chrome.contextMenus.create({title:"Generate strong password",contexts:a,parentId:"abine_dntme_password_parent",id:"abine_dntme_password_mask"},e)},function(e){chrome.contextMenus.create({title:"Phone",contexts:a,parentId:"abine_dntme_context_root",id:"abine_dntme_phone_parent"},e)},function(e){r.DisposablePhone.index(null,function(t){t.length>0?chrome.contextMenus.create({title:"Mask my Phone",contexts:a,parentId:"abine_dntme_phone_parent",id:"abine_dntme_phone_mask_parent"},function(){i.addPhoneMenu(t[0],"mask"),e()}):e()})},function(e){r.ShieldedPhone.index(null,function(t){t.length>0?chrome.contextMenus.create({title:"Disclose my phone",contexts:a,parentId:"abine_dntme_phone_parent",id:"abine_dntme_phone_disclose_parent"},function(){i.addPhoneMenu(t[0],"disclose"),e()}):chrome.contextMenus.create({title:"Set up your phone",contexts:a,parentId:"abine_dntme_phone_parent",id:"abine_dntme_setup_phone"},e)})},function(e){chrome.contextMenus.create({title:"Credit Card",contexts:a,parentId:"abine_dntme_context_root",id:"abine_dntme_card_parent"},function(){r.Preference.findBy("key","hasEnabledPayments",function(t){t&&t.isTrue()?chrome.contextMenus.create({title:"Mask my Credit Card",contexts:a,parentId:"abine_dntme_card_parent",id:"abine_dntme_card_mask"},e):chrome.contextMenus.create({title:"Activate Masked Cards",contexts:a,parentId:"abine_dntme_card_parent",id:"abine_dntme_activate_card"},e)})})}],function(){n()})}});return{contextMenuHelper:new s}}),ABINE_DNTME.define("abine/dntmeUpgrade",["storage","persistence","abine/localStorage","abine/conflict_handler"],function(e,t,n,r){function i(){var e=5242880;f=openDatabase("abine2","1.1","abine2",e)}function a(e,t){f.transaction(function(n){n.executeSql("SELECT * FROM trackers",[],function(n,r){e.trackerMap={};for(var i=0;i<r.rows.length;i++)e.trackerMap[r.rows.item(i).domain]||(e.trackerMap[r.rows.item(i).domain]={}),e.trackerMap[r.rows.item(i).domain][r.rows.item(i).name]=r.rows.item(i).blocked;t()},function(){t()})})}function s(e,t){f.transaction(function(n){n.executeSql("SELECT * from blockcount",[],function(n,r){e.totals={};for(var i=0;i<r.rows.length;i++){var a=r.rows.item(i).name,s=r.rows.item(i).value;"totalOptout"!=a&&("totalb"==a&&(a="total"),e.totals[a]=s)}t()},function(){t()})})}function o(e,t){f.transaction(function(n){n.executeSql("SELECT * from settings",[],function(n,r){e.settings={};for(var i=0;i<r.rows.length;i++){var a=r.rows.item(i).name;if(!a.match(/rules|converted|reason/)){var s=r.rows.item(i).value;e.settings[a.toLowerCase()]=s}}"dntp.useglobalallow"in e.settings&&(e.settings["dntp.useglobalallow"]=""!=e.settings["dntp.useglobalallow"]),"dntp.showmedals"in e.settings&&(e.settings["dntp.showmedals"]=""!=e.settings["dntp.showmedals"]),t()},function(){t()})})}function c(e,t){n.getItem("global.blocked")&&(e.settings||(e.settings={}),e.settings.defaultBlocked="0"!=n.getItem("global.blocked")),n.getItem("origin")&&(e.settings||(e.settings={}),e.settings.origin=n.getItem("origin")),e.badTrackers={},e.dailyTotals={},n.getItem("badTrackerTotals")&&(e.badTrackers.totals=JSON.parse(n.getItem("badTrackerTotals")));for(var r=(new Date).getFullYear(),i=2011;i<=r;i++){n.getItem("dailyTotals"+i)&&(e.dailyTotals[i]=JSON.parse(n.getItem("dailyTotals"+i)));for(var a in e.badTrackers.totals){var s=a+"."+i;n.getItem("badTrackerDaily."+s)&&("daily"in e.badTrackers||(e.badTrackers.daily={}),e.badTrackers.daily[s]=JSON.parse(n.getItem("badTrackerDaily."+s)))}}t()}function l(){return openDatabase("idme_data","1.0","Storage for the idme extension",5242880)}function u(e){function t(r,s){if(s>=i.length)return void e(a);var o=i[s];r.executeSql("SELECT * FROM sqlite_master WHERE type='table' AND name='"+o+"'",null,function(e,r){r.rows.length>0?(a[o]={schema:r.rows.item(0).sql},n(e,s)):t(e,s+1)})}function n(e,n){var r=i[n];e.executeSql("SELECT * FROM "+r,null,function(e,i){for(var s=[],o=i.rows.length,c=0;c<o;c++)s.push(i.rows.item(c));a[r].rows=s,t(e,n+1)})}if(null===h)return void r.checkForMergedAddon(function(t){h=t,u(e)});if(h===!1)return void e(null);var i="AccountField,Accounts,DisposableCards,DisposableEmails,Preferences,ShieldedEmails,Sites".split(","),a={};l().transaction(function(e){t(e,0)})}function d(e){_.each(ABINE_DNTME.MASKME_EXTENSION_ID,function(t,n){chrome.runtime.sendMessage(n,{message:"export_to_dntme"},function(t){t&&e(t)})})}var h=null,f=null;return{getMaskmeData:u,exportFromMaskme:d,getOldData:function(e){if(n.getItem("upgradeDone"))return void e(null);n.setItem("upgradeDone",!0),i();var t={};a(t,function(){s(t,function(){o(t,function(){c(t,function(){e(t)})})})})}}}),ABINE_DNTME.define("abine/compressedLocalStorage",[],function(){function e(e){
// Copyright (c) 2013 Pieroxy <pieroxy@pieroxy.net>
var t=function(){function e(e,t){if(!i[e]){i[e]={};for(var n=0;n<e.length;n++)i[e][e.charAt(n)]=n}return i[e][t]}var t=String.fromCharCode,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",i={},a={compressToBase64:function(e){if(null==e)return"";var t=a._compress(e,6,function(e){return n.charAt(e)});switch(t.length%4){default:case 0:return t;case 1:return t+"===";case 2:return t+"==";case 3:return t+"="}},decompressFromBase64:function(t){return null==t?"":""==t?null:a._decompress(t.length,32,function(r){return e(n,t.charAt(r))})},compressToUTF16:function(e){return null==e?"":a._compress(e,15,function(e){return t(e+32)})+" "},decompressFromUTF16:function(e){return null==e?"":""==e?null:a._decompress(e.length,16384,function(t){return e.charCodeAt(t)-32})},compressToUint8Array:function(e){for(var t=a.compress(e),n=new Uint8Array(2*t.length),r=0,i=t.length;r<i;r++){var s=t.charCodeAt(r);n[2*r]=s>>>8,n[2*r+1]=s%256}return n},decompressFromUint8Array:function(e){if(null===e||void 0===e)return a.decompress(e);for(var n=new Array(e.length/2),r=0,i=n.length;r<i;r++)n[r]=256*e[2*r]+e[2*r+1];var s=[];return n.forEach(function(e){s.push(t(e))}),a.decompress(s.join(""))},compressToEncodedURIComponent:function(e){return null==e?"":a._compress(e,6,function(e){return r.charAt(e)})},decompressFromEncodedURIComponent:function(t){return null==t?"":""==t?null:(t=t.replace(/ /g,"+"),a._decompress(t.length,32,function(n){return e(r,t.charAt(n))}))},compress:function(e){return a._compress(e,16,function(e){return t(e)})},_compress:function(e,t,n){if(null==e)return"";var r,i,a,s={},o={},c="",l="",u="",d=2,h=3,f=2,p=[],m=0,g=0;for(a=0;a<e.length;a+=1)if(c=e.charAt(a),Object.prototype.hasOwnProperty.call(s,c)||(s[c]=h++,o[c]=!0),l=u+c,Object.prototype.hasOwnProperty.call(s,l))u=l;else{if(Object.prototype.hasOwnProperty.call(o,u)){if(u.charCodeAt(0)<256){for(r=0;r<f;r++)m<<=1,g==t-1?(g=0,p.push(n(m)),m=0):g++;for(i=u.charCodeAt(0),r=0;r<8;r++)m=m<<1|1&i,g==t-1?(g=0,p.push(n(m)),m=0):g++,i>>=1}else{for(i=1,r=0;r<f;r++)m=m<<1|i,g==t-1?(g=0,p.push(n(m)),m=0):g++,i=0;for(i=u.charCodeAt(0),r=0;r<16;r++)m=m<<1|1&i,g==t-1?(g=0,p.push(n(m)),m=0):g++,i>>=1}d--,0==d&&(d=Math.pow(2,f),f++),delete o[u]}else for(i=s[u],r=0;r<f;r++)m=m<<1|1&i,g==t-1?(g=0,p.push(n(m)),m=0):g++,i>>=1;d--,0==d&&(d=Math.pow(2,f),f++),s[l]=h++,u=String(c)}if(""!==u){if(Object.prototype.hasOwnProperty.call(o,u)){if(u.charCodeAt(0)<256){for(r=0;r<f;r++)m<<=1,g==t-1?(g=0,p.push(n(m)),m=0):g++;for(i=u.charCodeAt(0),r=0;r<8;r++)m=m<<1|1&i,g==t-1?(g=0,p.push(n(m)),m=0):g++,i>>=1}else{for(i=1,r=0;r<f;r++)m=m<<1|i,g==t-1?(g=0,p.push(n(m)),m=0):g++,i=0;for(i=u.charCodeAt(0),r=0;r<16;r++)m=m<<1|1&i,g==t-1?(g=0,p.push(n(m)),m=0):g++,i>>=1}d--,0==d&&(d=Math.pow(2,f),f++),delete o[u]}else for(i=s[u],r=0;r<f;r++)m=m<<1|1&i,g==t-1?(g=0,p.push(n(m)),m=0):g++,i>>=1;d--,0==d&&(d=Math.pow(2,f),f++)}for(i=2,r=0;r<f;r++)m=m<<1|1&i,g==t-1?(g=0,p.push(n(m)),m=0):g++,i>>=1;for(;;){if(m<<=1,g==t-1){p.push(n(m));break}g++}return p.join("")},decompress:function(e){return null==e?"":""==e?null:a._decompress(e.length,32768,function(t){return e.charCodeAt(t)})},_decompress:function(e,n,r){var i,a,s,o,c,l,u,d,h=[],f=4,p=4,m=3,g="",y=[],b={val:r(0),position:n,index:1};for(a=0;a<3;a+=1)h[a]=a;for(o=0,l=Math.pow(2,2),u=1;u!=l;)c=b.val&b.position,b.position>>=1,0==b.position&&(b.position=n,b.val=r(b.index++)),o|=(c>0?1:0)*u,u<<=1;switch(i=o){case 0:for(o=0,l=Math.pow(2,8),u=1;u!=l;)c=b.val&b.position,b.position>>=1,0==b.position&&(b.position=n,b.val=r(b.index++)),o|=(c>0?1:0)*u,u<<=1;d=t(o);break;case 1:for(o=0,l=Math.pow(2,16),u=1;u!=l;)c=b.val&b.position,b.position>>=1,0==b.position&&(b.position=n,b.val=r(b.index++)),o|=(c>0?1:0)*u,u<<=1;d=t(o);break;case 2:return""}for(h[3]=d,s=d,y.push(d);;){if(b.index>e)return"";for(o=0,l=Math.pow(2,m),u=1;u!=l;)c=b.val&b.position,b.position>>=1,0==b.position&&(b.position=n,b.val=r(b.index++)),o|=(c>0?1:0)*u,u<<=1;switch(d=o){case 0:for(o=0,l=Math.pow(2,8),u=1;u!=l;)c=b.val&b.position,b.position>>=1,0==b.position&&(b.position=n,b.val=r(b.index++)),o|=(c>0?1:0)*u,u<<=1;h[p++]=t(o),d=p-1,f--;break;case 1:for(o=0,l=Math.pow(2,16),u=1;u!=l;)c=b.val&b.position,b.position>>=1,0==b.position&&(b.position=n,b.val=r(b.index++)),o|=(c>0?1:0)*u,u<<=1;h[p++]=t(o),d=p-1,f--;break;case 2:return y.join("")}if(0==f&&(f=Math.pow(2,m),m++),h[d])g=h[d];else{if(d!==p)return null;g=s+s.charAt(0)}y.push(g),h[p++]=s+g.charAt(0),f--,s=g,0==f&&(f=Math.pow(2,m),m++)}}};return a}(),n=!0;if(!n)return e;var r={getItem:function(){var n=e.getItem.apply(e,arguments);return n&&0===n.indexOf("LZ_")&&(n=t.decompress(n.substr(3))),n},setItem:function(n,r){return r&&n&&n.match(/mapping-|loginurl-|-to-push|form-rules/i)&&r.length>500&&(r="LZ_"+t.compress(r)),e.setItem(n,r)},removeItem:function(t){return e.removeItem(t)},clear:function(){e.clear()}};if(!r.getItem("compressed")){Date.now();r.setItem("compressed",1);var i=r.getItem("mapping-buckets",null);if(i){i=JSON.parse(i);for(var a=0;a<i.length;a++){var s=r.getItem("mapping-"+i[a],null);s&&r.setItem("mapping-"+i[a],s)}}}return r}return{wrap:e}}),ABINE_DNTME.define("abine/localStorage",["abine/compressedLocalStorage"],function(e){return e.wrap(window.localStorage)}),ABINE_DNTME.define("abine/pay_button",[],function(){return{show:function(e,t){t&&t.match(/^(1800flowers.com|bestbuy.com|walmart.com|kohls.com|target.com)$/)&&chrome.tabs.executeScript(e,{file:"/pages/pay_button.js",allFrames:!1,runAt:"document_end"})}}}),ABINE_DNTME.define("abine/tabs",["abine/core","abine/url"],function(e,t){var n=e.BaseClass.extend({init:function(e){chrome.tabs.onActivated.addListener(function(n){n.tabId!=-1&&chrome.tabs.get(n.tabId,function(n){n&&n.url&&(n.url.match("https?://")||n.url.match("chrome-extension://"))&&e.send("background:contextmenu:refresh",{domain:t.getTLD(n.url)})})}),chrome.windows.onFocusChanged.addListener(function(n){n!=-1&&chrome.windows.get(n,{populate:!0},function(n){if(n&&n.tabs)for(var r=0;r<n.tabs.length;r++)n.tabs[r].active&&n.tabs[r].url&&(n.tabs[r].url.match("https?://")||n.tabs[r].url.match("chrome-extension://"))&&e.send("background:contextmenu:refresh",{domain:t.getTLD(n.tabs[r].url)})})})}});return{tabHelper:new n}}),ABINE_DNTME.define("abine/toolbar",["documentcloud/underscore","abine/timer","jquery","abine/securityManager","storage"],function(e,t,n,r){function i(){}function a(e){chrome.browserAction.setIcon({path:"pages/images/icon-lock.png",tabId:e})}function s(e){chrome.browserAction.setIcon({path:"images/Icon.png",tabId:e})}function o(e){var t=r.isLocked(),n=[255,0,0,255],i=[0,125,0,255],a=[225,193,0,255],s=i;e.total>e.blocked+e.suggested?s=n:e.suggested>0&&(s=a);var o=e.total+"";if(!e.disabled&&ABINE_DNTME.dnt_api.getDefaultBlocking()||(o="off",s=n),chrome.browserAction.setBadgeText({text:o,tabId:e.tabId}),chrome.browserAction.setBadgeBackgroundColor({color:s,tabId:e.tabId}),e.isBadge)chrome.browserAction.setIcon({path:e.iconPath,tabId:e.tabId});else if(e.customImage){var c=document.createElement("canvas"),l=c.getContext("2d"),u=new Image;u.onload=function(){l.drawImage(this,0,0),chrome.browserAction.setIcon({imageData:l.getImageData(0,0,u.width,u.height),tabId:e.tabId})},u.src=e.customImage}else chrome.browserAction.setIcon({path:t?"pages/images/icon-lock.png":"/images/Icon.png",tabId:e.tabId})}return r.on("background:securityManager:initialized",function(){r.on("background:securityManager:locked",function(){chrome.tabs.query({},e.bind(function(t){e.each(t,e.bind(function(e){a(e.id)},this))},this))}),r.on("background:securityManager:unlocked",function(){chrome.tabs.query({},e.bind(function(t){e.each(t,e.bind(function(e){s(e.id)},this))},this))}),r.isLocked()?chrome.tabs.query({},e.bind(function(t){e.each(t,e.bind(function(e){a(e.id)},this))},this)):chrome.tabs.query({},e.bind(function(t){e.each(t,e.bind(function(e){s(e.id)},this))},this))}),{freshInstall:i,updateIcon:o}}),ABINE_DNTME.define("abine/tour",[],function(){return{show:function(e){chrome.tabs.insertCSS(e,{file:"/pages/postinstall.css"}),chrome.tabs.executeScript(e,{file:"/pages/postinstall.js",allFrames:!1,runAt:"document_end"})}}}),ABINE_DNTME.define("abine/window",["documentcloud/underscore","abine/timer","jquery"],function(e,t,n){function r(t){var n=[];return e.each(t,function(e,t){n.push(t.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})+":"+e)}),n.join(" !important;")}function i(t,n){e.each(n,function(e,n){t.setAttribute(n,e)})}var a="panel.html",s=function(){},o=function(e,n){e.documentElement?e.documentElement.appendChild(n):t.setTimeout(function(){o(e,n)},100)};return{createTab:function(t,n){function r(r){var s=e.find(r,function(e){return e.url.indexOf(a)!=-1});s||t.doNotOpenNewTab?s&&(chrome.tabs.update(s.id,{active:!t.doNotActivate,url:i}),chrome.windows.get(s.windowId,function(e){"minimized"==e.state&&chrome.windows.update(e.id,{state:"normal"}),chrome.windows.update(e.id,{focused:!0}),n()})):(chrome.tabs.create({active:!0,url:i}),n())}n=n||s;var i=t.localUrl?chrome.extension.getURL(t.localUrl):t.url;if(t.force)return chrome.tabs.create({active:!0,url:i}),void n();var a=i.replace(/http[s]?/i,"").replace(/\?.*/i,"").replace(/\#.*/i,"");chrome.tabs.query({},r)},getWebappTabs:function(t){chrome.tabs.query({url:ABINE_DNTME.config.protocol+ABINE_DNTME.config.webAppHost+"/*"},function(n){var r=[];e.each(n,function(e){r.push(e.id)}),t(r)})},openWindow:function(e,t,n){chrome.windows.create({url:e,width:t,height:n,focused:!0,type:"popup"})},reloadTab:function(t,n){function r(r){var s=e.find(r,function(e){return e.url.indexOf(a)!=-1});s||t.doNotOpenNewTab?s&&(chrome.tabs.reload(s.id),t.doNotActivate||(chrome.tabs.update(s.id,{active:!0}),chrome.windows.get(s.windowId,function(e){"minimized"==e.state&&chrome.windows.update(e.id,{state:"normal"}),chrome.windows.update(e.id,{focused:!0}),n()}))):(chrome.tabs.create({active:!0,url:i}),n())}n=n||s;var i=t.localUrl?chrome.extension.getURL(t.localUrl):t.url,a=i.replace(/http[s]?/i,"").replace(/\?.*/i,"").replace(/\#.*/i,"");chrome.tabs.query({},r)},createPanel:function(t){var n=t.localUrl?chrome.extension.getURL(t.localUrl):t.url,s=t.document||document||window.document,c=t.panelWidth?t.panelWidth:368;if(!s)throw"Error. abine/window createPanel called without a document context.";var l=t.id||"abine"+Math.floor(1e8*Math.random());n=n?n:chrome.extension.getURL(a)+"?"+l;var u=s.createElement("iframe"),d=s.createElement("div");return d.className=t.className||"abineContentPanel",u.className="abineContentFrame",i(d,{style:r(e.extend({backgroundColor:"transparent",margin:"0",padding:"0",display:"none",opacity:"1",filter:"alpha(opacity:100)"},t.style))}),i(u,{width:c+"px",allowTransparency:"true",frameborder:0,height:t.panelHeight+"px",scrolling:"no",src:n,id:l,style:r(e.extend({position:"relative",display:"block",background:"transparent",borderWidth:"0px",left:"0px",top:"0px",visibility:"visible",opacity:1,filter:"alpha(opacity:100)",margin:"0",padding:"0",height:t.panelHeight+"px",width:c+"px"}))}),d.appendChild(u),o(s,d,u),u},autoResizePanels:function(t){var r,i=t.document||document||window.document;i.getElementsByTagName("body")[0];if(t.frameId){var a=i.getElementById(t.frameId);a&&(r=[a.parentElement])}r||(r=i.getElementsByClassName(t.className||"abineContentPanel")),e(r).each(function(e){var r=n("iframe",e)[0];r.scrolling="no",n(r).height("auto");var i=n(r).width(),a=t.documentHeight;t.extraWidth&&(i+=t.extraWidth),t.extraHeight&&(a+=t.extraHeight),n(r).width(i),n(r).height(a),e.style.width=i+"px",e.style.height=a+"px";try{var s=parseInt(e.style.left),o=s+e.offsetWidth,c=e.ownerDocument.defaultView.innerWidth,l=e.ownerDocument.documentElement.scrollLeft+c;if(o>l){var u=o-l;if(s-u>0)e.style.left=s-u+"px";else if(e.style.left="0px",c<o-s){var d=Math.round(c/(o-s)*100);d-=1,d<80&&(d=80),r.style.zoom=d+"%",r.contentDocument.body.style.zoom=d+"%"}}}catch(e){}})},removePanels:function(t){function r(e,t){if(!t){var r=n("iframe",e);if(r.length>0&&(t=r[0]),!t)return}t.id.indexOf("doNotRemove")!=-1?n(t.parentNode).hide():t.parentNode.parentNode.removeChild(t.parentNode)}var i=t.document||document||window.document;if(t.iframe)return void r(null,t.iframe);var a=i.getElementsByClassName("abineContentPanel");e(a).each(function(e){r(e)})}}}),ABINE_DNTME.define("abine/core",["documentcloud/underscore"],function(e){var t={on:function(e,t,n){var r=this._callbacks||(this._callbacks={}),i=r[e]||(r[e]={}),a=i.tail||(i.tail=i.next={});return a.callback=t,a.context=n,i.tail=a.next={},this},off:function(e,t){var n,r,i;if(e){if(n=this._callbacks)if(t){if(r=n[e])for(;(i=r)&&(r=r.next);)if(r.callback===t){i.next=r.next,r.context=r.callback=null;break}}else n[e]={}}else this._callbacks=null;return this},trigger:function(e){var t,n,r,i,a,s=["all",e];if(!(n=this._callbacks))return this;for(;a=s.pop();)if(t=n[a])for(i="all"==a?arguments:Array.prototype.slice.call(arguments,1);t=t.next;)(r=t.callback)&&r.apply(t.context||this,i);return this},once:function(e,t,n){function r(){return i.off(e,r),t.apply(this,arguments)}var i=this;return this.on(e,r,n)},onceAny:function(){function e(){for(var n=0;n<t.length;n++)this.off.apply(this,[t[n][0],e]),this.off.apply(this,t[n])}for(var t=arguments,n=0;n<arguments.length;n++)this.on.apply(this,arguments[n]),this.on.apply(this,[arguments[n][0],e]);return this},hasListeners:function(e){var t,n;if(!(n=this._callbacks))return!1;if(!(t=n[e]))return!1;for(;t=t.next;)if(t.callback)return!0;return!1}};t.bind=t.on,t.unbind=t.off;var n=function(){},r=function(t,r,i){var a;return a=r&&r.hasOwnProperty("constructor")?r.constructor:function(){return t.apply(this,arguments)},e.extend(a,t),n.prototype=t.prototype,a.prototype=new n,r&&e.extend(a.prototype,r),i&&e.extend(a,i),a.prototype.constructor=a,a.__super__=t.prototype,a},i=function(e,t){var n=r(this,e,t);return n.extend=this.extend,n},a=function(){this.initialize.apply(this,arguments)};return e.extend(a.prototype,t,{initialize:function(){}}),a.extend=i,{BaseClass:a,Events:t}}),ABINE_DNTME.define("abine/backgroundEventLogger",["abine/config","storage","persistence","documentcloud/underscore"],function(e,t,n,r){function i(){function e(e){try{Console(e)}catch(e){}}var t=(new Date).toUTCString();return"undefined"==typeof console||"undefined"==typeof console.debug?{finest:function(n){e("[FINEST]["+t+"]: "+n)},debug:function(n){e("[DEBUG]["+t+"]: "+n)},info:function(n){e("[INFO]["+t+"]: "+n)},warn:function(n){e("[WARNING]["+t+"]: "+n)},error:function(t){e("[ERROR]["+date+"]: "+t)}}:"undefined"!=typeof console?{finest:function(e){console.debug("[FINEST]["+t+"]: "+e)},debug:function(e){console.debug("[DEBUG]["+t+"]: "+e)},info:function(e){console.info("[INFO]["+t+"]: "+e)},warn:function(e){console.warn("[WARNING]["+t+"]: "+e)},error:function(e){console.error("[ERROR]["+t+"]: "+e)}}:void 0}var a=function(){},s=i();switch(s.dumpObj=function(e){var t=typeof e;if("object"!=t||null===e)return"string"==t&&(e='"'+e+'"'),String(e);var n,r,i=[],a=e&&e.constructor==Array;for(n in e)r=e[n],t=typeof r,"string"==t?r='"'+r+'"':"object"==t&&null!==r&&(r=s.dumpObj(r)),i.push((a?"":'"'+n+'":')+String(r));return(a?"[":"{")+String(i)+(a?"]":"}")},e.logLevel){case"NONE":s.error=a;case"ERROR":s.warn=a;case"WARN":s.info=a;case"INFO":s.debug=a;case"DEBUG":s.finest=a}return s.info("Log level set to "+e.logLevel),ABINE_DNTME.log=ABINE_DNTME.log||s,s}),ABINE_DNTME.define("abine/backgroundInit",["abine/storageRouter","abine/storage/registry","abine/window","storage","abine/securityManager","abine/stubs","abine/toolbar","abine/timer","abine/ajax","abine/config","abine/pageEvents","abine/tabs","persistence","abine/mappingServer","modules","documentcloud/underscore","abine/browserSyncStorage","abine/core","abine/dntmeInit","abine/conflict_handler","abine/saveForms","abine/formSubmitDetector","abine/localStorage","abine/responseCodes","abine/licenseServer","abine/savePaymentForms"],function(e,t,n,r,i,a,s,o,c,l,u,d,h,f,p,m,g,y,b,v,_,w,k,E,A,T){function S(n){if(!F){a.start(n),w.formSubmitDetector.init(n),_.init(n),T.init(n),n.on("background:show:notification:forward",function(e,t){n.send("background:show:notification",e,t)}),n.on("background:create:panel:forward",function(e,t){n.send("background:create:panel",e,t)}),n.on("contentManager:init",function(e,t){}),F=!0,m.each(m.values(p),function(e){e.setMessenger&&e.setMessenger(n)}),d.tabHelper.init(n);var i=new e.StorageRouter({messenger:n,noMigrations:!0,ready:function(){r.Preference.setupUpgradeDefaults();try{I(n)}catch(e){}}});t.registerStorageEntities(i),P(n)}}function N(e,t){if(e=e.split("."),t=t.split("."),e.length>t.length)return!0;for(var n=0;n<e.length;n++){if(parseInt(e[n],10)<parseInt(t[n],10))return!1;if(parseInt(e[n],10)>parseInt(t[n],10))return!0}return!1}function C(){var e=function(){r.Preference.findBy("key","authToken",function(e){e&&e.value?r.Preference.findBy("key","lastActivity",function(t){r.Preference.findBy("key","autolock",function(n){if(n&&"restart"==n.value&&!ABINE_DNTME._started)return void p.licenseModule.logout(e.value,function(){h.remove(t),i.setAuthToken("","","")});if(ABINE_DNTME._started=!0,n&&"never"!=n.value){var r=Date.now();r-parseFloat(t.value)>=60*parseFloat(n.value)*60*1e3&&p.licenseModule.logout(e.value,function(){h.remove(t),i.setAuthToken("","","")})}})}):ABINE_DNTME._started=!0})};o.setInterval(e,6e4),e()}function I(e){G.trigger("storage:initialized"),r.Preference.findBy("key","new_version",function(e){e&&(e.value==l.version||N(e.value,l.version))&&(h.remove(e),h.flush())}),v.checkForMaskme(function(t){try{b.initialize(e)}catch(e){ABINE_DNTME.log.error("error during dntme initialization "+e.message+e.stack)}U||(U=!0,u.initialize(e),i.load(e),C(),p.criticalProcess.setMessenger(e),x(function(e){var t=0;e&&(t=12e4),o.setTimeout(m.bind(function(){p.mappingsModule.startDailyMappingCheck()},this),t),ABINE_DNTME.setupUninstallUrl()}))})}function M(e){e=e||q,r.Preference.batchCreateOrModify([{key:"installUserAgent",value:ABINE_DNTME.userAgent},{key:"installVersion",value:l.version},{key:"installTags",value:l.tags[0]},{key:"installDate",value:Date.now()}],function(){e()}),l.silent&&r.Preference.batchCreateOrModify([{key:"showMedals",value:"false"},{key:"showCheckoutPanelGrowl",value:"false"},{key:"suggestProtectedEmail",value:"false"},{key:"suggestProtectedPhone",value:"false"},{key:"suggestProtectedCard",value:"false"},{key:"showTrackersOnload",value:"false"},{key:"showWeeklyReports",value:"false"}],function(){e()})}function D(e){e=e||q;var t="http://";"production"==ABINE_DNTME.config.environment&&(t="https://");var n=t+ABINE_DNTME.config.webHost+"/maskme/v2/tag.php?currentTag="+l.tags[0];c.ajax({url:n,success:function(t){try{t=JSON.parse(t)}catch(e){t={}}t&&""!=t&&t.abineMaskMeTag&&""!=t.abineMaskMeTag?(l.tags.unshift(t.abineMaskMeTag),r.Preference.createOrModify({key:"dynamicTag",value:t.abineMaskMeTag},function(){e()})):e()},error:function(){e()}})}function x(e){e=e||q,r.Preference.findBy("key","freshInstall",function(t){if(!t||"false"===t.value)return void r.Preference.findBy("key","installVersion",function(t){t&&(t.value<"4.5"?r.Preference.findBy("key","showBlurGrowl",function(e){e||(r.Preference.createOrModify({key:"showBlurGrowl",value:"true"},function(){}),r.Preference.createOrModify({key:"showBlurPage",value:"true"},function(){}))}):r.Preference.findBy("key","showBlurGrowl",function(e){e||(r.Preference.createOrModify({key:"showBlurGrowl",value:"false"},function(){}),r.Preference.createOrModify({key:"showBlurPage",value:"false"},function(){}))})),r.Preference.findBy("key","dynamicTag",function(t){t&&l.tags.unshift(t.value),l.silent||l.tags[0].toUpperCase().indexOf("YT14")==-1||(l.silent=!0),p.licenseModule.startDailyTouch(function(){L(function(){R(e)})})})});l.silent||l.tags[0].toUpperCase().indexOf("YT14")==-1||(l.silent=!0);var n=!0;t.value="false",h.add(t),s.freshInstall(),M(function(){D(function(){v.checkForMergedAddon(function(t,a){v.installAuthTokenCheck(t,function(){p.licenseModule.startDailyTouch(function(){R(function(){B(function(){if(l.silent)e(n);else{var s="http://"+ABINE_DNTME.config.webHost+"/blur/postinstall?";ABINE_DNTME.maskme_installed&&(s+="maskme=1&"),t&&a&&(s+="merged=1&",r.Preference.createOrModify({key:"mergedMigrationPending",value:"true"},function(){})),ABINE_DNTME.dntme_upgrade&&(s+="upgrade=1&"),s+="webapp="+ABINE_DNTME.config.protocol+ABINE_DNTME.config.webAppHost,s+="&tour=1",O(s,function(){i.openPage(s,!0),e(n)})}})})})})})})})})}function O(e,t){t=t||q,r.Preference.createOrModify({key:"postInstallUrl",value:e},function(){t()})}function P(e){e.on("window:createTab",function(e){e.panelData&&(ABINE_DNTME.lastPanel||(ABINE_DNTME.lastPanel={}),ABINE_DNTME.lastPanel[e.panelData.action]=e.panelData.type),n.createTab(e)})}function B(e){try{var t=[j,H,J],n=m.after(t.length,e);r.Preference.findBy("key","splitTests",function(r){if(r&&r.value){var i=JSON.parse(r.value);m.each(t,function(e){e(i,n)})}else e()})}catch(t){e()}}function R(e){try{r.Preference.findBy("key","configOverrides",function(t){if(t&&t.value){var n=JSON.parse(t.value);for(var r in n)r in ABINE_DNTME.config&&(ABINE_DNTME.config[r]=n[r],ABINE_DNTME.config.overriddenKeys[r]=!0)}e()})}catch(t){e()}}function L(e){r.Preference.createOrModify({key:"showTrackersOnload",value:"false"},function(){e()})}ABINE_DNTME.setupUninstallUrl=function(){r.Preference.findBy("key","installAuthToken",function(e){try{var t=ABINE_DNTME.config.protocol+ABINE_DNTME.config.webHost+"/blur/uninstall?p="+btoa(JSON.stringify({b:ABINE_DNTME.config.browser,v:ABINE_DNTME.config.version,t:ABINE_DNTME.config.tags[0],e:ABINE_DNTME.config.environment,i:i.getUserId(),ia:e?e.value:null}));"undefined"==typeof browser?chrome.runtime.setUninstallURL(t):browser.runtime.setUninstallURL(t)}catch(e){console.log(e)}})};var F=!1,q=function(){},U=!1,H=function(e,t){t()},j=function(e,t){if(e){var n=e.intrusive01;l.silent||null==n?t():(p.licenseModule.logSplitData({bucket_id:n,test_data:{int0:1}}),n==E.SPLIT_INTRUSIVE_NON_INTRUSIVE?r.Preference.createOrModify({key:"showTrackersOnload",value:"false"},function(){t()}):t())}else t()},J=function(e,t){if(e){var n=e.iconpanels01;l.silent||null==n?t():(p.licenseModule.logSplitData({bucket_id:n,test_data:{int0:1}}),n!=E.SPLIT_ICON_PANELS_NORMAL?r.Preference.createOrModify({key:"useIconPanelMode",value:n},function(){t()}):t())}else t()};ABINE_DNTME.bguser={shouldSendErrorReports:function(){var e=r.Preference.getSync("shouldSendErrorReports");return e&&e.isTrue()},getEmailSalt:function(){var e=r.Preference.getSync("Salt.ShieldedEmail");return e&&e.value}};var G={initialize:S};return m.extend(G,y.Events),G}),ABINE_DNTME.define("abine/badgeManager",["documentcloud/underscore"],function(){return{badges:{totalBlocked:{levels:[{name:"dntp.badges.bronze",limit:500,cssClass:"Bronze",icon:"/images/bronze-sm.png"},{name:"dntp.badges.silver",limit:5e3,cssClass:"Silver",icon:"/images/silver-sm.png"},{name:"dntp.badges.gold",limit:1e4,cssClass:"Gold",icon:"/images/gold-sm.png"},{name:"dntp.badges.platinum",cssClass:"Platinum",limit:25e3,icon:"/images/platinum-sm.png",level:1}],text:"dntp.badges.totalBlocked.text",title:"dntp.badges.totalBlocked.title",badgeText:"dntp.badges.totalBlocked.badgeText"},socialBlocked:{levels:[{name:"dntp.badges.bronze",limit:100,cssClass:"Bronze",icon:"/badge/bronze.png"},{name:"dntp.badges.silver",limit:1e3,cssClass:"Silver",icon:"/badge/silver.png"},{name:"dntp.badges.gold",limit:5e3,cssClass:"Gold",icon:"/badge/gold.png"},{name:"dntp.badges.platinum",cssClass:"Platinum",limit:15e3,icon:"/badge/platinum.png",level:1}],text:"dntp.badges.socialBlocked.text",title:"dntp.badges.socialBlocked.title",badgeText:"dntp.badges.socialBlocked.badgeText"}},getBadgeAt:function(e,t){var n={name:"None",limit:-1,icon:"/badge/nobadge.png"},r=this.badges[e];if(t>=0){var i=r.levels;if(t>=i.length)for(var a=i.length-1;a<=t;a++){var s={name:i[a].name,cssClass:i[a].cssClass,limit:i[a].limit+(0==e.indexOf("social")?1e4:25e3),icon:i[a].icon,level:i[a].level+1};i.push(s)}n=i[t]}return n.title=r.title,n.text=r.text,n.badgeText=r.badgeText,n.setting=e,n},compute:function(e){for(var t={},n="totalBlocked",r=0,i=-1;;){var a=this.getBadgeAt(n,r);if(a.limit>e)break;a.limit<e&&(i=r,t=a),r++}return{badgeIndex:i,badge:t}}}}),ABINE_DNTME.define("abine/merged-dataset",["documentcloud/underscore","abine/core","abine/localStorage","storage","abine/timer","persistence","modules","abine/securityManager","aws","abine/crypto"],function(e,t,n){var r=n.getItem("maxRecords")||1e3,i=function(e){this.client=e};return i.prototype.refreshDatasetNames=function(t,n){var r=this;this.client.refreshDatasetMetadata(function(){r.client.listDatasets(function(i,a){r.datasetNames=[t],e.each(a,function(e){e.datasetName&&e.datasetName.indexOf(t)!==-1&&e.datasetName!==t&&r.datasetNames.push(e.datasetName)}),n()})})},i.prototype.updateDatasets=function(t,n){var r=this,i=e.clone(this.datasetNames),a=!1;this.client.refreshDatasetMetadata(function(){r.client.listDatasets(function(s,o){e.async.forEachSeries(o,function(n,s){n.datasetName&&n.datasetName.indexOf(t)!==-1?(r.datasetNames.indexOf(n.datasetName)===-1?a=!0:i=e.without(i,n.datasetName),s()):s()},function(){a||i.length>0?r.openOrCreateDataset(t,n):n()})})})},i.prototype.openOrCreateDataset=function(t,n){var r=this;this.refreshDatasetNames(t,function(){r.datasets=[],e.async.forEachSeries(r.datasetNames,function(e,t){r.client.openOrCreateDataset(e,function(e,n){r.datasets.push(n),t()})},function(){n()})})},i.prototype.getAllRecords=function(t){var n=[];e.async.forEachSeries(this.datasets,function(e,t){e.getAllRecords(function(e,r){n=n.concat(r),t()})},function(){t(null,n)})},i.prototype.remove=function(t,n){var r=!1,i=this;e.async.forEachSeries(this.datasets,function(e,a){return r?void a():void e.get(t,function(s,o){void 0!==o&&(r=!0,e.remove(t,n),e!==i.datasets[0]&&i.touchDefaultDataset()),a()})},function(){r||n(null)})},i.prototype.getCorrectSyncCount=function(e){this.datasets[0].getCorrectSyncCount(e)},i.prototype.hasChanges=function(t){e.async.forEachSeries(this.datasets,function(e,n){e.hasChanges(function(e,r){return r?void t(null,!0):void n()})},function(){t(null,!1)})},i.prototype.put=function(t,n,i,a){var s=this,o=!1;e.async.forEachSeries(this.datasets,function(e,r){return o?void r():void e.get(t,function(i,a){void 0!==a&&(o=!0,e.put(t,n,function(){})),r()})},function(){o?a?i():s.touchDefaultDataset(i):e.async.forEachSeries(s.datasets,function(e,i){return o?void i():void e.getAllRecords(function(a,s){s&&s.length<r&&(o=!0,e.put(t,n,function(){})),i()})},function(){var e;if(o)a?i():s.touchDefaultDataset(i);else{for(e=1;s.datasetNames.indexOf(e+"_BlurData")!==-1;)e+=1;s.client.openOrCreateDataset(e+"_BlurData",function(r,o){s.datasetNames.push(e+"_BlurData"),s.datasets.push(o),o.put(t,n,function(){a?i():s.touchDefaultDataset(i,!0)})})}})})},i.prototype.touchDefaultDataset=function(e,t){var n=this;this.datasets.length>1?this.datasets[0].hasChanges(function(r,i){!i||t?n.datasets[0].put("Dummy:1",JSON.stringify({id:"1",data:Math.random(),modifiedAt:new Date,numDatasets:n.datasets.length}),function(){e&&e()}):e&&e()}):e&&e()},i.prototype.putAll=function(t,n){var r=this,i=e.keys(t);e.async.forEachSeries(i,function(e,n){r.put(e,t[e],function(){n()})},function(){r.touchDefaultDataset(n)},!0)},i.prototype.synchronize=function(t){var n=this,r=!0;e.async.forEachSeries(this.datasets,function(n,i){n.synchronize({onSuccess:function(){i()},onFailure:function(e){r=!1,t.onFailure(e)},onConflict:function(t,n,r){var i;i=[],e.each(n,function(e){var t,n,r,a;if(""===e.remoteRecord.value)i.push(e.resolveWithRemoteRecord());else if(""===e.localRecord.value)i.push(e.resolveWithLocalRecord());else if(e.remoteRecord.value===e.localRecord.value)i.push(e.resolveWithRemoteRecord());else{try{t=JSON.parse(e.localRecord.value),r=JSON.parse(e.remoteRecord.value)}catch(e){}try{n=new Date(t.modifiedAt)}catch(e){}try{a=new Date(r.modifiedAt)}catch(e){}n>a?i.push(e.resolveWithLocalRecord()):i.push(e.resolveWithRemoteRecord())}}),t.resolve(i,function(e){e||r(!0)})},onDatasetDeleted:function(e,t,n){n(!0)},onDatasetsMerged:function(e,t,n){n(!0)}})},function(){r&&(t.onSuccess(),n.datasets[0].get("Dummy:1",function(e,r){var i;if(r){try{i=JSON.parse(r)}catch(e){}i&&i.numDatasets>n.datasets.length&&n.updateDatasets("BlurData",function(){t.resync()})}}))})},i}),ABINE_DNTME.define("abine/blurstore-api",["documentcloud/underscore","abine/core","abine/localStorage","storage","abine/timer","persistence","modules","abine/securityManager","aws","abine/crypto","abine/merged-dataset","abine/pageEvents","abine/perf"],function(e,t,n,r,i,a,s,o,c,l,u,d,h){c.CognitoSyncManager.localStorage=n;var f,p=6e5,f=function(){};c.CognitoSyncManager.Dataset.prototype.getCorrectSyncCount=function(t){var n=this;this.getDatasetMetadata(function(r,i){i.lastSyncCount?t(i.lastSyncCount):n.getAllRecords(function(n,r){var i=0;e.each(r,function(e){e.syncCount&&e.syncCount>i&&(i=e.syncCount)}),t(i)})})};var m=t.BaseClass.extend({initialize:function(){this.tables={},this.synchronize=e.debounce(e.bind(this._synchronize,this),1e3)},connect:function(){this._pendingConnect||(this._connected=!1,this._pendingConnect=!0,s.licenseModule.retrieveSyncstoreToken(e.bind(function(t,n){if(t||"blur"!=n.manager)return void(this._pendingConnect=!1);var r={AccountId:n.account_id,IdentityPoolId:n.identity_pool_id,RoleArn:n.role_arn,WebIdentityToken:n.token,RoleSessionName:"extension"};c.config.region=n.region,c.config.correctClockSkew=!0,c.config.credentials=new c.WebIdentityCredentials(r),this.datasetPollTimer&&i.clearInterval(this.datasetPollTimer),c.config.credentials.get(e.bind(function(){c.config.credentials.identityId=n.identity_id,this.client=new c.CognitoSyncManager({log:f}),this.dataset=new u(this.client),this._connected=!0,this._pendingConnect=!1,this.dataset.openOrCreateDataset("BlurData",e.bind(function(){this.synchronize(),this.datasetPollTimer=i.setInterval(e.bind(this._synchronize,this),p)},this))},this))},this)))},connectAndLoad:function(){this._connected||(this.lastSyncCount=-1,this.connect())},disconnect:function(){this._connected&&i.clearInterval(this.datasetPollTimer),this.lastSyncCount=-1,this._connected=!1,this.client=null,this.dataset=null},addTable:function(e){this.tables[e]=1},updateAll:function(){e.each(this.tables,e.bind(function(e,t){this.load(t)},this))},load:function(t){function n(e){if(i.meta.encrypted&&!c){var t=l.decryptObject(s,e,i.meta.encryptedFields,h);h=!1,1==t?c=!0:2==t&&d.push(e)}e.masked_email&&delete e.masked_email}if(this._connected){var i=r[t],s=null;i.meta.encrypted&&(s=o.getEncryptionKey());var c=!1,u={},d=[],h=!0;this.dataset.getAllRecords(e.bind(function(s,o){e.each(o,e.bind(function(e){if(e.value&&0!=e.value.length&&0==e.key.indexOf(t+":")){var n=e.key;try{e=JSON.parse(e.value)}catch(e){}return e&&e.id?void(u[e.id]=e):void this.dataset.remove(n,function(){})}},this)),i.index(null,e.bind(function(s){e.each(s,function(e){if(!c){var t=u[e.id];if(1==e.pushed)if(t){if((e.modifiedAt!=t.modifiedAt||e.createdAt!=t.createdAt)&&(n(t),!c)){i.updateCache(e,t);var r=!1;for(var s in e._dirtyProperties)if(e._dirtyProperties.hasOwnProperty(s)){r=!0;break}e.pushed=1}delete u[e.id]}else a.remove(e);else t?(e.pushed=1,e.modifiedAt>t.modifiedAt?e.markDirty("pushed"):e.modifiedAt==t.modifiedAt&&e.createdAt==t.createdAt||(n(t),c||(i.updateCache(e,t),e.pushed=1)),delete u[e.id]):e.markDirty("pushed")}}),c||(e.each(u,function(e){n(e);var i=new r[t](e);i._dirtyProperties={},i._new=!1,i._notInLocalStorage=!0,a.add(i)}),a.flush(),d.length>0&&(e.each(d,e.bind(function(e){e.pushed=0},this)),this.save(t)))},this))},this))}},synchronizeWhenOld:function(e,t){this.dataset&&e&&!isNaN(e)&&this.lastSyncCount<e&&("push"==t&&(this._externalSync=!0),this.synchronize())},canUpdateAll:function(t){var n=this;this.dataset.getAllRecords(function(i,a){var c=!!e.find(a,function(e){return e.value&&e.value.length>0});if(c)t(!0);else{var l=!1,u=!1;e.async.forEachSeries(e.keys(n.tables),function(e,t){l?t():r[e].index(null,function(e){e.length>0?(l=!0,s.licenseModule.retrieveSyncstoreToken(function(e,r){e||"blur"!=r.manager?(n.disconnect(),o.refreshData()):u=!0,t()})):t()})},function(){t(u)})}})},_synchronize:function(t){function n(){if(r._syncCallbacks){var t=r._syncCallbacks;r._syncCallbacks=null,e.each(t,function(e){try{e()}catch(e){}})}}var r=this;if(this._connected)return this.syncInProgress?void(t&&(this._syncCallbacks=this._syncCallbacks||[],this._syncCallbacks.push(t))):(this.syncInProgress=!0,this.dataset.synchronize({resync:function(){r.synchronize()},onSuccess:function(){r.syncInProgress=!1,r._reconnectAttempt=0,r.canUpdateAll(function(e){return e?(r.updateAll(),n(),
void ABINE_DNTME.require(["abine/pageEvents","abine/pushNotifications"],function(e,t){r.dataset.getCorrectSyncCount(function(e){r.lastSyncCount&&r.lastSyncCount<e&&(ABINE_DNTME.backgroundMessenger.sendToWebapp("abine:store:sync",e),r._externalSync||t.pushSync(e),r._externalSync=!1),r.lastSyncCount=e})})):void n()})},onFailure:function(e){if(r.syncInProgress=!1,e&&("CredentialsError"===e.code||e.message&&e.message.match(/signature expired/i))){r._reconnectAttempt||(r._reconnectAttempt=0),r._reconnectAttempt++;var t=0;r._reconnectAttempt>1&&(t=5*Math.random()*60*1e3+3e5),i.setTimeout(function(){r.disconnect(),r.connect()},t)}n()}}))},save:function(t){if(this._connected){var n=r[t],i=null;n.meta.encrypted&&(i=o.getEncryptionKey());var s=!1,c=this,u={},d=[];n.index(null,function(r){function o(){c.dataset.putAll(u,function(){c.synchronize(),e.each(d,function(e){ABINE_DNTME.backgroundMessenger.sendToWebapp("update:entity",[e.name,e.obj])})})}e.each(r,function(r){if(1!==r.pushed){s=!0;var a=r.toJSON();a.pushed=1,d.push({name:t,obj:e.clone(a)}),n.meta.encrypted&&i&&l.encryptObject(i,a,n.meta.encryptedFields),u[t+":"+a.id]=JSON.stringify(a)}}),s&&(a.flush(),c.syncInProgress?c._synchronize(o):o())})}},"delete":function(e,t){var n=this;if(n._connected)try{n.dataset.remove(e+":"+t,function(){n.synchronize(),ABINE_DNTME.backgroundMessenger.sendToWebapp("delete:entity",[e,t])})}catch(e){}}});return new m}),ABINE_DNTME.define("abine/contextHelper",["documentcloud/underscore","abine/window","storage","abine/password","abine/config","abine/securityManager","abine/webapp"],function(e,t,n,r,i,a,s){return{onClick:function(t,i,a,o,c){if(i.indexOf("abine_dntme_accountfield_")>=0)this.fillLogin(i,a,t,c);else if(i.indexOf("abine_dntme_fillcard_")>=0)this.fillCard(i,a,t,c);else if(i.indexOf("abine_dntme_address_")>=0)this.fillAddress(i,a,t,c);else if(i.indexOf("abine_dntme_phone_mask_")>=0)this.fillDiposablePhone(i,a,t,c);else if(i.indexOf("abine_dntme_phone_disclose_")>=0)this.fillRealPhone(i,a,t,c);else switch(i){case"abine_dntme_ignore":this.fillFieldInTab(t,a,{element:c,value:null,dataType:"/ignore",origin:""});break;case"abine_dntme_email_mask":this.fillFieldInTab(t,a,{element:c,dataType:"/contact/email",origin:"disposable",generate:!0,formType:"registrationForm"});break;case"abine_dntme_email_disclose":n.ShieldedEmail.index(null,e.bind(function(e){this.fillFieldInTab(t,a,{element:c,value:e[0].email,dataType:"/contact/email",origin:"",formType:"registrationForm"})},this));break;case"abine_dntme_card_mask":this.triggerCreditCardPanelInTab(t,a,{});break;case"abine_dntme_activate_card":s.openCards();break;case"abine_dntme_password_mask":var l=r.generateRandomPassword();this.fillFieldInTab(t,a,{element:c,value:l,origin:"strong",generatedNow:!0,dataType:"/password",formType:"registrationForm"});var u={domain:o,password:l};t.send("background:save:account",u);break;case"abine_dntme_unlock":s.openLogin();break;case"abine_dntme_setup_phone":s.openPhones();break;case"abine_dntme_map_form":t.send("background:contextmenu:mapform",{},a);break;case"abine_dntme_autofill_form":t.send("background:contextmenu:mapform",{},a);break;case"abine_dntme_blacklisted":t.send("background:dntme:show",{tabId:a},a)}},fillLogin:function(t,r,i,a){var t=t.split("accountfield_")[1],s=t.split("_")[0],o=t.split("_")[1];n.Account.load(o,e.bind(function(e){if(e){var t=null,n=null;"email"==s?(t="/contact/email",n=e.email):"username"==s?(t="/nameperson/friendly",n=e.username):"password"==s&&(t="/password",n=e.password),t&&n&&this.fillFieldInTab(i,r,{element:a,value:n,dataType:t,origin:"",formType:"loginForm"})}},this))},fillCard:function(t,r,i,a){var t=t.split("fillcard_")[1],s=t.split("_")[0],o=t.split("_")[1];n.Address.index(null,e.bind(function(t){var c={};e.each(t,function(e){c[e.id]=e.toJSON()}),n.RealCard.load(o,e.bind(function(e){if(e){var t="/financial/creditcard/number",n=e.number;"cvc"==s?(t="/financial/creditcard/verification",n=e.cvc):"name"==s?(t="/financial/creditcard/issuedto",n=e.getFullName()):"month"==s?(t="/financial/creditcard/expiry_month",n=e.getMM()):"year"==s?(t="/financial/creditcard/expiry_year",n=e.expiry_year):"yy"==s?(t="/financial/creditcard/expiry_year2",n=e.getYY()):"mmyyyy"==s?(t="/financial/creditcard/expiry",n=e.getMMYYYY()):"mmyy"==s&&(t="/financial/creditcard/expiry2",n=e.getMMYY()),this.fillFieldInTab(i,r,{element:a,value:n,dataType:t,origin:"",formType:"checkoutForm"});var o=e.jsonWithAddress(c);this.triggerAutoFillCreditCardPanelInTab(i,r,o)}},this))},this))},fillAddress:function(t,r,i,a){var t=t.split("address_")[1],s=t.split("_")[0],o=t.split("_")[1];n.Address.load(o,e.bind(function(e){if(e){var t="/contact/postaladdress",n=e.address1;"line2"==s?(t="/contact/postaladdressAdditional",n=e.address2):"city"==s?(t="/contact/city",n=e.city):"state"==s?(t="/contact/state",n=e.state):"country"==s?(t="/contact/country",n=e.country):"zip"==s&&(t="/contact/postalcode",n=e.zip),this.fillFieldInTab(i,r,{element:a,value:n,dataType:t,origin:""})}},this))},fillPhone:function(e,t,n,r,i){switch(e){case"full":t.value=n.getPrettyNumber(),t.dataType="/contact/phone",this.fillFieldInTab(r,i,t);break;case"area":t.value=n.number.substr(0,3),t.dataType="/contact/phone/areacode",this.fillFieldInTab(r,i,t);break;case"exchange":t.value=n.number.substr(3,3),t.dataType="/contact/phone/exchange",this.fillFieldInTab(r,i,t);break;case"local":t.value=n.number.substr(6,4),t.dataType="/contact/phone/local",this.fillFieldInTab(r,i,t);break;case"last7":t.value=n.number.substr(3,7),t.dataType="/contact/phone/number",this.fillFieldInTab(r,i,t)}},fillDiposablePhone:function(t,r,i,a){var s=t.split("mask_")[1];n.DisposablePhone.index(null,e.bind(function(e){var t=e[0],n={element:a,origin:"disposable",disposableGUID:t.id};this.fillPhone(s,n,t,i,r)},this))},fillRealPhone:function(t,r,i,a){var s=t.split("disclose_")[1];n.ShieldedPhone.index(null,e.bind(function(e){var t=e[0],n={element:a,origin:""};this.fillPhone(s,n,t,i,r)},this))},fillFieldInTab:function(e,t,n){e.send("background:contextmenu:fill",n,t)},triggerCreditCardPanelInTab:function(e,t,n){e.send("background:contextmenu:maskcard",n,t)},triggerAutoFillCreditCardPanelInTab:function(e,t,n){e.send("background:contextmenu:fillcard",n,t)}}}),ABINE_DNTME.define("abine/crypto",["asmCrypto","blueimp-md5","abine/perf"],function(e,t,n){/*!
    mnemonic.js : Converts between 4-byte aligned strings and a human-readable
    sequence of words. Uses 1626 common words taken from wikipedia article:
    http://en.wiktionary.org/wiki/Wiktionary:Frequency_lists/Contemporary_poetry
    Originally written in python special for Electrum (lightweight Bitcoin client).
    This version has been reimplemented in javascript and placed in public domain.

 Copyright (c) 2012 Yiorgis Gozadinos,
 Crypho AS, Harpunveien 3, 3126 Nttery, Norway

 Permission is hereby granted, free of charge, to any person
 obtaining a copy of this software and associated documentation
 files (the "Software"), to deal in the Software without
 restriction, including without limitation the rights to use,
 copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the
 Software is furnished to do so, subject to the following
 conditions:

 The above copyright notice and this permission notice shall be
 included in all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 OTHER DEALINGS IN THE SOFTWARE.
*/
function r(e){for(var t=[],n=T.length,r=0;r<e.length;r+=8){var i=parseInt(e.substr(r,8),16),a=i%n,s=(Math.floor(i/n)+a)%n,o=(Math.floor(Math.floor(i/n)/n)+s)%n;t=t.concat([T[a],T[s],T[o]])}return t.join(" ")}function i(e,t){return e<0?t+e:e%t}function a(e){for(var t="",n=T.length,r=e.split(" "),a=0;a<r.length;a+=3){var s=T.indexOf(r[a]),o=T.indexOf(r[a+1])%n,c=T.indexOf(r[a+2])%n,l=s+n*i(o-s,n)+n*n*i(c-o,n);t+=("0000000"+l.toString(16)).slice(-8)}return t}function s(e){var t=e.replace(/[\u0080-\u07ff]/g,function(e){var t=e.charCodeAt(0);return String.fromCharCode(192|t>>6,128|63&t)});return t=t.replace(/[\u0800-\uffff]/g,function(e){var t=e.charCodeAt(0);return String.fromCharCode(224|t>>12,128|t>>6&63,128|63&t)})}function o(e){var t=e.replace(/[\u00c0-\u00df][\u0080-\u00bf]/g,function(e){var t=(31&e.charCodeAt(0))<<6|63&e.charCodeAt(1);return String.fromCharCode(t)});return t=t.replace(/[\u00e0-\u00ef][\u0080-\u00bf][\u0080-\u00bf]/g,function(e){var t=(15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2);return String.fromCharCode(t)})}function c(e){for(var t=e.length,n=[],r=0;r<t;r+=2)n[n.length]=String.fromCharCode(parseInt(e.substr(r,2),16));return n.join("")}function l(e){return S.MD5(e)}function u(e){return S.SHA256(e)}function d(e){return S.SHA1(e)}function h(e,t){var n=e+t;return n in N||(N[n]=S.createKeyAndIV(e,t)),N[n]}function f(e,t){return S.aes_encrypt(e,t)}function p(e,t){return S.aes_decrypt(e,t)}function m(e,t,n){return f(h(e,n||u(e)),t)}function g(e,t,n,r){var i=h(e,n||u(e)),a=p(i,t);return r&&t!=f(i,a)?t:a}function y(e,t,n){try{return t!=g(e,t,n,!0)}catch(e){}return!1}function b(e,t,n){for(var r=t.id,i=0;i<n.length;i++){var a=t[n[i]];if(a&&0!=a.toString().indexOf("ENC_")){var s=m(e,a,r);s!=a&&(t[n[i]]="ENC_"+s)}}}function v(e,t,n,r){for(var i=0,a=t.id,s=0;s<n.length;s++){var o=t[n[s]];if(o&&o.length>0)if(0==o.indexOf("ENC_")){if(o=o.substr(4),!e)return 1;if(r){if(!y(e,o,a))return 1;r=!1}var c=g(e,o,a);if(c==o)return 1;t[n[s]]=c}else e&&(i=2)}return i}function _(){return S.random(8)}function w(e){for(var t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz!@#$%^&*(){}[]|\\/<>?,.;~",n="",r=0;r<e;r++){var i=Math.floor(Math.random()*t.length);n+=t.substring(i,i+1)}return n}function k(){return S.random(16)}function E(e){var t=h(e,e);return u(f(t,e))}function A(e){return E(E(e))}var T=["like","just","love","know","never","want","time","out","there","make","look","eye","down","only","think","heart","back","then","into","about","more","away","still","them","take","thing","even","through","long","always","world","too","friend","tell","try","hand","thought","over","here","other","need","smile","again","much","cry","been","night","ever","little","said","end","some","those","around","mind","people","girl","leave","dream","left","turn","myself","give","nothing","really","off","before","something","find","walk","wish","good","once","place","ask","stop","keep","watch","seem","everything","wait","got","yet","made","remember","start","alone","run","hope","maybe","believe","body","hate","after","close","talk","stand","own","each","hurt","help","home","god","soul","new","many","two","inside","should","true","first","fear","mean","better","play","another","gone","change","use","wonder","someone","hair","cold","open","best","any","behind","happen","water","dark","laugh","stay","forever","name","work","show","sky","break","came","deep","door","put","black","together","upon","happy","such","great","white","matter","fill","past","please","burn","cause","enough","touch","moment","soon","voice","scream","anything","stare","sound","red","everyone","hide","kiss","truth","death","beautiful","mine","blood","broken","very","pass","next","forget","tree","wrong","air","mother","understand","lip","hit","wall","memory","sleep","free","high","realize","school","might","skin","sweet","perfect","blue","kill","breath","dance","against","fly","between","grow","strong","under","listen","bring","sometimes","speak","pull","person","become","family","begin","ground","real","small","father","sure","feet","rest","young","finally","land","across","today","different","guy","line","fire","reason","reach","second","slowly","write","eat","smell","mouth","step","learn","three","floor","promise","breathe","darkness","push","earth","guess","save","song","above","along","both","color","house","almost","sorry","anymore","brother","okay","dear","game","fade","already","apart","warm","beauty","heard","notice","question","shine","began","piece","whole","shadow","secret","street","within","finger","point","morning","whisper","child","moon","green","story","glass","kid","silence","since","soft","yourself","empty","shall","angel","answer","baby","bright","dad","path","worry","hour","drop","follow","power","war","half","flow","heaven","act","chance","fact","least","tired","children","near","quite","afraid","rise","sea","taste","window","cover","nice","trust","lot","sad","cool","force","peace","return","blind","easy","ready","roll","rose","drive","held","music","beneath","hang","mom","paint","emotion","quiet","clear","cloud","few","pretty","bird","outside","paper","picture","front","rock","simple","anyone","meant","reality","road","sense","waste","bit","leaf","thank","happiness","meet","men","smoke","truly","decide","self","age","book","form","alive","carry","escape","damn","instead","able","ice","minute","throw","catch","leg","ring","course","goodbye","lead","poem","sick","corner","desire","known","problem","remind","shoulder","suppose","toward","wave","drink","jump","woman","pretend","sister","week","human","joy","crack","grey","pray","surprise","dry","knee","less","search","bleed","caught","clean","embrace","future","king","son","sorrow","chest","hug","remain","sat","worth","blow","daddy","final","parent","tight","also","create","lonely","safe","cross","dress","evil","silent","bone","fate","perhaps","anger","class","scar","snow","tiny","tonight","continue","control","dog","edge","mirror","month","suddenly","comfort","given","loud","quickly","gaze","plan","rush","stone","town","battle","ignore","spirit","stood","stupid","yours","brown","build","dust","hey","kept","pay","phone","twist","although","ball","beyond","hidden","nose","taken","fail","float","pure","somehow","wash","wrap","angry","cheek","creature","forgotten","heat","rip","single","space","special","weak","whatever","yell","anyway","blame","job","choose","country","curse","drift","echo","figure","grew","laughter","neck","suffer","worse","yeah","disappear","foot","forward","knife","mess","somewhere","stomach","storm","beg","idea","lift","offer","breeze","field","five","often","simply","stuck","win","allow","confuse","enjoy","except","flower","seek","strength","calm","grin","gun","heavy","hill","large","ocean","shoe","sigh","straight","summer","tongue","accept","crazy","everyday","exist","grass","mistake","sent","shut","surround","table","ache","brain","destroy","heal","nature","shout","sign","stain","choice","doubt","glance","glow","mountain","queen","stranger","throat","tomorrow","city","either","fish","flame","rather","shape","spin","spread","ash","distance","finish","image","imagine","important","nobody","shatter","warmth","became","feed","flesh","funny","lust","shirt","trouble","yellow","attention","bare","bite","money","protect","amaze","appear","born","choke","completely","daughter","fresh","friendship","gentle","probably","six","deserve","expect","grab","middle","nightmare","river","thousand","weight","worst","wound","barely","bottle","cream","regret","relationship","stick","test","crush","endless","fault","itself","rule","spill","art","circle","join","kick","mask","master","passion","quick","raise","smooth","unless","wander","actually","broke","chair","deal","favorite","gift","note","number","sweat","box","chill","clothes","lady","mark","park","poor","sadness","tie","animal","belong","brush","consume","dawn","forest","innocent","pen","pride","stream","thick","clay","complete","count","draw","faith","press","silver","struggle","surface","taught","teach","wet","bless","chase","climb","enter","letter","melt","metal","movie","stretch","swing","vision","wife","beside","crash","forgot","guide","haunt","joke","knock","plant","pour","prove","reveal","steal","stuff","trip","wood","wrist","bother","bottom","crawl","crowd","fix","forgive","frown","grace","loose","lucky","party","release","surely","survive","teacher","gently","grip","speed","suicide","travel","treat","vein","written","cage","chain","conversation","date","enemy","however","interest","million","page","pink","proud","sway","themselves","winter","church","cruel","cup","demon","experience","freedom","pair","pop","purpose","respect","shoot","softly","state","strange","bar","birth","curl","dirt","excuse","lord","lovely","monster","order","pack","pants","pool","scene","seven","shame","slide","ugly","among","blade","blonde","closet","creek","deny","drug","eternity","gain","grade","handle","key","linger","pale","prepare","swallow","swim","tremble","wheel","won","cast","cigarette","claim","college","direction","dirty","gather","ghost","hundred","loss","lung","orange","present","swear","swirl","twice","wild","bitter","blanket","doctor","everywhere","flash","grown","knowledge","numb","pressure","radio","repeat","ruin","spend","unknown","buy","clock","devil","early","false","fantasy","pound","precious","refuse","sheet","teeth","welcome","add","ahead","block","bury","caress","content","depth","despite","distant","marry","purple","threw","whenever","bomb","dull","easily","grasp","hospital","innocence","normal","receive","reply","rhyme","shade","someday","sword","toe","visit","asleep","bought","center","consider","flat","hero","history","ink","insane","muscle","mystery","pocket","reflection","shove","silently","smart","soldier","spot","stress","train","type","view","whether","bus","energy","explain","holy","hunger","inch","magic","mix","noise","nowhere","prayer","presence","shock","snap","spider","study","thunder","trail","admit","agree","bag","bang","bound","butterfly","cute","exactly","explode","familiar","fold","further","pierce","reflect","scent","selfish","sharp","sink","spring","stumble","universe","weep","women","wonderful","action","ancient","attempt","avoid","birthday","branch","chocolate","core","depress","drunk","especially","focus","fruit","honest","match","palm","perfectly","pillow","pity","poison","roar","shift","slightly","thump","truck","tune","twenty","unable","wipe","wrote","coat","constant","dinner","drove","egg","eternal","flight","flood","frame","freak","gasp","glad","hollow","motion","peer","plastic","root","screen","season","sting","strike","team","unlike","victim","volume","warn","weird","attack","await","awake","built","charm","crave","despair","fought","grant","grief","horse","limit","message","ripple","sanity","scatter","serve","split","string","trick","annoy","blur","boat","brave","clearly","cling","connect","fist","forth","imagination","iron","jock","judge","lesson","milk","misery","nail","naked","ourselves","poet","possible","princess","sail","size","snake","society","stroke","torture","toss","trace","wise","bloom","bullet","cell","check","cost","darling","during","footstep","fragile","hallway","hardly","horizon","invisible","journey","midnight","mud","nod","pause","relax","shiver","sudden","value","youth","abuse","admire","blink","breast","bruise","constantly","couple","creep","curve","difference","dumb","emptiness","gotta","honor","plain","planet","recall","rub","ship","slam","soar","somebody","tightly","weather","adore","approach","bond","bread","burst","candle","coffee","cousin","crime","desert","flutter","frozen","grand","heel","hello","language","level","movement","pleasure","powerful","random","rhythm","settle","silly","slap","sort","spoken","steel","threaten","tumble","upset","aside","awkward","bee","blank","board","button","card","carefully","complain","crap","deeply","discover","drag","dread","effort","entire","fairy","giant","gotten","greet","illusion","jeans","leap","liquid","march","mend","nervous","nine","replace","rope","spine","stole","terror","accident","apple","balance","boom","childhood","collect","demand","depression","eventually","faint","glare","goal","group","honey","kitchen","laid","limb","machine","mere","mold","murder","nerve","painful","poetry","prince","rabbit","shelter","shore","shower","soothe","stair","steady","sunlight","tangle","tease","treasure","uncle","begun","bliss","canvas","cheer","claw","clutch","commit","crimson","crystal","delight","doll","existence","express","fog","football","gay","goose","guard","hatred","illuminate","mass","math","mourn","rich","rough","skip","stir","student","style","support","thorn","tough","yard","yearn","yesterday","advice","appreciate","autumn","bank","beam","bowl","capture","carve","collapse","confusion","creation","dove","feather","girlfriend","glory","government","harsh","hop","inner","loser","moonlight","neighbor","neither","peach","pig","praise","screw","shield","shimmer","sneak","stab","subject","throughout","thrown","tower","twirl","wow","army","arrive","bathroom","bump","cease","cookie","couch","courage","dim","guilt","howl","hum","husband","insult","led","lunch","mock","mostly","natural","nearly","needle","nerd","peaceful","perfection","pile","price","remove","roam","sanctuary","serious","shiny","shook","sob","stolen","tap","vain","void","warrior","wrinkle","affection","apologize","blossom","bounce","bridge","cheap","crumble","decision","descend","desperately","dig","dot","flip","frighten","heartbeat","huge","lazy","lick","odd","opinion","process","puzzle","quietly","retreat","score","sentence","separate","situation","skill","soak","square","stray","taint","task","tide","underneath","veil","whistle","anywhere","bedroom","bid","bloody","burden","careful","compare","concern","curtain","decay","defeat","describe","double","dreamer","driver","dwell","evening","flare","flicker","grandma","guitar","harm","horrible","hungry","indeed","lace","melody","monkey","nation","object","obviously","rainbow","salt","scratch","shown","shy","stage","stun","third","tickle","useless","weakness","worship","worthless","afternoon","beard","boyfriend","bubble","busy","certain","chin","concrete","desk","diamond","doom","drawn","due","felicity","freeze","frost","garden","glide","harmony","hopefully","hunt","jealous","lightning","mama","mercy","peel","physical","position","pulse","punch","quit","rant","respond","salty","sane","satisfy","savior","sheep","slept","social","sport","tuck","utter","valley","wolf","aim","alas","alter","arrow","awaken","beaten","belief","brand","ceiling","cheese","clue","confidence","connection","daily","disguise","eager","erase","essence","everytime","expression","fan","flag","flirt","foul","fur","giggle","glorious","ignorance","law","lifeless","measure","mighty","muse","north","opposite","paradise","patience","patient","pencil","petal","plate","ponder","possibly","practice","slice","spell","stock","strife","strip","suffocate","suit","tender","tool","trade","velvet","verse","waist","witch","aunt","bench","bold","cap","certainly","click","companion","creator","dart","delicate","determine","dish","dragon","drama","drum","dude","everybody","feast","forehead","former","fright","fully","gas","hook","hurl","invite","juice","manage","moral","possess","raw","rebel","royal","scale","scary","several","slight","stubborn","swell","talent","tea","terrible","thread","torment","trickle","usually","vast","violence","weave","acid","agony","ashamed","awe","belly","blend","blush","character","cheat","common","company","coward","creak","danger","deadly","defense","define","depend","desperate","destination","dew","duck","dusty","embarrass","engine","example","explore","foe","freely","frustrate","generation","glove","guilty","health","hurry","idiot","impossible","inhale","jaw","kingdom","mention","mist","moan","mumble","mutter","observe","ode","pathetic","pattern","pie","prefer","puff","rape","rare","revenge","rude","scrape","spiral","squeeze","strain","sunset","suspend","sympathy","thigh","throne","total","unseen","weapon","weary"],S={MD5:function(e){return t(e)},SHA1:function(t){return e.SHA1.hex(t)},SHA256:function(t){return e.SHA256.hex(t)},random:function(t){var n=new Uint8Array(t);return e.getRandomValues(n),e.bytes_to_hex(n)},createKeyAndIV:function(t,n){var r,i,a=t+c(n),s="",o="",u=[],d=1,h=3,f=0;u[f++]=a;for(var p=0;p<h;p++){0==p?o=a:(s=c(o),s+=a,o=s);for(var m=0;m<d;m++)o=l(o);u[f++]=o}return r=e.hex_to_bytes(u[1]+u[2]),i=e.hex_to_bytes(u[3]),{key:r,iv:i,salt:n}},aes_encrypt:function(t,n){var r=t.key,i=t.iv,a=16,o=n;try{var c=e.string_to_bytes(s(n)),l=a-(c.length+1)%a,u=new Uint8Array(c.length+l+1);u.set(c);var d=0;u[c.length+d++]=10;for(var h=0;h<l;h++)u[c.length+d++]=l;return e.bytes_to_base64(e.AES_CBC.encrypt(u,r,null,i))}catch(e){return o}},aes_decrypt:function(t,n){var r=t.key,i=t.iv,a=n;try{var s=e.AES_CBC.decrypt(atob(n),r,null,i),c=s.length;s=s.slice(0,c-s[c-1]-1);var l=e.bytes_to_string(s);return o(l)}catch(e){return a}}},N={};return{md5:l,sha256:u,sha1:d,salt:_,createKeyAndIV:h,encrypt:f,decrypt:p,encryptKey:m,decryptKey:g,verifyKey:y,encryptObject:b,decryptObject:v,randomString:w,generateKey:k,encode_mnemonic:r,decode_mnemonic:a,getServerPassword:A}}),ABINE_DNTME.define("abine/perf",[],function(){var e=null,t=function(e){return};return t.stop=function(t){e&&e.stop(t)},t.increment=function(t){e&&e.increment(t)},t}),ABINE_DNTME.define("abine/dntmeInit",["documentcloud/underscore","abine/dnt/api","abine/localStorage","abine/toolbar","storage","abine/timer","persistence","abine/dntmeUpgrade","abine/badgeManager","modules","abine/securityManager","abine/cobranding"],function(e,t,n,r,i,a,s,o,c,l,u,d){function h(){ABINE_DNTME.dnt_api.updateRules(d.get("rules.update.url"),function(e,t){i.Preference.findBy("key","lastRulesCheck",function(e){e||(e=new i.Preference({key:"lastRulesCheck"}),s.add(e)),e.value=Math.floor(O().valueOf()),s.flush()}),"updated"==e?n.setItem("dnt-rules",t):f()})}function f(e){if(e)var t=6e4;else var t=18e5+36e5*Math.random();w&&a.clearTimeout(w),w=a.setTimeout(p,t)}function p(){i.Preference.findBy("key","lastRulesCheck",function(e){if(e&&e.value){var t=new Date(parseInt(e.value));t.valueOf()<(new Date).getTime()-E?h():f()}else h()})}function m(e,t,r){if(e){if("trackerMap"in e){t||(t={}),"trackerSettings"in t||(t.trackerSettings={});for(var a in e.trackerMap){a in t.trackerSettings||(t.trackerSettings[a]={});for(var o in e.trackerMap[a])t.trackerSettings[a][o]!=e.trackerMap[a][o]&&(t.trackerSettings[a][o]=!!e.trackerMap[a][o])}}if("settings"in e){if("dntp.showmedals"in e.settings&&i.Preference.createOrModify({key:"showMedals",value:e.settings["dntp.showmedals"]?"true":"false"}),"dntp.useglobalallow"in e.settings&&(t.useSuggestions=e.settings["dntp.useglobalallow"]),"defaultBlocked"in e.settings&&(t.defaultBlocked=e.settings.defaultBlocked),"origin"in e.settings&&e.settings.origin&&""!=e.settings.origin&&(i.Preference.createOrModify({key:"dynamicTag",value:e.settings.origin}),ABINE_DNTME.config.tags.unshift(e.settings.origin)),"install.date"in e.settings&&i.Preference.createOrModify({key:"installDate",value:e.settings["install.date"]}),"original.version"in e.settings&&i.Preference.createOrModify({key:"installVersion",value:e.settings["original.version"]}),"disabled.sites"in e.settings&&e.settings["disabled.sites"]){var c=JSON.parse(e.settings["disabled.sites"]);"disabledSites"in t||(t.disabledSites={});for(var l in c)l in t.trackerSettings&&delete t.trackerSettings[l],l in t.disabledSites||(t.disabledSites[l]=1,i.Blacklist.findBy("domain",l,function(e){e||(e=new i.Blacklist({domain:l}),s.add(e)),e.tracker=!0}))}if("blocked.sites"in e.settings&&e.settings["blocked.sites"]){var u=JSON.parse(e.settings["blocked.sites"]);"blockedSites"in t||(t.blockedSites={});for(var l in u)l in t.trackerSettings&&delete t.trackerSettings[l],l in t.blockedSites||(t.blockedSites[l]=1,i.Blacklist.findBy("domain",l,function(e){e&&(e.tracker=!1)}))}}"totals"in e&&(e.totals.total&&(T=e.totals.total),e.totals.facebook&&(S+=e.totals.facebook),e.totals.twitter&&(S+=e.totals.twitter),e.totals.google&&(S+=e.totals.google),e.totals.linkedin&&(S+=e.totals.linkedin)),"dailyTotals"in e&&(N=e.dailyTotals),"badTrackers"in e&&(C=e.badTrackers),D=!0,v(),n.setItem("dnt-settings",JSON.stringify(t)),s.flush()}r(t)}function g(e,t,n,r,i,a,s){if(r&&n&&N){var o=new Date,c=b(o)+"",l=o.getFullYear();T++,x++,t in A&&S++;var u={};if(l in N?(u=N[l],c in u?u[c]=u[c]+1:u[c]=T):(u[c]=T,N[l]=u),s){"totals"in C||(C.totals={}),t in C.totals?C.totals[t]++:C.totals[t]=1,"daily"in C||(C.daily={});var d=t+"."+l;d in C.daily||(C.daily[d]={}),c in C.daily[d]?C.daily[d][c]++:C.daily[d][c]=1}P(),D=!0,B()}}function y(e,t,n,a,o,c,u){var d={tabId:e,disabled:t,total:n,blocked:a,suggested:o,host:c,reloadRequired:u};k.send("background:dntme:tracker-count-changed",d,e),i.Preference.findBy("key","showMedals",function(e){i.DntStats.index(null,function(t){if(!e||"true"==e.value){var n;t&&t.length&&(n=t[0]),n.hasOwnProperty("viewedBadge")&&!n.viewedBadge&&(d.isBadge=!0,d.iconPath=I.icon,n.earnedOn||(n.earnedOn=Date.now(),s.flush()))}d.isBadge?r.updateIcon(d):l.panelsModule.getToolbarPanel(d,function(e){r.updateIcon(e)})})})}function b(e){e=e||new Date;var t=new Date(e.getFullYear(),0,0);return Math.floor((e-t)/864e5)}function v(){D&&(D=!1,i.DntStats.index(null,function(e){var e=e[0];e.totalAllTimeTrackers=T,e.totalAllTimeSocialTrackers=S,e.dailyTrackerCounts=JSON.stringify(N),e.badTrackers=JSON.stringify(C),e.currentBadge=JSON.stringify(I),e.currentBadgeIndex=M,s.flush()}))}function _(e){var r=n.getItem("dnt-settings"),a=n.getItem("dnt-rules");if(r)try{r=JSON.parse(r)}catch(e){ABINE_DNTME.log.error("Corrupted settings file")}if(a)try{a=JSON.parse(a)}catch(e){ABINE_DNTME.log.error("Corrupted rules file")}i.DntStats.index(null,function(e){var e,t=!1;!e||e&&!e.length?(e=new i.DntStats({totalAllTimeTrackers:0,totalAllTimeSocialTrackers:0,dailyTrackerCounts:"{}",badTrackers:"{}",viewedBadge:!0,currentBadge:"{}",currentBadgeIndex:-1}),s.add(e),t=!0):e=e[0],e.badTrackers&&""!=e.badTrackers||(e.badTrackers="{}",t=!0),S=e.totalAllTimeSocialTrackers||0,T=e.totalAllTimeTrackers,N=JSON.parse(e.dailyTrackerCounts),C=JSON.parse(e.badTrackers),I=JSON.parse(e.currentBadge),M=e.currentBadgeIndex,t&&s.flush()}),ABINE_DNTME.tracker_blocker_disabled||o.getOldData(function(i){function s(r){var i=new t(r,a);ABINE_DNTME.dnt_api=i,i.forceSaveStats=function(){v()},i.getAllTimeTotalTrackers=function(){return T},i.addListener("config-changed",function(e){n.setItem("dnt-settings",JSON.stringify(e))}),i.addListener("update-count",y),i.addListener("tracker-found",g),e.on("contentManager:init",function(e,t){i.triggerUpdateIcon(t),e.url.indexOf("dntmeTour=")==-1&&e.url.indexOf("dntmeFullTour=")==-1||ABINE_DNTME.require(["abine/tour"],function(e){e.show(t)})}),e.on("toolbar:clicked",function(t){var n=t.tabId;l.panelsModule.doToolbarPanelAction(n)||e.send("background:dntme:show",{tabId:n,page:"dashboard"},n),l.licenseModule.logAction({user_action:"clicked icon"})}),f(!0)}i&&"trackerMap"in i&&(ABINE_DNTME.dntme_upgrade=!0);try{m(i,r,s)}catch(e){ABINE_DNTME.log.error("*** error during upgrade from 2.0\n"+e+"\n"+e.stack),s(r)}})}"undefined"!=typeof ABINE_DNT&&(ABINE_DNT.browser=ABINE_DNTME.config.browser.toLowerCase());var w,k,E=864e5,A={"Facebook Connect":1,"Google +1":1,"Twitter Badge":1,LinkedIn:1},T=0,S=0,N=null,C=null,I=null,M=-1,D=!1,x=0,O=function(){var e=new Date;return e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e},P=e.debounce(function(){var e=c.compute(T);if(e.badgeIndex!=-1&&e.badgeIndex!=M){var t=e.badgeIndex-M;t>0&&(i.Preference.createOrIncrementByInteger({key:"cardsEarned",value:t},function(){}),u.hasPassword()&&l.licenseModule.incrementMedalsEarned(t,function(){})),M=e.badgeIndex,I=e.badge,i.DntStats.index(null,function(e){var e=e[0];e.viewedBadge=!1,e.earnedOn=Date.now(),e.currentBadge=JSON.stringify(I),e.currentBadgeIndex=M,s.flush()})}},3e3),B=e.debounce(v,5e3);return{initialize:function(e){k=e,ABINE_DNTME.dnt_api||_(k),u.on("background:securityManager:unlocked",function(){i.Preference.findBy("key","handledFirstAuth",function(e){e||i.Preference.createOrModify({key:"handledFirstAuth",value:!0},function(){i.Preference.findBy("key","cardsEarned",function(e){var t=!0;e&&(t=!1),l.licenseModule.incrementMedalsEarnedWithCurrentMedals(t,function(){})})})})})},getTotalBlockedInThisInstance:function(){return x},updateRules:h}}),ABINE_DNTME.define("abine/emailServer",["documentcloud/underscore","abine/ajax","abine/config","abine/server","abine/core"],function(e,t,n,r,i){var a=n.protocol+n.emailServerHost,s=a+"/api/v3/disposables",o=a+"/api/v4/disposables",c=a+"/api/v4/disposables/domains",l=a+"/api/v4/feedback",u=i.BaseClass.extend({initialize:function(e){this.options=this.options||e||{},this.server=this.options.server||new r.server},readDisposables:function(e,t){this.server.makeRequest({server:"email",action:"readDisposables",defaults:{},required:[],success:function(e){t.call(this,null,e)},error:function(e,n,r){t.call(this,{status:e,errorCode:n,responseJSON:r})},data:e,url:s,type:"GET"})},generateDisposable:function(e,t){this.server.makeRequest({server:"email",action:"generateDisposable",defaults:{domain:n.disposableDomain},required:["domain","label"],success:function(e){t.call(this,null,e)},error:function(e,n,r){t.call(this,{status:e,errorCode:n,responseJSON:r})},data:e,url:o,type:"POST"})},getDomains:function(e){this.server.makeRequest({server:"email",action:"readEmailDomains",defaults:{},required:[],success:function(t){e.call(this,null,t)},error:function(t,n,r){e.call(this,{status:t,errorCode:n,responseJSON:r})},url:c,type:"GET"})},sendDomainFeedback:function(e,t){this.server.makeRequest({server:"email",action:"sendDomainFeedback",defaults:{},required:[],success:function(e){t.call(this,null,e)},error:function(e,n,r){t.call(this,{status:e,errorCode:n,responseJSON:r})},data:e,url:l,type:"POST"})}});return u}),ABINE_DNTME.define("abine/eventLogger",["abine/config"],function(e){function t(){function e(e,t){return t=Array.prototype.slice.call(t),t.unshift(ABINE_DNTME.context+" ["+e+"]["+new Date+"]:"),t}function t(e){try{Console(e)}catch(e){}}return"undefined"==typeof console||"undefined"==typeof console.debug||ABINE_DNTME.IE_BG?{finest:function(e){t(ABINE_DNTME.context+" [FINEST]["+new Date+"]: "+e)},debug:function(e){t(ABINE_DNTME.context+" [DEBUG]["+new Date+"]: "+e)},info:function(e){t(ABINE_DNTME.context+" [INFO]["+new Date+"]: "+e)},warn:function(e){t(ABINE_DNTME.context+" [WARNING]["+new Date+"]: "+e)},error:function(e){t(ABINE_DNTME.context+" [ERROR]["+new Date+"]: "+e)}}:"undefined"!=typeof console?{finest:function(){console.debug.apply(console,e("FINEST",arguments))},debug:function(){console.debug.apply(console,e("DEBUG",arguments))},info:function(){console.info.apply(console,e("INFO",arguments))},warn:function(){console.warn.apply(console,e("WARN",arguments))},error:function(){console.error.apply(console,e("ERROR",arguments))}}:void 0}var n=function(){},r=t();switch(r.dumpObj=function(e){var t=typeof e;if("object"!=t||null===e)return"string"==t&&(e='"'+e+'"'),String(e);var n,i,a=[],s=e&&e.constructor==Array;for(n in e)i=e[n],t=typeof i,"string"==t?i='"'+i+'"':"object"==t&&null!==i&&(i=r.dumpObj(i)),a.push((s?"":'"'+n+'":')+String(i));return(s?"[":"{")+String(a)+(s?"]":"}")},e.logLevel){case"NONE":r.error=n;case"ERROR":r.warn=n;case"WARN":r.info=n;case"INFO":r.debug=n;case"DEBUG":r.finest=n}return r.stackTrace=function(e){e=e||"";try{does.not=exist}catch(n){var t=(n.stack+"").split("\n");t.length>3&&(t.shift(),t.shift(),t.shift()),e+="\n"+t.join("\n")}this.debug(e)},ABINE_DNTME.log=ABINE_DNTME.log||r,r}),ABINE_DNTME.define("abine/formSubmitDetector",["documentcloud/underscore","abine/core","abine/eventLogger"],function(e,t,n){var r=t.BaseClass.extend({init:function(e){var t=this;e.on("contentManager:formSubmit",function(e,n){t.trigger("background:formSubmit",{formData:e,tabId:n})}),e.on("contentManager:formFieldChanged",function(e,n){t.trigger("background:formFieldChanged",{formData:e.formData,fieldData:e.fieldData,tabId:n})}),e.on("contentManager:formFieldChanged:processMapping",function(e,n){t.trigger("background:formFieldChanged:processMapping",{formData:e.formData,fieldData:e.fieldData,checkoutButtons:e.checkoutButtons,tabId:n})}),e.on("contentManager:formPaymentFieldChanged",function(e,n){t.trigger("background:formPaymentFieldChanged",{formData:e.formData,fieldData:e.fieldData,tabId:n})}),e.on("panel:fill",function(e,n){t.trigger("background:formFieldChanged",{formData:e.formData,fieldData:e.fieldData,tabId:n}),e.formData.number&&t.trigger("background:formPaymentFieldChanged",{formData:e.formData,fieldData:e.fieldData,tabId:n})})}});return{formSubmitDetector:new r}}),ABINE_DNTME.define("abine/licenseServer",["documentcloud/underscore","abine/ajax","abine/config","abine/server","abine/core","abine/responseCodes"],function(e,t,n,r,i){var a=n.protocol+n.licenseServerHost,s=a+"/api/v2/users",o=a+"/api/v2/sessions",c=a+"/api/v2/touches",l=a+"/api/v2/billing_info",u=a+"/api/v2/feedback_email",d=a+"/api/v2/panel_data",h=a+"/api/v3/signatures",f=a+"/api/v3/subscriptions",p=a+"/api/v3/stripe_subscriptions",m=a+"/api/v3/medals",g=a+"/api/v2/log_action",y=a+"/api/v2/log_split_data",b=a+"/api/v2/log_password_fill_data",v=a+"/api/v3/checkout",_=a+"/api/v3/push/sync",w=a+"/api/v3/company/accounts",k=a+"/api/v3/syncstore",E=a+"/api/v2/devices",A=a+"/api/v3/mfa/request",T=a+"/api/v3/mfa/token",S=a+"/api/v3/mfa/generic_key",N=i.BaseClass.extend({initialize:function(e){this.options=this.options||e||{},this.server=this.options.server||new r.server},logAction:function(e,t){this.server.makeRequest({server:"license",action:"logAction",defaults:{},required:["user_action"],success:function(e){t.call(this,null,e)},error:function(e,n,r){t.call(this,{status:e,errorCode:n,responseJSON:r})},data:e,url:g,type:"POST"})},logSplitData:function(e,t){this.server.makeRequest({server:"license",action:"logSplitData",defaults:{},required:["bucket_id"],success:function(e){t.call(this,null,e)},error:function(e,n,r){t.call(this,{status:e,errorCode:n,responseJSON:r})},data:e,url:y,type:"POST"})},logPasswordFillData:function(e,t){this.server.makeRequest({server:"license",action:"logPasswordFillData",defaults:{},required:["choice","domain"],success:function(e){t.call(this,null,e)},error:function(e,n,r){t.call(this,{status:e,errorCode:n,responseJSON:r})},data:e,url:b,type:"POST"})},sendPanelActivity:function(e,t){this.server.makeRequest({server:"license",action:"sendPanelActivity",defaults:{},required:["panel_data"],success:function(e){t.call(this,null,e)},error:function(e,n,r){t.call(this,{status:e,errorCode:n,responseJSON:r})},data:e,url:d,type:"POST"})},login:function(e,t){this.server.makeRequest({server:"license",action:"login",defaults:{},required:["user_login","application"],success:function(e){t.call(this,null,e)},error:function(e,n,r){t.call(this,{status:e,errorCode:n,responseJSON:r})},data:e,url:o,type:"POST"})},logout:function(e,t){this.server.makeRequest({server:"license",action:"logout",defaults:{},required:["auth_token"],success:function(e){t.call(this,null,e)},error:function(e,n,r){t.call(this,{status:e,errorCode:n,responseJSON:r})},data:e,url:o+"/"+e.auth_token,type:"DELETE"})},register:function(e,t){this.server.makeRequest({server:"license",action:"register",defaults:{},required:["user","application"],success:function(e){t.call(this,null,e)},error:function(e,n,r){t.call(this,{status:e,errorCode:n,responseJSON:r})},data:e,url:s,type:"POST"})},passwordCardAuth:function(e,t){this.server.makeRequest({server:"license",action:"passwordCardAuth",defaults:{},success:function(e){t.call(this,null,e)},error:function(e,n,r){t.call(this,{status:e,errorCode:n,responseJSON:r})},data:e,url:T,type:"GET"})},getGenericBiometricKey:function(e,t){this.server.makeRequest({server:"license",action:"getGenericBiometricKey",defaults:{},success:function(e){t.call(this,null,e)},error:function(e,n,r){t.call(this,{status:e,errorCode:n,responseJSON:r})},data:e,url:S,type:"GET"})},createBiometricAuthRequest:function(e,t){this.server.makeRequest({server:"license",action:"createBiometricAuthRequest",defaults:{},success:function(e){t.call(this,null,e)},error:function(e,n,r){t.call(this,{status:e,errorCode:n,responseJSON:r})},data:e,url:A,type:"POST"})},getBiometricAuthResponse:function(e,t){this.server.makeRequest({server:"license",action:"getBiometricAuthResponse",defaults:{},success:function(e){t.call(this,null,e)},error:function(e,n,r){t.call(this,{status:e,errorCode:n,responseJSON:r})},data:e,url:A,type:"GET"})},signature:function(e,t){this.server.makeRequest({
server:"license",action:"signature",defaults:{},required:[],success:function(e){t.call(this,null,e)},error:function(e,n,r){t.call(this,{status:e,errorCode:n,responseJSON:r})},data:e,url:h,type:"GET"})},subscribed:function(e,t){this.server.makeRequest({server:"license",action:"subscribed",defaults:{},required:["recurly_token"],success:function(e){t.call(this,null,e)},error:function(e,n,r){t.call(this,{status:e,errorCode:n,responseJSON:r})},data:e,url:f,type:"POST"})},stripe_subscribe:function(e,t){this.server.makeRequest({server:"license",action:"stripe_subscribed",defaults:{},required:[],success:function(e){t.call(this,null,e)},error:function(e,n,r){t.call(this,{status:e,errorCode:n,responseJSON:r})},data:e,url:p,type:"POST"})},refreshEntitlements:function(e,t){this.server.makeRequest({server:"license",action:"refreshEntitlements",defaults:{},required:[],success:function(e){t.call(this,null,e)},error:function(e,n,r){t.call(this,{status:e,errorCode:n,responseJSON:r})},data:e,url:s,type:"GET"})},makeDailyTouch:function(e,t){this.server.makeRequest({server:"license",action:"makeDailyTouch",defaults:{},required:[],success:function(e){t.call(this,null,e)},error:function(e,n,r){t.call(this,{status:e,errorCode:n,responseJSON:r})},data:e,url:c,type:"POST"})},pushSync:function(e){this.server.makeRequest({server:"license",action:"sync",defaults:{},required:[],success:function(){},error:function(){},data:e,url:_,type:"POST"})},sendFeedbackEmail:function(e,t){this.server.makeRequest({server:"license",action:"sendFeedbackEmail",defaults:{},required:[],success:function(e){t.call(this,null,e)},error:function(e,n,r){t.call(this,{status:e,errorCode:n,responseJSON:r})},data:e,url:u,type:"POST"})},billingInfo:function(e,t){this.server.makeRequest({server:"license",action:"billingInfo",defaults:{},required:[],success:function(e){t.call(this,null,e)},error:function(e,n,r){t.call(this,{status:e,errorCode:n,responseJSON:r})},data:e,url:l,type:"GET"})},retrieveMedalsEarned:function(e,t){this.server.makeRequest({server:"license",action:"retrieveMedalsEarned",defaults:{},required:[],success:function(e){t.call(this,null,e)},error:function(e,n,r){t.call(this,{status:e,errorCode:n,responseJSON:r})},data:e,url:m,type:"GET"})},incrementMedalsEarned:function(e,t){this.server.makeRequest({server:"license",action:"incrementMedalsEarned",defaults:{},required:[],success:function(e){t.call(this,null,e)},error:function(e,n,r){t.call(this,{status:e,errorCode:n,responseJSON:r})},data:e,url:m,type:"PUT"})},logCheckout:function(e,t){this.server.makeRequest({server:"license",action:"logCheckout",skip_auth_token:!0,defaults:{},required:[],success:function(e){t.call(this,null,e)},error:function(e,n,r){t.call(this,{status:e,errorCode:n,responseJSON:r})},data:e,url:v+"/"+e.method,type:"PUT"})},retrieveSyncstoreToken:function(e,t){this.server.makeRequest({server:"license",action:"retrieveSyncstoreToken",defaults:{},required:[],success:function(e){t.call(this,null,e)},error:function(e,n,r){t.call(this,{status:e,errorCode:n,responseJSON:r})},data:e,url:k,type:"GET"})},retrieveDevices:function(e,t){this.server.makeRequest({server:"license",action:"retrieveDevices",defaults:{},required:[],success:function(e){t.call(this,null,e)},error:function(e,n,r){t.call(this,{status:e,errorCode:n,responseJSON:r})},data:e,url:E,type:"GET"})},getCompanyAccounts:function(e,t){this.server.makeRequest({server:"license",action:"getCompanyAccounts",defaults:{},required:[],success:function(e){t.call(this,null,e)},error:function(e,n,r){t.call(this,{status:e,errorCode:n,responseJSON:r})},data:e,url:w,type:"GET"})}});return N}),ABINE_DNTME.define("abine/lruCache",[],function(){var e=function(e){var t={},n=0,r=null,i=null;this.add=function(a,s){var o={id:a,data:s,previous:null,next:r};if(t[a]=o,r&&(r.previous=o),r=o,n===e){var c=i;i=i.previous,i.next=null,delete t[c.id],delete c}else 0===n&&(i=o),n++},this.size=function(){return n},this.fetch=function(e){var a=t[e];if(a){if(n>1){var s=a.previous,o=a.next;i==a?i=s:r!=a&&(s.next=o,o.previous=s),a.previous=null,a.next=r,r.previous=a,r=a}return a.data}return null},this.migrate=function(e,n){for(var r in t)r.indexOf(e)!=-1&&(n=r.replace(e,n),console.log("******** migrating ",r,n),t[n]=t[r],t[n].id=n,delete t[r])}};return e}),ABINE_DNTME.define("abine/mappingServer",["documentcloud/underscore","abine/ajax","abine/config","abine/server","abine/core"],function(e,t,n,r,i){var a=n.protocol+n.mappingServerHost,s=a+"/api/v2/dntmappings",o=a+"/api/v2/mappings/manifest",c="https://rules.abine.com/mappings/"+("production"==ABINE_DNTME.config.environment?"production":"test")+"/dntme/"+ABINE_DNTME.config.browser.toLowerCase()+"/mappings.json",l="https://rules.abine.com/mappings/"+("production"==ABINE_DNTME.config.environment?"production":"test")+"/version.txt",u=a+"/api/v3/field_data",d=a+"/api/v3/tracker_data",h=a+"/api/v3/page_data",f=a+"/api/v2/mappers",p=a+"/api/v2/mappings",m=a+"/api/v2/formblob",g=a+"/api/v2/autofill_feedback",y=a+"/api/v2/panels",b=a+"/api/v3/tracker_allow",v=function(){},_=i.BaseClass.extend({initialize:function(e){this.options=this.options||e||{},this.server=this.options.server||new r.server},sendPanelActivity:function(e,t){t=t||v,this.server.makeRequest({server:"mapping",action:"getMappingManifest",defaults:{},required:[],success:function(e){t.call(this,null,e)},error:function(e,n,r){t.call(this,{status:e,errorCode:n,responseJSON:r})},data:e,url:o,type:"POST"})},pushMapping:function(e,t){this.server.makeRequest({server:"mapping",action:"pushMapping",defaults:{},required:[],success:function(e){t.call(this,null,e)},error:function(e,n,r){t.call(this,{status:e,errorCode:n,responseJSON:r})},data:e,url:s,type:"POST"})},getMappingVersion:function(e){this.server.makeRequest({server:"mapping",action:"getMappingVersion",defaults:{},required:[],success:function(t){e.call(this,null,t)},error:function(t,n,r){e.call(this,{status:t,errorCode:n,responseJSON:r})},url:l,raw:!0,skip_auth_token:!0,skip_ca:!0,type:"GET"})},getMappings:function(e){this.server.makeRequest({server:"mapping",action:"getMappingManifest",defaults:{},required:[],success:function(t){e.call(this,null,t)},error:function(t,n,r){e.call(this,{status:t,errorCode:n,responseJSON:r})},url:c,raw:!0,skip_auth_token:!0,skip_ca:!0,type:"GET"})},getFormMappings:function(e,t){this.server.makeRequest({server:"mapping",action:"getFormMappings",defaults:{},required:["signatures"],success:function(e){t.call(this,null,e)},error:function(e,n,r){t.call(this,{status:e,errorCode:n,responseJSON:r})},data:e,url:c,type:"POST"})},getMapperDetails:function(e,t){this.server.makeRequest({server:"mapping",action:"getMapperDetails",defaults:{},required:[],success:function(e){t.call(this,null,e)},error:function(e,n,r){t.call(this,{status:e,errorCode:n,responseJSON:r})},data:e,url:f,type:"GET"})},getOneFormMappings:function(e,t){this.server.makeRequest({server:"mapping",action:"getFormMappings",defaults:{},required:["id"],success:function(e){t.call(this,null,e)},error:function(e,n,r){t.call(this,{status:e,errorCode:n,responseJSON:r})},data:e,url:p+"/"+e.id,type:"GET"})},sendAutofillFeedback:function(e,t){this.server.makeRequest({server:"mapping",action:"sendAutofillFeedback",defaults:{},required:[],success:function(e){t.call(this,null,e)},error:function(e,n,r){t.call(this,{status:e,errorCode:n,responseJSON:r})},data:e,url:g,type:"POST"})},sendFormBlob:function(e,t){this.server.makeRequest({server:"mapping",action:"sendFormBlob",defaults:{},required:["form_id","html"],success:function(e){t.call(this,null,e)},error:function(e,n,r){t.call(this,{status:e,errorCode:n,responseJSON:r})},data:e,url:m,type:"POST"})},getPanels:function(e,t){this.server.makeRequest({server:"mapping",action:"getPanels",defaults:{},required:["browser","tag","user_state"],success:function(e){t.call(this,null,e)},error:function(e,n,r){t.call(this,{status:e,errorCode:n,responseJSON:r})},data:e,url:y,type:"GET"})},saveTrackerData:function(e,t){t=t||v,this.server.makeRequest({server:"mapping",action:"saveTrackerData",skip_auth_token:!0,defaults:{},required:[],success:function(e){t.call(this,null,e)},error:function(e,n,r){t.call(this,{status:e,errorCode:n,responseJSON:r})},data:e,url:d,type:"POST"})},savePageData:function(e,t){t=t||v,this.server.makeRequest({server:"mapping",action:"savePageData",skip_auth_token:!0,defaults:{},required:[],success:function(e){t.call(this,null,e)},error:function(e,n,r){t.call(this,{status:e,errorCode:n,responseJSON:r})},data:e,url:h,type:"POST"})},sendTrackerAllow:function(e,t){t=t||v,this.server.makeRequest({server:"mapping",action:"sendTrackerAllow",skip_auth_token:!0,defaults:{},required:[],success:function(e){t.call(this,null,e)},error:function(e,n,r){t.call(this,{status:e,errorCode:n,responseJSON:r})},data:e,url:b,type:"POST"})},saveFieldData:function(e,t){t=t||v,this.server.makeRequest({server:"mapping",action:"saveFieldData",skip_auth_token:!0,defaults:{},required:[],success:function(e){t.call(this,null,e)},error:function(e,n,r){t.call(this,{status:e,errorCode:n,responseJSON:r})},data:e,url:u,type:"POST"})}});return _}),ABINE_DNTME.define("abine/memoryStore",["documentcloud/underscore","abine/core","abine/lruCache"],function(e,t,n){var r=new n(1e3);return{set:function(e,t){r.add(e,t)},get:function(e,t){t(r.fetch(e))},migrate:function(e,t){r.migrate("."+e+".","."+t+".")}}}),ABINE_DNTME.define("abine/pageEvents",["documentcloud/underscore","abine/core","abine/securityManager","abine/config","storage","abine/timer","persistence","modules","abine/window","abine/dntmeUpgrade","abine/url","abine/localStorage","abine/webapp"],function(e,t,n,r,i,a,s,o,c,l,u,d,h){function f(e){return e||(e=""),e=e.replace(/&lt;|&gt;|[\s\<\>]+/g,"")}var p=null,m=null;try{"undefined"!=typeof window&&(m=[],window.onerror=function(e,t,n,r,i){i=i?i.stack:"",m.push([e,t,n,r,i]),m.length>20&&m.shift()})}catch(e){}var g=function(){};p="development"==r.environment?/.*/i:/^(.+\.)?abine\.com$/i;var y=t.BaseClass.extend({initialize:function(){},processAction:function(e,t){if(t=t||g,e.host.indexOf(ABINE_DNTME.config.licenseServerHost.replace(/:[0-9]+/,""))!=-1)switch(e.action){case"blurstore:setup:complete":this.refreshData(e.params,t),h.reload()}else if(e.host.indexOf(ABINE_DNTME.config.mappingServerHost.replace(/:[0-9]+/,""))!=-1)switch(e.action){case"get:mapping:review:mode":this.getReviewMode(t);break;case"start:mapping:review:mode":this.switchToReviewMode(!0,t);break;case"end:mapping:review:mode":this.switchToReviewMode(!1,t);break;case"set:mapper:mode":this.switchToMapperMode(e.params,t);break;case"exit:mapper:mode":this.clearMapperSettings(t);break;case"set:autofill:mode":this.switchToAutofillMode(e.params,t);break;case"updateFormRules":d.setItem("form-rules",e.params),o.mappingsModule.setFormRules(JSON.parse(e.params)),t();break;case"getVersion":t({version:ABINE_DNTME.config.version,tag:ABINE_DNTME.config.tags[0]})}else if(e.host.indexOf(ABINE_DNTME.config.webAppHost.replace(/:[0-9]+/,""))!=-1){if("importAccounts"==e.action&&(ABINE_DNTME.maskme_installed=!1),ABINE_DNTME.maskme_installed&&!e.action.match(/canAutoImport|exportFromMaskme/i))return void t();switch(e.action){case"refreshTag":this.refreshTag(t);break;case"setAuthToken":this.setAuthToken(e.params,t);break;case"retrieveAuthToken":e.secure?this.retrieveAuthToken(e.params,t):t(null);break;case"retrieveWebsocketId":this.retrieveWebsocketId(t);break;case"emitPushEvent":this.emitPushEvent(e.params),t();break;case"email:created":this.emailCreated(e.params,t);break;case"email:deleted":this.emailDeleted(e.params,t);break;case"refreshData":this.refreshData(e.params,t);break;case"retrieveDntStats":this.retrieveDntStats(e.params,t);break;case"retrieveDntData":this.retrieveDntData(e.params,t);break;case"retrieveInstallAuthToken":this.retrieveInstallAuthToken(e.params,t);break;case"reloadCompanyAccounts":this.reloadCompanyAccounts(e.params,t);break;case"migrationComplete":this.migrationComplete(e.params,t);break;case"dntNewFeaturePageVisited":this.newFeaturePageVisited(e.params,t);break;case"importAccounts":this.importAccounts(e.params,t);break;case"retrieveEntities":e.secure?this.retrieveEntities(e.params,t):t(null);break;case"updateEntity":e.secure?this.updateEntity(e.params,t):t(null);break;case"deleteEntity":e.secure?this.deleteEntity(e.params,t):t(null);break;case"resetEntity":e.secure?this.resetEntity(e.params,t):t(null);break;case"loginAccount":e.secure?this.loginAccount(e.params,t):t(null);break;case"getBrowserLoginCount":e.secure?this.getBrowserLoginCount(e.params,t):t(null);break;case"getBrowserLogins":e.secure?this.getBrowserLogins(e.params,t):t(null);break;case"userDeleted":e.secure?this.userDeleted(e.params,t):t(null);break;case"canAutoImport":t(ABINE_DNTME.maskme_installed&&ABINE_DNTME.maskme_can_export);break;case"exportFromMaskme":e.secure?l.exportFromMaskme(t):t(null);break;case"blurstore:setup:complete":this.refreshData(e.params,t),h.reload();break;case"disableBlurGrowl":this.disableBlurGrowl(e.params,t);break;case"checkBlurGrowl":this.checkBlurGrowl(e.params,t);break;case"abineStoreSync":this.abineStoreSync(e.params,t);break;case"webappActive":this.webappActive(e.params,t);break;case"languageChanged":this.changeLanguage(e.params,t);break;case"checkExtensionActivity":this.checkExtensionActivity(e.params,t);break;case"sendAutolockPref":this.sendAutolockPref(e.params,t);break;case"disconnectPushNotification":this.disconnectPushNotification(),t();break;case"getVersion":t({version:ABINE_DNTME.config.version,tag:ABINE_DNTME.config.tags[0]});break;case"getExtensionErrors":t(m);break;default:e.action&&0==e.action.indexOf("retrieveEntities")&&e.secure?this.retrieveEntities(e.params,t):t()}}else if(e.host.match(p)){switch(e.action){case"getVersion":t({version:ABINE_DNTME.config.version,tag:ABINE_DNTME.config.tags[0]});break;case"updateFormRules":d.setItem("form-rules",e.params),o.mappingsModule.setFormRules(JSON.parse(e.params)),t();break;case"updateRules":ABINE_DNTME.dnt_api.setupRules(e.params),t();break;case"getDailyTotals":this.getDailyTotalsByYear(e.params[0],t);break;case"getBadTrackerTotals":this.getBadTrackerTotals(t)}t()}else t()},refreshTag:function(e){i.Preference.findBy("key","userTag",function(t){e(t&&t.value&&!n.isLocked()?t.value:ABINE_DNTME.config.tags[0])})},setAuthToken:function(e,t){n.setAuthToken(e.auth_token,e.key,e.companyKey),t({})},retrieveAuthToken:function(e,t){var r=n.getAuthToken();t(r&&""!=r?{auth_token:r,key:n.getEncryptionKey()||"",companyKey:n.getCompanyEncryptionKey()||"",user_id:n.getUserId()}:null)},retrieveWebsocketId:function(e){ABINE_DNTME.require(["abine/pushNotifications"],function(t){e(t.getId())})},emitPushEvent:function(e){ABINE_DNTME.require(["abine/pushNotifications"],function(t){t.emit(e.event,e.payload)})},disableBlurGrowl:function(e,t){i.Preference.createOrModify({key:"showBlurGrowl",value:"false"},function(){t({})}),i.Preference.createOrModify({key:"showBlurPage",value:"false"},function(){t({})}),i.Preference.createOrModify({key:"blurGrowlTab",value:"false"},function(){t({})})},checkBlurGrowl:function(e,t){i.Preference.findBy("key","showBlurPage",function(e){t(!e||e.isFalse()?null:!0),i.Preference.createOrModify({key:"showBlurPage",value:"false"},function(){})})},checkExtensionActivity:function(e,t){return n.isLocked()?void t(null):void i.Preference.findBy("key","lastActivity",function(e){t(e&&e.value?{activeTime:e.value}:null)})},webappActive:function(e,t){i.Preference.createOrModify({key:"lastActivity",value:Date.now()},function(){}),t(null)},changeLanguage:function(e,t){"en-US"==e.lang&&(e.lang="en"),i.Preference.createOrModify({key:"dnt_language",value:e.lang},function(){t(null)})},sendAutolockPref:function(e,t){i.Preference.createOrModify({key:"autolock",value:e},function(){t({})})},abineStoreSync:function(e,t){ABINE_DNTME.require(["abine/blurstore-api"],function(t){t.synchronizeWhenOld(e)}),t(null)},importAccounts:function(t,r){var a=[];try{t.id&&t.key&&n.__setUserIdAndKey(t.id,t.key),i.Account.clearCache(function(){i.Account.index(null,function(o){var c={};e.each(o,function(e){c[e.id]=!0,a.push(e.toJSON())}),e.each(t.accounts,function(e){if(!(e.id in c)){e.domain=u.getTLD(e.domain);var t=new i.Account(e);s.add(t),a.push(t.toJSON())}}),i.Account.saveToLocalStorage(function(){t.id&&t.key&&n.__setUserIdAndKey(null,null),r(a)})})})}catch(e){}},retrieveEntities:function(t,r){var a=[];return i[t]?void n.afterRefresh(function(){try{return i[t].decryptionFailed?void r("decryption failed"):void i[t].index(null,function(t){e.each(t,function(e){a.push(e.toJSON())}),r(a)})}catch(e){r(a)}}):void r(a)},updateEntity:function(t,n){if(i[t.name]){var r=t.entity;if(r.id)return void i[t.name].findBy("id",r.id,function(a){a?e.extend(a,r):(a=new i[t.name](r),s.add(a)),s.flush(),n()})}n()},deleteEntity:function(e,t){if(i[e.name]){var n=e.id;i[e.name].findBy("id",n,function(e){e&&(s.remove(e),s.flush()),t()})}else t()},resetEntity:function(e,t){var n=i[e.name];n?n.clearCache(function(){e.user_id?d.removeItem(e.name+"."+e.user_id):d.removeItem(e.name),t()}):t()},emailCreated:function(e){var t=new i.DisposableEmail(e);t.createdAt=e.created_at,s.add(t)},emailDeleted:function(e){i.DisposableEmail.findBy("guid",e.guid,function(e){e&&(s.remove(e),s.flush())})},refreshData:function(){s.reset(),n.refreshData()},userDeleted:function(e,t){i.Preference.findBy("key","oldEmail",function(e){e&&(s.remove(e),i.Preference.createOrModify({key:"loginNotLock",value:"true"},function(){s.flush(),t&&t({})}))})},loginAccount:function(e,t){var r=e.id||e,a=e.login_url;i.Account.findBy("id",r,function(e){i.CompanyAccount.findBy("id",r,function(t){!e&&t&&(e=t),i.LoginUrl.loginUrlForSite({params:[e.domain]},function(t){t||(t=a),t&&(t=t.href),t||(t=e.login_url),!t&&e.page_host&&(t="http://"+e.page_host),!t&&e.domain&&(t="http://"+e.domain),t&&n.openPage(t)})})}),t()},getBrowserLoginCount:function(e,t){return"Firefox"==ABINE_DNTME.config.browser?void ABINE_DNTME.require(["abine/firefox_import"],function(e){t(e.getLoginCount())}):void t(-1)},getBrowserLogins:function(e,t){return"Firefox"==ABINE_DNTME.config.browser?void ABINE_DNTME.require(["abine/firefox_import"],function(e){t(e.getLogins())}):void t(null)},migrationComplete:function(){i.Preference.findBy("key","mergedMigrationPending",function(e){e&&(s.remove(e),s.flush())})},retrieveDntStats:function(e,t){ABINE_DNTME.dnt_api.forceSaveStats(),i.DntStats.index(null,function(e){t(e.length>0?e[0].toJSON():null)})},retrieveInstallAuthToken:function(e,t){i.Preference.findBy("key","installAuthToken",function(e){t(e&&""!=e.value?{installAuthToken:e.value}:null)})},reloadCompanyAccounts:function(e,t){i.CompanyAccount.clearCache(),i.CompanyAccount.fetchFromServer(),t(null)},getDailyTotalsByYear:function(e,t){i.DntStats.index(null,function(n){if(n.length>0){var r=n[0],i=JSON.parse(r.dailyTrackerCounts);if(e in i)return i[e].hasBadTrackers=!0,void t(i[e])}t({})})},getBadTrackerTotals:function(e){i.DntStats.index(null,function(t){if(t.length>0){var r=t[0],i=JSON.parse(r.badTrackers);if(!i.totals)return void e({});var a=(new Date).getFullYear(),s=i.totals,o={},c=[a,a-1];for(var l in s)for(var u=0;u<c.length;u++){var d=l+"."+c[u];i.daily&&d in i.daily&&(o[l]={},o[l][c[u]]=i.daily[d])}var h={};return void n.getLink({},function(t){for(var n in s)h[n]=t+"&type=badTracker."+n;e({totals:s,daily:o,links:h})})}e({})})},retrieveDntData:function(e,t){l.getMaskmeData(t)},disconnectPushNotification:function(){ABINE_DNTME.require(["abine/pushNotifications"],function(e){e.disconnect()})},newFeaturePageVisited:function(e,t){i.Preference.createOrModify({key:"new_feature_explored",value:(new Date).toString()},function(){t()})},getReviewMode:function(e){i.Preference.findBy("key","mapping:reviewer",function(t){e(t?{review:!0,email:t.value}:{review:!1})})},clearMapperSettings:function(e){i.Preference.batchRemoveBy([{by:"key",value:"mapping:reviewer"},{by:"key",value:"mapping:mapper"},{by:"key",value:"mapping:batch"},{by:"key",value:"mapping:form:id"},{by:"key",value:"autofill:mapper"},{by:"key",value:"autofill:batch"},{by:"key",value:"autofill:form:id"}],e)},switchToMapperMode:function(e,t){this.clearMapperSettings(function(){i.Preference.batchCreateOrModify([{key:"mapping:mapper",value:f(e.mapper)},{key:"mapping:batch",value:f(e.batch)},{key:"mapping:form:id",value:e.id}],function(){t(e.mapper)})})},switchToAutofillMode:function(t,n){this.clearMapperSettings(function(){i.Preference.batchCreateOrModify([{key:"autofill:mapper",value:f(t.mapper)},{key:"autofill:batch",value:f(t.batch)},{key:"autofill:form:id",value:t.id}],function(){o.mappingsModule.forceMappingUpdate(!0,e.bind(function(){n(t.mapper)},this))})})},switchToReviewMode:function(t,n){t?o.mappingsModule.getMapperDetails(e.bind(function(e){return e&&e.is_reviewer?void this.clearMapperSettings(function(){i.Preference.createOrModify({key:"mapping:reviewer",value:e.name},function(){n(e.name)})}):void n()},this)):this.clearMapperSettings(function(){n("")})}}),b=new y({});return b}),ABINE_DNTME.define("abine/paymentsServer",["documentcloud/underscore","abine/ajax","abine/config","abine/server","abine/core"],function(e,t,n,r,i){var a=n.protocol+n.paymentsServerHost,s=a+"/api/v3/cards",o=a+"/api/v3/cardcredit/client",c=a+"/api/v3/cardfee",l=a+"/api/v3/verify_card_request",u=i.BaseClass.extend({initialize:function(e){this.options=this.options||e||{},this.server=this.options.server||new r.server},getCards:function(e,t){this.server.makeRequest({server:"payment",action:"getCards",defaults:{},required:[],success:function(e){t.call(this,null,e)},error:function(e,n,r){t.call(this,{status:e,errorCode:n,responseJSON:r})},data:e,url:s,type:"GET"})},createCard:function(e,t){this.server.makeRequest({server:"payments",action:"createCard",defaults:{},required:["request_id","amount","domain","card_use"],success:function(e){t.call(this,null,e)},error:function(e,n,r){t.call(this,{status:e,errorCode:n,responseJSON:r})},data:e,url:s,type:"POST"})},getCard:function(e,t){this.server.makeRequest({server:"payments",action:"getCard",defaults:{},required:[],success:function(e){t.call(this,null,e)},error:function(e,n,r){t.call(this,{status:e,errorCode:n,responseJSON:r})},data:{},url:s+"/"+e,type:"GET"})},updateCard:function(e,t){this.server.makeRequest({server:"payments",action:"updateCard",defaults:{},required:[],success:function(e){t.call(this,null,e)},error:function(e,n,r){t.call(this,{status:e,errorCode:n,responseJSON:r})},data:e,url:s+"/"+e.card_id,type:"PUT"})},retrieveCardCredit:function(e,t){this.server.makeRequest({server:"payments",action:"retrieveCardCredit",defaults:{},required:[],success:function(e){t.call(this,null,e)},error:function(e,n,r){t.call(this,{status:e,errorCode:n,responseJSON:r})},data:e,url:o,type:"GET"})},retrieveCardFee:function(e,t){this.server.makeRequest({server:"payments",action:"retrieveCardFee",defaults:{},required:[],success:function(e){t.call(this,null,e)},error:function(e,n,r){t.call(this,{status:e,errorCode:n,responseJSON:r})},data:e,url:c,type:"GET"})},verifyCardRequest:function(e,t){this.server.makeRequest({server:"payments",action:"verifyCardRequest",defaults:{},required:[],success:function(e){t.call(this,null,e)},error:function(e,n,r){t.call(this,{status:e,errorCode:n,responseJSON:r})},data:e,url:l,type:"GET"})}});return u}),ABINE_DNTME.define("abine/phoneServer",["documentcloud/underscore","abine/ajax","abine/config","abine/server","abine/core"],function(e,t,n,r,i){var a=n.protocol+n.phoneServerHost,s=a+"/api/v3/shieldedphones",o=i.BaseClass.extend({initialize:function(e){this.options=this.options||e||{},this.server=this.options.server||new r.server},getPhone:function(e,t){this.server.makeRequest({server:"phone",action:"getPhone",defaults:{},required:[],success:function(e){t.call(this,null,e)},error:function(e,n,r){t.call(this,{status:e,errorCode:n,responseJSON:r})},data:e,url:s,type:"GET"})},logDisposableFilled:function(e,t){this.server.makeRequest({server:"phone",action:"restorePhone",defaults:{},required:["filled"],success:function(e){t.call(this,null,e)},error:function(e,n,r){t.call(this,{status:e,errorCode:n,responseJSON:r})},data:{filled:!0},url:s+"/"+e,type:"PUT"})},restorePhone:function(e,t){this.server.makeRequest({server:"phone",action:"restorePhone",defaults:{},required:["id"],success:function(e){t.call(this,null,e)},error:function(e,n,r){t.call(this,{status:e,errorCode:n,responseJSON:r})},data:e,url:s+"/"+e.id,type:"PUT"})}});return o}),ABINE_DNTME.define("abine/password",[],function(){function e(e,t){return"undefined"==typeof t&&(t=e,e=0),Math.floor(Math.random()*(t-e)+e)}function t(t,n,r){for(var i=1;i<=r;i++){var a=e(0,t.length);t=[t.slice(0,a),n[e(n.length)],t.slice(a)].join("")}return t}var n=12,r=1,i=2,a=4,s=8,o="0123456789",c="`~!@#$%^&*()_-+={}|[]\\:\";'<>?,/",l=".-_",u="ABCDEFGHJKLMNOPQRSTUVWXYZ",d=u.toLowerCase(),h={generateRandomPassword:function(h,f,p){h=h||d,(!f||f<1)&&(f=n);var m="";return p=p||r|i|a,p&r&&(m=t(m,u,e(2,3))),p&a&&(m=t(m,c,e(1,3))),p&s&&(m=t(m,l,1)),p&i&&(m=t(m,o,e(1,3))),m.length<f&&(m=t(m,h,f-m.length)),m},generateSpecialCharsPassword:function(){return this.generateRandomPassword(null,null,r|i|s)},generateNoSpecialCharsPassword:function(){return this.generateRandomPassword(null,null,r|i)},generateNoDigitsPassword:function(){return this.generateRandomPassword(null,null,r)},generateNewOptionsPassword:function(e,t,n){var s=r;return t&&(s|=i),n&&(s|=a),this.generateRandomPassword(null,e,s)}};return h}),ABINE_DNTME.define("abine/responseCodes",[],function(){return{UNKNOWN_ERROR:"unknown error",SUCCESS:"successful",ERROR:"error",SERVICE_UNAVAILABLE_ERROR:"service unavailable error",SCHEDULED_DOWNTIME:"scheduled downtime",MISSING_PARAMETERS:"missing parameters",UNAUTHORIZED:"unauthorized bad token",NO_ACCESS_FOR_FEATURE:"no access to requested feature",INVALID_PASSWORD:"invalid password",BIOMETRIC_AUTH_FAILED:"biometric auth failed",ACCOUNT_ALREADY_EXISTS:"account already exists for that email",SAVE_NEW_USER_ERROR:"error saving new user",FAILED_CREATING_TARGET_EMAIL:"failed to create target email",FAILED_TO_UPDATE_USER:"error updating user",NO_ACCOUNT_FOUND_FOR_EMAIL:"no account found for email",ACCOUNT_MARKED_FOR_DELETION:"account has been marked for deletion",ACCOUNT_HAS_BEEN_LOCKED:"account has been locked",ACCOUNT_HAS_BEEN_BANNED:"account has been banned",WRONG_PASSWORD:"wrong password",INVALID_EMAIL_ADDRESS:"invalid email address",NO_RECURLY_ACCOUNT_FOUND:"no recurly account found",MFA_CODE_REQUIRED:"mfa code required",DOWNGRADE_SCHEMA_NOT_ALLOWED:"downgrade of schema_version is not allowed",SAVE_CLIENT_DATA_ERROR:"errors saving client data",DESTROY_CLIENT_DATA_ERROR:"errors destroying client data",NO_CLIENT_DATA_FOUND:"no client data found",USER_EXISTS_FOR_CLIENT_DATA_DELETION:"cannot destroy client data when user exists",UPGRADE_REQUIRED:"upgrade required",PHONE_NOT_FOUND:"phone not found",NO_DISPOSABLE_PHONE:"no disposable phone",FAILED_TO_SAVE_PHONE:"failed to save phone",PHONE_ALREADY_VALIDATED:"phone already validated",NO_NUMBERS_AVAILABLE:"no numbers available",FAILED_TO_SEND_VERIFICATION_CODE:"failed to send verification code",WRONG_VERIFICATION_CODE:"wrong verification code",OLD_PHONE_NOT_FOUND:"old phone not found",COUNTRY_NOT_SUPPORTED:"country not supported",COUNTRY_CHANGE_NOT_SUPPORTED:"country change not supported",ERROR_CREATING_DISPOSABLE:"error creating disposable",MISSING_USER_PARAMS_ERROR_CODE:"missing user params",NO_BILLING_ACCOUNT_FOR_USER_ERROR_CODE:"no billing account for user",REQUEST_ALREADY_EXISTS_ERROR_CODE:"request already exists",NO_CARDS_AVAILABLE_ERROR_CODE:"no cards available",REQUESTED_AMOUNT_OVER_LIMIT_ERROR_CODE:"requested amount over limit",REQUESTED_AMOUNT_BELOW_MINIMUM_ERROR_CODE:"requested amount below minimum",REQUESTED_AMOUNT_INVALID_ERROR_CODE:"requested amount invalid",BILLING_FAILED_ERROR_CODE:"billing failed",BILLING_DECLINED_ERROR_CODE:"billing declined",BILLING_COMPANY_FAILED_ERROR_CODE:"billing company failed",NO_CARD_FOUND_ERROR_CODE:"no card found",NO_BILLING_TRANSACTION_FOUND_ERROR_CODE:"no billing transaction found",FRAUD_SOFT_LIMIT_REACHED:"fraud soft limit",REFUND_FAILED_ERROR_CODE:"refund failed",PROVIDER_CANCEL_FAILED_ERROR_CODE:"provider cancel failed",PROVIDER_READ_FAILED_ERROR_CODE:"provider read failed",PROVIDER_CARD_CREATION_FAILED_ERROR_CODE:"provider card creation failed",FRAUD_HARD_LIMIT_REACHED:"fraud hard limit reached",CARD_ALREADY_DEACTIVATED_ERROR_CODE:"card already deactivated",FRAUD_VERIFIED_SOFT_LIMIT_REACHED:"fraud verified soft limit",FRAUD_PLATFORM_UNAVAILABLE:"fraud verification unavailable",FRAUD_HIGH_RISK_COUNTRY_ERROR_CODE:"high risk country ban",BILLING_IN_NON_US_ERROR_CODE:"billing in non us",GREY_LISTED_ERROR_CODE:"grey listed user",GLOBAL_SOFT_LIMIT_REACHED:"global soft limit",DUPLICATE_CARD_ERROR_CODE:"duplicate card used ban",REJECTED_DOMAIN_ERROR_CODE:"domains known to not accept masked cards",BANNED_DOMAIN_ERROR_CODE:"banned domain",SPLIT_INTRUSIVE_NON_INTRUSIVE:"7",SPLIT_INTRUSIVE_CONTROL:"8",SPLIT_INTRUSIVE_ALWAYS_REG:"9",SPLIT_INTRUSIVE_GOT_IT_REG:"10",SPLIT_INTRUSIVE_COMPLETE_SETUP_BUTTON:"11",SPLIT_WALLET_OFF:"12",SPLIT_WALLET_ON:"13",SPLIT_ICON_PANELS_CLICK_ICON_FOR_PANEL:"32",SPLIT_ICON_PANELS_SHOW_ICON_WITH_NORMAL_PANELS:"33",SPLIT_ICON_PANELS_NORMAL:"34"}}),ABINE_DNTME.define("abine/saveForms",["documentcloud/underscore","abine/formSubmitDetector","abine/core","storage","persistence","abine/url","abine/securityManager","abine/timer","abine/feedbackLoop"],function(e,t,n,r,i,a,s,o){function c(t,n){if(t.formSignature==n.formSignature)return!0;var r=0,i=0;return e.each(t.fields,function(e,t){t in n.fields?r++:i++}),r>=2&&r>i||1==r&&r>=i}function l(e,t){if(v[t]){if(v[t].timesLoaded=v[t].timesLoaded?v[t].timesLoaded+1:1,v[t].timesLoaded>4||"MaskMe"==v[t].origin&&"loginForm"==v[t].type)return void u(t,"tab account has already been loaded >4 times or origin was autofill");try{}catch(e){}d({tabId:t,formData:v[t],currentDomain:e.domain},!0)}}function u(e,t){t=t||"",delete v[e]}function d(e,t){var n=e.tabId,i=e.currentDomain;if(e=e.formData,"MaskMe"==e.origin&&"loginForm"==e.type)return void(k[n]=e);var a=v[n];if(a?(e.metrics=a.metrics,e.accountId=e.accountId||a.accountId):a={},a||f(e)){"loginForm"==a.type&&"loginForm"==e.type||"registrationForm"==a.type&&"registrationForm"==e.type?a.domain==e.domain&&(e=p(a,e),a=e,(f(e)||m(e))&&(t=!0)):e.generated_password&&e.password&&e.password.length>0?t=!0:(f(e)||m(e))&&(t=!0);var c=e.domain;r.Blacklist.findBy("domain",c,function(c){var l=!!c&&c.save_account;r.Preference.findBy("key","rememberAccounts",function(c){if(a.saveRequired||c&&!c.isFalse()&&!l)if(a.saveRequired){if(b(e),u(n,"form submit saveRequired was true - autosaved"),!e.username&&!e.email&&e.generated_password&&e.password&&e.password.length>0){var d="password_with_no_login",p={type:d,account:e,neverFade:!0,panelWidth:420,locked:s.isLocked()};_[n]=p}}else if(t)if(f(e)||m(e))y(e,function(t){var i=null,a=function(e,t){return e.username&&e.username.length>0&&t.username&&t.username.length>0&&e.username!=t.username},c=function(e,t){return e.email&&e.email.length>0&&t.email&&t.email.length>0&&e.email!=t.email};if(!t||a(t,e)||c(t,e))r.Preference.findBy("key","promptWhenSavingAccounts",function(t){if(s.isLocked()||t&&t.isTrue()){i="login";var r={type:i,account:e,neverFade:!0,panelWidth:420,locked:s.isLocked()};_[n]=r}else b(e),u(n,"formSubmit promptWhenSaving is off - autosaved")});else if(t.password!=e.password)if(t.password&&t.password.length>0){i="change_password";var l={type:i,account:e,neverFade:!0,panelWidth:420,locked:s.isLocked()};_[n]=l}else b(e);if(_[n]){var l=_[n];o.clearTimeout(w[n]);var d=o.setTimeout(function(){if(n in w)h(n);else for(n in _)return void T.messenger.send("background:saveForm:notification",l,n)},4e3);w[n]=d}}),u(n,"form submit created save notification already");else if(!e.username&&!e.email&&e.generated_password&&e.password&&e.password.length>0){var d="password_with_no_login",p={type:d,account:e,neverFade:!0,panelWidth:420,locked:s.isLocked()};_[n]=p}else a.domain!=i&&u(n,"domain has changed on tab")})})}}function h(e){o.clearTimeout(w[e]),delete w[e];var t=_[e];t&&T.messenger.send("background:saveForm:notification",t,e)}function f(e){var t=e.email&&e.email.length>0,n=e.password&&e.password.length>0,r=e.username&&e.username.length>0;return n&&(t||r)||n&&e.generated_password}function p(e,t){return t.username=t.username||e.username,t.email=t.email||e.email,t.password=t.password||e.password,t}function m(e){return"changePasswordForm"==e.type&&e.password&&e.password.length>0&&e.oldpassword&&e.oldpassword.length>0}function g(e){var t=v[e.tabId]||{};if(t.saveInProgress)return void o.setTimeout(function(){g(e)},100);if(e.formData.email&&"mapping-update@abine.com"==e.formData.email)return void ABINE_DNTME.require(["modules"],function(e){
e.mappingsModule.forceMappingUpdate(function(){T.messenger.send("background:dntme:show")})});t&&t.id!=e.formData.id&&t.saveRequired&&f(t)&&(b(t),u(e.tabId,"processFieldSubmit tabaccount and form data id is different and saveRequired and account is complete - autosaved"),t={});var n=!1,r=e.fieldData.origin,i=e.fieldData.dataType&&e.fieldData.dataType.match(/phone/);(t.saveRequired||r&&r.match(/disposable|primary|strong/i)&&!i)&&(n=!0);var a=t.metrics||{},s=t.accountId;("loginForm"==t.type&&"loginForm"==e.formData.type||"registrationForm"==t.type&&"registrationForm"==e.formData.type)&&t.domain==e.formData.domain&&(e.formData=p(t,e.formData)),t=e.formData,(s||e.fieldData.accountId)&&(t.accountId=e.fieldData.accountId||s),t.saveRequired=n,t.metrics=a,v[e.tabId]=t,n&&f(t)&&(b(t),u(e.tabId,"processFieldSubmit saverequired and account complete"))}function y(e,t){var n=e.accountId||e.id;r.Account.findBy("id",n,function(i){return i?void t(i):void r.CompanyAccount.findBy("id",n,function(n){if(!n){var i=function(t){return e.domain==t.domain&&(e.email&&e.email.length>0&&(t.email==e.email||t.username==e.email)||e.username&&e.username.length>0&&(t.username==e.username||t.email==e.username)||e.oldpassword&&e.oldpassword.length>0&&t.password==e.oldpassword)};return void r.Account.listCached(i,function(e){0==e.length?r.CompanyAccount.listCached(i,function(e){t(0==e.length?null:e[0])}):t(e[0])})}t(n)})})}function b(e){(e.email||e.username||e.password)&&r.Blacklist.findBy("domain",e.domain,function(t){var n=!!t&&t.save_account;r.Preference.findBy("key","rememberAccounts",function(t){function a(t){t.domain=e.domain,t.page_host=e.page_host,t.form_host=e.form_host,t.protocol=e.protocol;var n="changePasswordForm"==e.type;n||(e.email&&e.email.length>0&&(t.email=e.email),e.username&&e.username.length>0&&(t.username=e.username),e.login_url&&e.login_url.length>0&&(t.login_url=e.login_url),t.times_used=t.times_used||0),e.password&&e.password.length>0&&(t.password=e.password),t.pushed=0,t.modifiedAt=new Date,t.userModifiedAt=t.modifiedAt,t.beforeSave(),i.flush(),i.removeIndex(t),i.addIndex(t);var a=e.metrics||{};for(var s in a)r.PanelActivity[s]({payload:{panelId:7000005,revert:!0}});e.metrics={};var o=e.email&&(e.generated_email||e.email.indexOf(ABINE_DNTME.config.disposableDomain)!=-1);e.generated_password&&o?e.metrics.addMasked=!0:e.generated_password?e.metrics.addClosed=!0:o?e.metrics.addImpression=!0:e.metrics.addDisclosed=!0;for(var s in e.metrics)r.PanelActivity[s]({payload:{panelId:7000005}});delete e.saveInProgress}!t||t.isFalse()||n||(e.saveInProgress=!0,y(e,function(t){t||(t=new r.Account({id:e.id}),t.createdAt=new Date,t.email=t.password=t.username=t.login_url="",i.add(t)),a(t)}))})})}var v={},_={},w={},k={},E=function(e){"Safari"==ABINE_DNTME.config.browser&&e.match(/^ABPS-[0-9]+-[0-9]+$/)&&(e=e.replace(/-[0-9]+$/,"").replace("ABPS","ABCS")),o.clearTimeout(w[e]),delete _[e],delete w[e]},A=n.BaseClass.extend({init:function(t){this.messenger=t,this.messenger.on("contentScript:init",function(e,t){e.previous&&[v,_,w,k].forEach(function(n){n[e.previous]&&(n[t]=n[e.previous],delete n[e.previous])})}),this.messenger.on("contentManager:init",l),this.messenger.on("contentManager:reinit",l),this.messenger.on("contentManager:formsInitialized",function(t,n){var r=_[n];if(r){var i=r.account,a=t.hasLogin;"loginForm"!=i.type?h(n):"password_with_no_login"!=r.type?(a?i.timesLoaded=i.timesLoaded?i.timesLoaded-1:null:e.each(t.forms,function(e){!a&&"loginForm"==e.type&&e.visible&&c(e,i)&&e.id!=i.id&&(i.timesLoaded=i.timesLoaded?i.timesLoaded-1:null,a=!0)}),a?E(n):h(n)):h(n)}else if(k[n]){var a=!1;if(e.each(t.forms,function(e){!a&&"loginForm"==e.type&&e.visible&&c(e,k[n])&&e.id!=k[n].id&&(a=!0)}),a){var o={type:"failed_login",account:k[n],neverFade:!0,panelWidth:420,locked:s.isLocked()};T.messenger.send("background:saveForm:notification",o,n)}}delete k[n]}),this.messenger.on("background:notification:clear",function(e,t){E(t)}),this.messenger.on("background:save:account",function(e,t){E(t),e.pageUrl&&e.pageUrl.match(/^http[s]?:\/\//i)&&(e.login_url=e.pageUrl),b(e),e.alwaysSaveAccounts&&r.Preference.createOrModify({key:"promptWhenSavingAccounts",value:e.alwaysSaveAccounts?"false":"true"})}),this.messenger.on("background:save:or:update:account",function(e,t){y(e,function(n){if(!n)return E(t),e.pageUrl&&e.pageUrl.match(/^http[s]?:\/\//i)&&(e.login_url=e.pageUrl),void b(e);if(!n.isCompanyAccount){var r,i=e;if(n.password!=i.password&&(n.password&&n.password.length>0?r="change_password":b(i)),r){var a={type:r,account:i,neverFade:!0,panelWidth:420,locked:s.isLocked()};T.messenger.send("background:saveForm:notification",a,t)}}})})}}),T=new A;return t.formSubmitDetector.on("background:formSubmit",d),t.formSubmitDetector.on("background:formFieldChanged",g),T}),ABINE_DNTME.define("abine/savePaymentForms",["documentcloud/underscore","abine/formSubmitDetector","abine/core","storage","persistence","abine/url","abine/securityManager","abine/timer"],function(e,t,n,r,i,a,s,o){function c(e){for(var t=0,n=!1,r=e.length-1;r>=0;){var i=parseInt(e.charAt(r));n&&(i*=2,i>9&&(i-=9)),t+=i,r--,n=!n}return t%10==0}function l(t,n){if(t.formSignature==n.formSignature)return!0;var r=0,i=0;return e.each(t.fields,function(e,t){t in n.fields?r++:i++}),r>=3&&r>i}function u(e,t){var n=v[t];n&&y(n,function(e){e&&"DisposableCards"==e._type&&(n.card=e,w[t]=n);try{}catch(e){}f({tabId:t,formData:n},!0)})}function d(e,t){var n={msg:"",targetUrl:ABINE_DNTME.config.protocol+ABINE_DNTME.config.webAppHost+"/#/cards",targetId:"",model:{maskedCard:e.card.toJSON(),declined:{title:"Masked Card Declined?"}},height:260,type:"card",neverFade:!0,locked:s.isLocked()};T.messenger.send("background:show:notification",n,t)}function h(e,t){t=t||"",delete v[e]}function f(t,n){var i=t.tabId;t=t.formData||t;var a=v[i];if(a?(t.metrics=a.metrics,t.cardId=t.cardId||a.cardId,e.each(["expiry_month","expiry_year","number","cvc","issuedto"],function(e){v[i][e]=t[e]||v[i][e]})):(a={},v[i]=t),!a.card_type&&a.number&&(a.card_type=r.RealCard.detectCardType(a.number)),!a.styles&&a.card_type&&(a.brand="generic",a.styles=r.RealCard.getCardStyles(a.card_type,a.brand)),a||m(t)){var c=t.domain;r.Blacklist.findBy("domain",c,function(e){var c=!!e&&e.save_card;r.Preference.findBy("key","rememberCards",function(e){(a.saveRequired||e&&!e.isFalse()&&!c)&&(a.saveRequired?(b(t),h(i,"form submit saveRequired was true - autosaved")):n&&(m(t)?(y(t,function(e){if(e||r.Preference.findBy("key","promptWhenSavingCards",function(e){if(s.isLocked()||e&&e.isTrue()){var n={type:"save_card",card:t,neverFade:!0,panelWidth:420,locked:s.isLocked()};_[i]=n}else b(t),h(i,"formSubmit promptWhenSaving is off - autosaved")}),_[i]){var n=_[i];o.clearTimeout(k[i]);var a=o.setTimeout(function(){if(i in _)p(i);else for(i in _)return void T.messenger.send("background:saveForm:notification",n,i)},4e3);k[i]=a}}),h(i,"form submit created save notification already")):h(i,"card not complete")))})})}}function p(e){o.clearTimeout(k[e]),delete k[e];var t=_[e];t&&T.messenger.send("background:saveForm:notification",t,e)}function m(e){var t=e.number&&e.number.length>0&&c(e.number),n=e.expiry_month&&e.expiry_month.length>0,r=e.expiry_year&&e.expiry_year.length>0;return t&&n&&r}function g(e){var t=v[e.tabId]||{};if(t.saveInProgress)return void o.setTimeout(function(){g(e)},100);t&&t.id!=e.formData.id&&t.saveRequired&&m(t)&&(b(t),h(e.tabId,"processFieldSubmit tabcard and form data id is different and saveRequired and card is complete - autosaved"),t={});var n=!1;t.saveRequired&&(n=!0);var i=t.metrics||{},a=t.cardId;t=e.formData,(a||e.fieldData.cardId)&&(t.cardId=e.fieldData.cardId||a),t.saveRequired=n,t.metrics=i,v[e.tabId]=t,t.card_type=r.RealCard.detectCardType(t.number),t.brand="generic",t.styles=r.RealCard.getCardStyles(t.card_type,t.brand),r.RealCard.detectCardBrand(t.number,function(i){t.brand=i,t.styles=r.RealCard.getCardStyles(t.card_type,t.brand),n&&m(t)&&(b(t),h(e.tabId,"processFieldSubmit saverequired and card complete"))})}function y(e,t){var n=e.cardId||e.id;r.RealCard.findBy("id",n,function(i){return i?void t(i):void r.DisposableCard.findBy("id",n,function(n){if(!n){var i=function(t){return e.number==t.number};return void r.RealCard.listCached(i,function(e){0==e.length?r.DisposableCard.listCached(i,function(e){t(0==e.length?null:e[0])}):t(e[0])})}t(n)})})}function b(e){r.Blacklist.findBy("domain",e.domain,function(t){var n=!!t&&t.save_card;r.Preference.findBy("key","rememberCards",function(t){function a(t){if(t.domain=e.domain,e.number&&e.number.length>0&&(t.number=e.number),e.cvc&&e.cvc.length>0&&(t.cvc=e.cvc),e.expiry_month&&e.expiry_month.length>0&&(t.expiry_month=e.expiry_month),e.expiry_year&&e.expiry_year.length>0&&(t.expiry_year=e.expiry_year),e.issuedto&&e.issuedto.length>0){var n=e.issuedto.split(" ");t.first_name=n[0],n.length>=2&&(t.last_name=n[1])}t.detectCardType(),t.label=t.type.substr(0,1).toUpperCase()+t.type.replace(/[^a-z]+/g," ").substr(1)+" "+t.number.substr(-4),t.pushed=0,t.modifiedAt=new Date,i.flush();var a=e.metrics||{};for(var s in a)r.PanelActivity[s]({payload:{panelId:8000091,revert:!0}});e.metrics={},e.metrics.addImpression=!0;for(var s in e.metrics)r.PanelActivity[s]({payload:{panelId:8000091}});delete e.saveInProgress}!t||t.isFalse()||n||(e.saveInProgress=!0,y(e,function(t){t||(t=new r.RealCard({id:e.id}),t.createdAt=new Date,t.number=t.first_name=t.last_name=t.expiry_month=t.expiry_year=t.cvc="",i.add(t)),a(t)}))})})}var v={},_={},w={},k={},E=function(e){"Safari"==ABINE_DNTME.config.browser&&e.match(/^ABPS-[0-9]+-[0-9]+$/)&&(e=e.replace(/-[0-9]+$/,"").replace("ABPS","ABCS")),o.clearTimeout(k[e]),delete _[e],delete k[e]},A=n.BaseClass.extend({init:function(t){this.messenger=t,this.messenger.on("contentScript:init",function(e,t){e.previous&&[v,_,k,w].forEach(function(n){n[e.previous]&&(n[t]=n[e.previous],delete n[e.previous])})}),this.messenger.on("contentManager:init",u),this.messenger.on("contentManager:reinit",u),this.messenger.on("contentManager:formsInitialized",function(t,n){if(w[n]){var r=w[n],i=!1;return e.each(t.forms,function(e){!i&&l(e,r)&&(i=!0)}),i&&d(r,n),void delete w[n]}var a=_[n];if(a){var r=a.card,i=!1;e.each(t.forms,function(e){!i&&l(e,r)&&(i=!0)}),i?(o.clearTimeout(k[n]),E(n),h(n,"form submit failed")):p(n)}}),this.messenger.on("background:notification:clear",function(e,t){E(t)}),this.messenger.on("background:save:card",function(e,t){E(t),b(e),"alwaysSaveCards"in e&&r.Preference.createOrModify({key:"promptWhenSavingCards",value:e.alwaysSaveCards?"false":"true"})}),this.messenger.on("background:save:or:update:card",function(e,t){y(e,function(n){n||(E(t),b(e))})})}}),T=new A;return t.formSubmitDetector.on("background:formSubmit",f),t.formSubmitDetector.on("background:formPaymentFieldChanged",g),T}),ABINE_DNTME.define("abine/feedbackLoop",["documentcloud/underscore","abine/formSubmitDetector","abine/core","storage","persistence","abine/url","abine/securityManager"],function(e,t,n,r,i,a,s){function o(e,t,n){if(n&&(e[t]||(e[t]=[]),n=(n+"").toLowerCase().replace(/\s/gi,""),n.length>0)){var r="(^"+n+"$)";e[t].indexOf(r)==-1&&e[t].push(r)}}function c(e,t){10==t.length&&(o(e,"/contact/phone/areacode",t.substr(0,3)),o(e,"/contact/phone/exchange",t.substr(3,3)),o(e,"/contact/phone/local",t.substr(6,4)))}function l(e,t){16==t.length&&(o(e,"/financial/creditcard/number/part1",t.substr(0,4)),o(e,"/financial/creditcard/number/part2",t.substr(4,4)),o(e,"/financial/creditcard/number/part3",t.substr(8,4)),o(e,"/financial/creditcard/number/part4",t.substr(12,4)))}function u(e,t){2==t.length&&T[t]&&o(e,"/contact/state",T[t])}function d(e,t){2==t.length&&A[t]&&o(e,"/contact/country",A[t])}function h(e,t,n){var r=/createdAt|label|modifiedAt|pushed|address_id|brand|auth_token|is_validated|pushVersion|rails_id/gi;t.forEach(function(t){for(var i in t._data)if(!i.match(r)){var a=_[n+"-"+i],s=t._data[i];o(e,a,s),w[a]&&s&&w[a](e,s)}})}function f(e,t){return b&&!t?void e():(b={},void r.Address.index(null,function(t){h(b,t,"address"),r.RealCard.index(null,function(t){h(b,t,"card"),r.ShieldedPhone.index(null,function(t){h(b,t,"phone");var n=[];for(var r in b)n.push(b[r].join("|")),b[r]=new RegExp(b[r].join("|"));v=new RegExp(n.join("|")),e()})})}))}function p(e){if(!e)return null;e=e.toLowerCase().replace(/\s/gi,"");var t=null;if(e.length>0&&e.match(v))for(var n in b)if(e.match(b[n])){t=n;break}return t}function m(e,t){return e?t&&0==t.indexOf("/password")?"**********":e.replace(/[a-z]/gi,"a").replace(/[0-9]/g,"d").replace(/[^aAd@]/g,"x").substr(0,50):e}function g(e,t){var n=m(e.value,e.dataType),r=p(e.value);return{className:e.className,dataType:e.dataType,detectedType:e.detectedType,mappedType:e.mappedType,fieldType:e.fieldType,fieldId:e.id,label:e.label,maxlength:e.maxlength,name:e.name,position:e.position,signature:e.signature,size:e.size,hidden:e.hidden,rule_locale:e.matchedLocale,maskedValue:n,matchedDataType:r,formId:t.id}}function y(t){t.formData.type&&t.formData.type.match(/checkout|login|regist|change|address/)&&r.Preference.findBy("key","shouldSendErrorReports",e.bind(function(n){n&&!n.isTrue()||f(function(){var n=t.fieldData.value,i=!1;if(n&&n.length<=50){var a=[],o=!1,c=null,l=t.formData,u=t.checkoutButtons,d={domain:l.domain,formSignature:l.formSignature,formHost:l.form_host,formId:l.id,fieldCount:l.allFields.length,pageHost:l.page_host,formType:l.type,language:l.language,registered:null!=s.getUserId(),premium:s.isPremium(),local_mapping:l.local_mapping,mappedFormType:l.mappedFormType,detected_locales:l.detectedLocales,formless_depth:l.formlessDepth,tag_name:l.tagName,pageUrl:null,amex:u.amex,amazon:u.amazon,master:u.master,visa:u.visa,paypal:u.paypal,chase:u.chase};e.each(t.formData.allFields,function(e){e.dataType&&e.dataType.match(k)&&(i=!0);var n=g(e,t.formData);a.push(n),n.matchedDataType&&(o=!0),c||e.signature!=t.fieldData.signature||(c=n,c.fillType=t.fieldData.blurFilled?1:2)}),!o&&i||r.FieldData.createLocal({payload:c,allFields:a,form:d},function(){})}})},this))}var b=null,v=null,_={"address-address1":"/contact/postaladdress","address-address2":"/contact/postaladdressAdditional","address-city":"/contact/city","address-country":"/contact/country","address-state":"/contact/state","address-zip":"/contact/postalcode","card-cvc":"/financial/creditcard/verification","card-expiry_month":"/financial/creditcard/expirymonth","card-expiry_year":"/financial/creditcard/expiryyear","card-first_name":"/financial/creditcard/issuedto/first","card-last_name":"/financial/creditcard/issuedto/last","card-number":"/financial/creditcard/number","card-type":"/financial/creditcard/type","phone-country_code":"/contact/phone/countrycode","phone-number":"/contact/phone"},w={"/financial/creditcard/number":l,"/contact/phone":c,"/contact/state":u,"/contact/country":d},k=/search|subject|message/i;s.on("background:securityManager:locked",function(){b=null,v=null});var E=e.debounce(function(){f(function(){},!0)});s.on("entity:changed:RealCard",E),s.on("entity:changed:Address",E),t.formSubmitDetector.on("background:formFieldChanged:processMapping",y);var A={AF:"Afghanistan",AL:"Albania",DZ:"Algeria",AS:"American Samoa",AD:"Andorra",AO:"Angola",AI:"Anguilla",AQ:"Antarctica",AG:"Antigua and Barbuda",AR:"Argentina",AM:"Armenia",AW:"Aruba",AC:"Ascension Island",AU:"Australia",AT:"Austria",AZ:"Azerbaijan",BS:"Bahamas",BH:"Bahrain",BD:"Bangladesh",BB:"Barbados",BE:"Belgium",BZ:"Belize",BJ:"Benin",BM:"Bermuda",BT:"Bhutan",BO:"Bolivia",BA:"Bosnia and Herzegovina",BW:"Botswana",BV:"Bouvet Island",BR:"Brazil",BQ:"British Antarctic Territory",IO:"British Indian Ocean Territory",VG:"British Virgin Islands",BN:"Brunei",BG:"Bulgaria",BF:"Burkina Faso",BI:"Burundi",KH:"Cambodia",CM:"Cameroon",CA:"Canada",IC:"Canary Islands",CT:"Canton and Enderbury Islands",CV:"Cape Verde",KY:"Cayman Islands",CF:"Central African Republic",EA:"Ceuta and Melilla",TD:"Chad",CL:"Chile",CN:"China",CX:"Christmas Island",CP:"Clipperton Island",CC:"Cocos [Keeling] Islands",CO:"Colombia",KM:"Comoros",CD:"Congo [DRC]",CK:"Cook Islands",CR:"Costa Rica",HR:"Croatia",CU:"Cuba",CY:"Cyprus",CZ:"Czech Republic",DK:"Denmark",DG:"Diego Garcia",DJ:"Djibouti",DM:"Dominica",DO:"Dominican Republic",NQ:"Dronning Maud Land",TL:"East Timor",EC:"Ecuador",EG:"Egypt",SV:"El Salvador",EE:"Estonia",ET:"Ethiopia",FK:"Falkland Islands [Islas Malvinas]",FO:"Faroe Islands",FJ:"Fiji",FI:"Finland",FR:"France",GF:"French Guiana",PF:"French Polynesia",TF:"French Southern Territories",FQ:"French Southern and Antarctic Territories",GA:"Gabon",GM:"Gambia",GE:"Georgia",DE:"Germany",GH:"Ghana",GI:"Gibraltar",GR:"Greece",GL:"Greenland",GD:"Grenada",GP:"Guadeloupe",GU:"Guam",GT:"Guatemala",GG:"Guernsey",GW:"Guinea-Bissau",GY:"Guyana",HT:"Haiti",HM:"Heard Island and McDonald Islands",HN:"Honduras",HK:"Hong Kong",HU:"Hungary",IS:"Iceland",IN:"India",ID:"Indonesia",IE:"Ireland",IM:"Isle of Man",IL:"Israel",IT:"Italy",JM:"Jamaica",JP:"Japan",JE:"Jersey",JT:"Johnston Island",JO:"Jordan",KZ:"Kazakhstan",KE:"Kenya",KI:"Kiribati",KW:"Kuwait",KG:"Kyrgyzstan",LA:"Laos",LV:"Latvia",LS:"Lesotho",LY:"Libya",LI:"Liechtenstein",LT:"Lithuania",LU:"Luxembourg",MO:"Macau",MK:"Macedonia [FYROM]",MG:"Madagascar",MW:"Malawi",MY:"Malaysia",MV:"Maldives",ML:"Mali",MT:"Malta",MH:"Marshall Islands",MQ:"Martinique",MR:"Mauritania",MU:"Mauritius",YT:"Mayotte",FX:"Metropolitan France",MX:"Mexico",FM:"Micronesia",MI:"Midway Islands",MD:"Moldova",MC:"Monaco",MN:"Mongolia",ME:"Montenegro",MS:"Montserrat",MA:"Morocco",MZ:"Mozambique",NA:"Namibia",NR:"Nauru",NP:"Nepal",NL:"Netherlands",AN:"Netherlands Antilles",NT:"Neutral Zone",NC:"New Caledonia",NZ:"New Zealand",NI:"Nicaragua",NE:"Niger",NG:"Nigeria",NU:"Niue",NF:"Norfolk Island",VD:"North Vietnam",MP:"Northern Mariana Islands",NO:"Norway",OM:"Oman",QO:"Outlying Oceania",PC:"Pacific Islands Trust Territory",PK:"Pakistan",PW:"Palau",PS:"Palestinian Territories",PA:"Panama",PZ:"Panama Canal Zone",PY:"Paraguay",YD:"People's Democratic Republic of Yemen",PE:"Peru",PH:"Philippines",PN:"Pitcairn Islands",PL:"Poland",PT:"Portugal",PR:"Puerto Rico",QA:"Qatar",RO:"Romania",RU:"Russia",RW:"Rwanda",RE:"R&eacute;union",BL:"Saint Barth&eacute;lemy",SH:"Saint Helena",KN:"Saint Kitts and Nevis",LC:"Saint Lucia",MF:"Saint Martin",PM:"Saint Pierre and Miquelon",VC:"Saint Vincent and the Grenadines",WS:"Samoa",SM:"San Marino",SA:"Saudi Arabia",SN:"Senegal",RS:"Serbia",CS:"Serbia and Montenegro",SC:"Seychelles",SL:"Sierra Leone",SG:"Singapore",SK:"Slovakia",SI:"Slovenia",SB:"Solomon Islands",ZA:"South Africa",GS:"South Georgia and the South Sandwich Islands",KR:"South Korea",ES:"Spain",LK:"Sri Lanka",SR:"Suriname",SJ:"Svalbard and Jan Mayen",SZ:"Swaziland",SE:"Sweden",CH:"Switzerland",ST:"S&atilde;o Tom&eacute; and Pr&iacute;ncipe",TW:"Taiwan",TJ:"Tajikistan",TZ:"Tanzania",TH:"Thailand",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinidad and Tobago",TA:"Tristan da Cunha",TN:"Tunisia",TR:"Turkey",TM:"Turkmenistan",TC:"Turks and Caicos Islands",TV:"Tuvalu",UM:"U.S. Minor Outlying Islands",PU:"U.S. Miscellaneous Pacific Islands",VI:"U.S. Virgin Islands",UG:"Uganda",UA:"Ukraine",AE:"United Arab Emirates",GB:"United Kingdom",US:"United States",UY:"Uruguay",UZ:"Uzbekistan",VU:"Vanuatu",VA:"Vatican City",VE:"Venezuela",VN:"Vietnam",WK:"Wake Island",WF:"Wallis and Futuna",EH:"Western Sahara",YE:"Yemen",ZM:"Zambia",AX:"&Aring;land Islands"},T={AK:"Alaska",AL:"Alabama",AP:"Armed Forces Pacific",AR:"Arkansas",AS:"American Samoa",AZ:"Arizona",CA:"California",CO:"Colorado",CT:"Connecticut",DC:"District of Columbia",DE:"Delaware",FL:"Florida",FM:"Federated States of Micronesia",GA:"Georgia",GU:"Guam",HI:"Hawaii",IA:"Iowa",ID:"Idaho",IL:"Illinois",IN:"Indiana",KS:"Kansas",KY:"Kentucky",LA:"Louisiana",MA:"Massachusetts",MD:"Maryland",ME:"Maine",MH:"Marshall Islands",MI:"Michigan",MN:"Minnesota",MO:"Missouri",MP:"Northern Mariana Islands",MS:"Mississippi",MT:"Montana",NC:"North Carolina",ND:"North Dakota",NE:"Nebraska",NH:"New Hampshire",NJ:"New Jersey",NM:"New Mexico",NV:"Nevada",NY:"New York",OH:"Ohio",OK:"Oklahoma",OR:"Oregon",PA:"Pennsylvania",PR:"Puerto Rico",PW:"Palau",RI:"Rhode Island",SC:"South Carolina",SD:"South Dakota",TN:"Tennessee",TX:"Texas",UT:"Utah",VA:"Virginia",VI:"Virgin Islands",VT:"Vermont",WA:"Washington",WV:"West Virginia",WI:"Wisconsin",WY:"Wyoming"};return{}}),ABINE_DNTME.define("abine/securityManager",["documentcloud/underscore","abine/core","storage","persistence","abine/timer","abine/config","abine/window","abine/localStorage","abine/crypto"],function(e,t,n,r,i,a,s,o,c){function l(e,t){t=t||v,ABINE_DNTME.require(["abine/memoryStore"],function(e){e.set("login-panel-ignored",0),e.set("login-panel-closed",null)}),w.refreshData(function(){w.messenger.broadcastToAllTabs("background:securityManager:unlocked",{}),w.trigger("background:securityManager:unlocked",e),t(null,e)})}var u=!0,d=!1,h=null,f=null,p=!1,m=null,g=null,y=null,b=null,v=function(){},_=t.BaseClass.extend({initialize:function(){},load:function(t){t&&(this.messenger=t,this.messenger.on("biometric:auth",e.bind(this.biometricCardAuth,this)),this.messenger.on("password:auth",e.bind(this.passwordCardAuth,this)));var r=function(){p=!0;var e=function(){w.trigger("background:securityManager:initialized")};u||l(),e()},i=this;n.Preference.findBy("key","authToken",function(e){n.Preference.findBy("key","key",function(t){n.Preference.findBy("key","ckey",function(n){e&&""!=e.value?(d=!0,u=!1,h=e.value,i.setEncryptionKey(t?t.value:null,n?n.value:null,r)):(u=!0,d=!1,h=null,f=null,i.setEncryptionKey(null,r))})})})},getUserId:function(){return y},setUserId:function(e){y=e},getCompanyEncryptionKey:function(){return g},getAuthToken:function(){return h},getEncryptionKey:function(){return m},isPremium:function(){return"premium"==f},setEncryptionKey:function(e,t,r){function i(){n.Account.clearCache(function(){n.Address.clearCache(function(){n.Note.clearCache(function(){n.AccountHistory.clearCache(function(){n.RealCard.clearCache(function(){n.CompanyAccount.clearCache(function(){n.EmailDomain.clearCache(function(){r()})})})})})})})}if(r=r||v,e&&""!=e&&"undefined"!=e){if(m!=e||g!=t)return m=e,g=t,void n.Preference.createOrModify({key:"key",value:e},function(){n.Preference.createOrModify({key:"ckey",value:t},function(){i()})})}else if(null!=m)return b=null,m=null,g=null,void i();r()},__setUserIdAndKey:function(e,t){y=e,m=t&&""!=t&&"undefined"!=t?t:null},getAuthToken:function(){return h},setAuthToken:function(t,i,a,s){s=s||v;var o=t&&t.length>0;n.Preference.createOrModify({key:"lastActivity",value:Date.now()},e.bind(function(){n.Preference.findBy("key","authToken",e.bind(function(c){return c&&c.value==t&&t==h?void this.setEncryptionKey(i,a,function(){o&&w.refreshData(s)}):(r.reset(),void this.setEncryptionKey(i,a,e.bind(function(){n.Preference.findBy("key","hasRegistered",e.bind(function(r){n.Preference.batchCreateOrModify([{key:"authToken",value:t},{key:"key",value:i},{key:"ckey",value:a},{key:"oldHasRegistered",value:r?r.value:"false"},{key:"hasRegistered",value:o?"true":"false"}],e.bind(function(){t&&""!=t?(ABINE_DNTME._started=!0,u=!1,d=!0,h=t,l(null,s)):(n.Preference.removeByKey("altEmail1"),n.Preference.removeByKey("altEmail2"),n.Preference.createOrModify({key:"userTag",value:""}),n.Preference.findBy("key","dynamicTag",function(e){e&&e.value&&ABINE_DNTME.config.updateTag(e.value)}),u=!0,y=null,h=null,ABINE_DNTME.require(["abine/memoryStore"],function(e){e.set("biometricKeyToken",null)}),ABINE_DNTME.require(["abine/blurstore-api"],function(e){e.disconnect()}),ABINE_DNTME.require(["abine/pushNotifications"],function(e){e.disconnect()}),n.Preference.retainDefaults(e.bind(function(){this.messenger.broadcastToAllTabs("broadcast:preference:reload",{}),this.messenger.broadcastToAllTabs("background:securityManager:locked",{}),w.trigger("background:securityManager:locked"),s()},this)))},this))},this))},this)))},this))},this))},login:function(){s.reloadTab({url:ABINE_DNTME.config.protocol+ABINE_DNTME.config.webAppHost})},logout:function(){this.setAuthToken(null,null)},openPage:function(e,t,n){if(t===!0){var r="";e.match(/[&\?]$/)||(r="&"),r+="v="+ABINE_DNTME.config.version,r+="&tag="+ABINE_DNTME.config.tags[0],e+=r}else t&&(ABINE_DNTME.lastPanel||(ABINE_DNTME.lastPanel={}),ABINE_DNTME.lastPanel[t.action]=t.id);0!==e.indexOf("http")&&(e.match(/^\//)||(e="/"+e),e=ABINE_DNTME.config.protocol+ABINE_DNTME.config.webAppHost+e),s.createTab({url:e,doNotActivate:1==n,doNotOpenNewTab:1==n})},passwordCardAuth:function(e,t){var n=this;ABINE_DNTME.require(["modules"],function(r){r.licenseModule.passwordCardAuth(e,function(r){n.messenger.send(e.responseId,r,t)})})},biometricCardAuth:function(e,t){var n=this;ABINE_DNTME.require(["abine/pushNotifications"],function(r){r.biometricAuthCancel(),r.requestBiometricAuth(e.type||"card",e.key,e.domain,e.amount,e.number,e.account,function(r){n.messenger.send(e.responseId,r,t)})})},openPostInstall:function(){n.Preference.findBy("key","postInstallUrl",e.bind(function(e){e&&e.value&&this.openPage(e.value)},this))},openWindow:function(e,t,n){s.openWindow(e,t,n)},openLink:function(e){this.getLink(e,function(e){s.createTab({url:e})})},getLink:function(e,t){e.lang="en",e.v=ABINE_DNTME.config.version,n.Preference.batchFindBy([{by:"key",value:"installVersion"},{by:"key",value:"installDate"}],function(n){if(n.installVersion&&(e.ov=n.installVersion.value),n.installDate){var r=new Date(parseInt(n.installDate.value));e.cohort=r.getFullYear()+"-"+(r.getMonth()+1)+"-"+r.getDate()}e.o=ABINE_DNTME.config.tags[0];var i="";for(var a in e)i+=""==i?"?":"&",i+=encodeURIComponent(a)+"="+encodeURIComponent(e[a]);t("http://donottrackplus.com/link.php"+i)})},isLocked:function(){return u},hasPassword:function(){return d},isInitialized:function(){return p},isMaskmeInstalled:function(){return ABINE_DNTME.maskme_installed},refreshRules:function(){ABINE_DNTME.require(["abine/dntmeInit"],function(e){e.updateRules()})},afterRefresh:function(e){this._refreshInProgress?this._refreshCallbacks.push(e):e()},getBillingManager:function(){return b},getAnonymousId:function(){var e=o.getItem("anonymousId");return e||(e=c.sha1(r.createUUID()),o.setItem("anonymousId",e)),e},refreshData:function(t,i){function a(){function t(){e.each(s._refreshCallbacks,function(e){try{e()}catch(e){}}),delete s._refreshCallbacks,delete s._refreshInProgress}g&&""!=g?(n.Preference.createOrModify({key:"hasCompanyKey",value:"true"}),n.EmailDomain.fetchFromServer(function(){n.CompanyAccount.fetchFromServer(t)})):(n.Preference.createOrModify({key:"hasCompanyKey",value:"false"}),n.EmailDomain.fetchFromServer(function(){t()})),n.Preference.findBy("key","hasEnabledPayments",function(e){e&&"true"==e.value&&n.DisposableCard.getAllCards({})})}if(ABINE_DNTME.require(["abine/pushNotifications"],function(e){e.connect()}),t&&t!==!0&&(i=t,t=!1),i=i||v,this._refreshInProgress)return void this._refreshCallbacks.push(i);this._refreshCallbacks=[i],this._refreshInProgress=!0;var s=this;ABINE_DNTME.require(["modules","abine/modules/mappings","abine/modules/panels"],function(t){function i(t){n.Preference.batchFindBy([{by:"key",value:"oldHasRegistered"},{by:"key",value:"hasRegistered"},{by:"key",value:"hasEnabledPayments"},{by:"key",value:"entitledToPhone"}],e.bind(function(e){var n="unregistered",i=!1;e.oldHasRegistered&&(r.remove(e.oldHasRegistered),e.hasRegistered=e.oldHasRegistered),e.hasRegistered&&e.hasRegistered.isTrue()&&(e.entitledToPhone&&e.entitledToPhone.isTrue()?(n="premium",e.hasEnabledPayments&&e.hasEnabledPayments.isTrue()&&(i=!0)):n="registered"),t(n,i)},this))}function s(){}i(e.bind(function(o,c){n.Preference.retainDefaults(function(){t.licenseModule.refreshEntitlements(function(l,u){n.ShieldedEmail.cached=!0,w.setUserId(null),l?(s(),a()):(w.setUserId(u.user.id),ABINE_DNTME.setupUninstallUrl(),n.Preference.findBy("key","dynamicTag",function(){n.Preference.createOrModify({key:"userTag",value:u.user.tag||""}),u.user.tag&&ABINE_DNTME.config.updateTag(u.user.tag)}),n.Preference.createOrModify({key:"has_mobile",value:u.user.first_phone_use_date||u.user.first_tablet_use_date?"true":"false"}),n.Preference.createOrModify({key:"sync_store_manager",value:u.user.sync_store_manager}),n.Preference.createOrModify({key:"masked_card_auth",value:u.user.masked_card_auth?u.user.masked_card_auth:"none"}),n.Preference.createOrModify({key:"biometric_type",value:u.user.biometric_type?u.user.biometric_type:""}),u.user.company&&u.user.company.has_cards?n.Preference.createOrModify({key:"hasCompanyCards",value:"true"}):n.Preference.removeByKey("hasCompanyCards"),b=u.user.billing_manager,n.clearAllCache(u.user.sync_store_manager,e.bind(function(){i(e.bind(function(i,l){f=i;var d=[];"unregistered"==o&&"unregistered"!=i&&d.push("open_registration_page"),"premium"!=o&&"premium"==i&&(d.push("open_plans_page"),d.push("open_snowman_page")),!c&&l&&d.push("open_activate_cards_page"),e.async.forEach(d,function(e,n){t.panelsModule.panelConversionCheck(e,n)},s),n.ShieldedEmail.findBy("email",u.user.email,function(e){e&&r.remove(e),n.Preference.createOrModify({key:"oldEmail",value:u.user.email}),u.user.alternate_email1?n.Preference.createOrModify({key:"altEmail1",value:u.user.alternate_email1}):n.Preference.removeByKey("altEmail1"),u.user.alternate_email2?n.Preference.createOrModify({key:"altEmail2",value:u.user.alternate_email2}):n.Preference.removeByKey("altEmail2"),e=new n.ShieldedEmail({email:u.user.email,first_name:u.user.first_name,last_name:u.user.last_name}),r.add(e),n.Preference.findBy("key","loginNotLock",function(e){e&&r.remove(e),n.DisposableEmail.indexFromServer(null,function(){n.Preference.findBy("key","entitledToPhone",function(e){return!e||e.isFalse()?void a():void t.phoneModule.getPhone(null,function(e,t){if(n.ShieldedPhone.cached=!0,e||!t.shielded_phone)return void a();var i=t.shielded_phone;n.ShieldedPhone.findBy("number",i.number,function(e){if(e&&r.remove(e),e=new n.ShieldedPhone({country_code:i.country_code,number:i.number,is_validated:i.is_validated?"true":"false",rails_id:i.id}),r.add(e),i.disposable_phones.length>0){var t=i.disposable_phones[0];n.DisposablePhone.findBy("number",t.number,function(i){i&&r.remove(i),i=new n.DisposablePhone({country_code:t.country_code,number:t.number,released:t.released,rails_id:t.id,shielded_phone_id:e.id}),r.add(i),a()})}else a()})})})})})})},this))},this)))})})},this))})}}),w=new _;return w}),ABINE_DNTME.define("abine/server",["documentcloud/underscore","abine/ajax","abine/config","storage","abine/core","abine/responseCodes","abine/window","persistence","abine/timer","abine/securityManager","abine/localStorage"],function(e,t,n,r,i,a,s,o,c,l,u){var d=function(){},h=function(e,t){return e.skip_auth_token?void t.call(this,e):void r.Preference.findBy("key","authToken",function(n){r.Preference.findBy("key","installAuthToken",function(r){var i=!n||n.isEmpty()?null:n.value,a=!r||r.isEmpty()?null:r.value;i&&(e.data.auth_token=i),a&&(e.data.install_auth_token=a),t.call(this,e)})})},f=function(e){if(!e.skip_ca){var t=e.data,r=n.version;ABINE_DNTME.dntme_upgrade&&!ABINE_DNTME.merged_data_available&&(r="dnt2-"+r),t.client_application.version=r,t.client_application.environment=n.environment,t.client_application.tag=n.tags[0],t.client_application.browser=n.browser,t.client_application.build_num=n.buildNum,t.client_application.user_agent=ABINE_DNTME.userAgent,t.client_application.product="DNT3",t.client_application.device="Extension";var i=u.getItem("device_id");i||(i=Math.floor(1e8*Math.random()),u.setItem("device_id",""+i)),t.client_application.device_id=i}},p=i.BaseClass.extend({makeRequest:function(n){n.defaults=n.defaults||{},n.required=n.required||[],n.data=e.defaults(n.data||{},n.defaults),n.type=n.type||"POST",n.dataType=n.dataType||"json";var r=n.success||d,i=n.error||d;return n.data.client_application||(n.data.client_application={}),n.success=e.bind(function(e,t,s){var o=s.status;if(n.raw)var c=e;else var c=e.data;n.raw||"scheduled downtime"!=e.error_code?r(c,o):i(o,a.SCHEDULED_DOWNTIME,{error_code:a.SCHEDULED_DOWNTIME})},this),n.error=e.bind(function(e){var t=e.status,n={error_code:a.UNKNOWN_ERROR};try{n=JSON.parse(e.responseText)}catch(e){}var r=n.error_code;500==t?r=a.UNKNOWN_ERROR:503==t&&(r=a.SERVICE_UNAVAILABLE_ERROR),r==a.UNAUTHORIZED&&l.setAuthToken("","",""),i(t,r,n)},this),this.hasRequiredParams(n.required,n.data)?void h(n,function(e){f(e),t.ajax(e)}):(ABINE_DNTME.log.error("[ERROR HANDLER]#["+n.server+"]#["+n.action+"]# client missing required parameters"),void i(422,a.MISSING_PARAMETERS,{}))},hasRequiredParams:function(t,n){var r=!0;return e.each(t,e.bind(function(t){e.has(n,t)&&!this.isEmpty(n[t])||(r=!1)},this)),r},isEmpty:function(e){return null===e||void 0===e||NaN===e||""===e}}),m=p.extend({makeRequest:function(e){if(!e.url)throw"server calls must have a url";
e.data=e.data||{},e.type=e.type||"POST",e.dataType=e.dataType||"json";var t=e.success||d,n=e.error||d;e.success=function(e,n,r){var i=r.status,a=e.data;t(a,i,this)},e.error=function(e){var t=e.status,r={error_code:a.UNKNOWN_ERROR};try{r=JSON.parse(e.responseText)}catch(e){}var i=r.error_code;500==t&&(i=a.UNKNOWN_ERROR),n(t,i,r)},e.data.client_application||(e.data.client_application={}),this.lastRequest=e,this.tokenSet=!1;var r=this;h(e,function(e){f(e),r.tokenSet=!0,r.waitingRequest&&(r.waitingRequest(),delete r.waitingRequest)}),this.trigger("request:made")},respondWithSuccess:function(t,n,r){return this.tokenSet?(this.lastRequest.success.call(this.lastRequest,t,n,r),void delete this.lastRequest):void(this.waitingRequest=e.bind(this.respondWithSuccess,this,t,n,r))},respondWithError:function(t,n,r){return this.tokenSet?(this.lastRequest.error=!0,this.lastRequest.error.call(this.lastRequest,t,n,r),void delete this.lastRequest):void(this.waitingRequest=e.bind(this.respondWithError,this,t,n,r))}});return{server:p,mock:m}}),ABINE_DNTME.define("abine/storageMixins",["documentcloud/underscore","persistence","abine/localStorage","abine/crypto","abine/securityManager"],function(e,t,n,r,i){function a(e){ABINE_DNTME.require(["abine/pageEvents"],function(){ABINE_DNTME.backgroundMessenger.sendToWebapp("entity:changed",e)}),"Address"==e?i.trigger("entity:changed:"+e):"RealCard"==e&&(i.trigger("entity:changed:"+e),ABINE_DNTME.backgroundMessenger.broadcastToAllTabs("entity:changed:"+e))}var s={index:function(e,n){var r=this;if(r.meta.cached&&r.cached){var i=t.getCachedEntities(r);r.respondWithEntities(i,e,n)}else if(r.cachingQueryInProgress)r.waitingCallbacks.push({req:e,cb:n});else{r.cachingQueryInProgress=!0,r.waitingCallbacks=[];try{if(r.meta.localStorage)try{r.loadFromLocalStorage()}catch(e){}this.all().list(null,function(i){r.meta.cached&&(r.cached=!0);var s=r.waitingCallbacks;delete r.cachingQueryInProgress,delete r.waitingCallbacks;try{r.respondWithEntities(i,e,n)}catch(e){ABINE_DNTME.log.error(e)}for(var o=0;o<s.length;o++)try{i=t.getCachedEntities(r),r.respondWithEntities(i,s[o].req,s[o].cb)}catch(e){ABINE_DNTME.log.error(e)}a(r.meta.name)})}catch(e){var s=r.waitingCallbacks;delete r.cachingQueryInProgress,delete r.waitingCallbacks;for(var o=0;o<s.length;o++)try{r.respondWithEntities([],s[o].req,s[o].cb)}catch(e){ABINE_DNTME.log.error(e)}}}},isCached:function(){return this.meta.cached&&this.cached},show:function(e,t){var n=e.params[0];this.load(n,function(n){t?t.call(this,n):e.returnEntities&&e.returnEntities(n)})},create:function(e,n){var r=this;delete e.payload._type,e.payload.createdAt=new Date,e.payload.modifiedAt=new Date;var i=new r(e.payload);t.forceAdd(i),t.flush(null,function(){n?n.call(this,i):e.returnEntities&&e.returnEntities(i)})},update:function(n,r){var i=n.params[0];n.payload.modifiedAt=new Date,this.load(i,function(i){e.extend(i,n.payload),t.flush(null,function(){r?r.call(this,i):n.returnEntities&&n.returnEntities(i)})})},destroy:function(e,n){var r=e.params[0];this.load(r,function(r){t.remove(r),t.flush(null,function(){n?n.call():e.returnStatus&&e.returnStatus("ok")})})},respondWithEntities:function(e,t,n){n?n.call(this,e):t&&t.returnEntities&&t.returnEntities(e)},respondWithJSON:function(e,t,n){n?n.call(null,e):t.returnJSON&&t.returnJSON(e)},clearCache:function(n){if(this.decryptionFailed=!1,!this.cached)return void(n&&n());try{this.index(null,e.bind(function(r){e.each(r,function(e){t.clearFromEntityCache(e)}),this.cached=!1,this.decryptionFailed=!1,n&&n()},this))}catch(e){}},listCached:function(t,n,r,i){if(!this.meta.cached)throw"listCached cannot be used with entities that do not have caching enabled.";"function"==typeof t?(r=t,i=n,t=null):i||(i=r,r=null),this.index(null,function(a){var s=[];e.each(a,function(e){t&&e[t]!=n||r&&!r(e)||s.push(e)}),i&&i(s)})},listByIndex:function(e,n){var r=this;if(!r.meta.indexed)throw"listByIndexed cannot be used with entities that do not have indexing enabled.";r.meta.cached&&r.cached?n(t.getEntitiesByIndex(r,e)):this.index(null,function(){n(t.getEntitiesByIndex(r,e))})},initCache:function(e){this.meta.cached&&!this.cached?this.index(null,function(){e()}):e()},useLocalStorage:function(){this.meta.localStorage=!0},useEncryption:function(e){this.meta.encrypted=!0,this.meta.encryptedFields=e||[]},useSyncStorage:function(){this.useLocalStorage(),this.meta.syncStorage=!0,this.meta.keepId=!0,ABINE_DNTME.require(["abine/blurstore-api"],e.bind(function(e){e.addTable(this.meta.name)},this))},loadFromLocalStorage:function(){var a=this,s=!1,o=null,c=a.meta.name,l=n.getItem(c),u=i.getUserId();u&&a.meta.encrypted&&(o=i.getEncryptionKey(),c+="."+u,l&&(n.getItem(c)||n.setItem(c,l),n.removeItem(a.meta.name)),l=n.getItem(c)),a.decryptionFailed=!1;var d=null;if(l&&""!=l){if(l.indexOf("ENC_")!=-1){if(l=l.substr(4),!o)throw a.decryptionFailed=!0,"encryption key not present for decrypting "+c;var h=r.decryptKey(o,l,null,!0);if(h==l)throw a.decryptionFailed=!0,"decryption error for "+this.meta.name;l=h}else o&&(s=!0);try{d=JSON.parse(l)}catch(e){}}else d=this._defaults;d&&e.each(d,function(e){var n=new a(e);t.forceAdd(n),n._dirtyProperties={},n._new=!1}),this.meta.syncStorage&&ABINE_DNTME.require(["abine/blurstore-api"],e.bind(function(e){e.load(a.meta.name)},this)),s&&a.saveToLocalStorage()},saveToLocalStorage:function(t){var s=this,o=i.getUserId(),c=s.meta.name;o&&s.meta.encrypted&&(c+="."+o),this.index(null,function(o){var l=[];e.each(o,function(e){e._new=!1,e=e.toJSON(),s.meta.keepId||delete e.id,l.push(e)});var u=n.getItem(c),d=JSON.stringify(l),h=!1,f=i.getEncryptionKey();if(s.meta.encrypted)if(f){var p=r.encryptKey(f,d);p!=d&&(d="ENC_"+p)}else u&&u.indexOf("ENC_")!=-1&&(h=!0);h||n.setItem(c,d),a(s.meta.name),this.meta.syncStorage?ABINE_DNTME.require(["abine/blurstore-api"],e.bind(function(e){e.save(s.meta.name,f),t&&t()},this)):t&&t()})},updateCache:function(n,r){t.removeIndex(n),e.extend(n,r),t.addIndex(n)},removeFromSyncStore:function(t,n){n=n||function(){};var r=e.after(t.length,n);ABINE_DNTME.require(["abine/blurstore-api"],e.bind(function(n){e.each(t,function(e){n["delete"](e.name,e.id),r()})},this))}};return t.flushHooks.push(function(n,r,i){var a=t.trackedObjects,s=[],o=[],c={};for(var l in a)if(a.hasOwnProperty(l)){if(t.objectsToRemove.hasOwnProperty(l))continue;var u=a[l],d=t.define(u._type),h=d.meta.name in c;if(h){u._notInLocalStorage&&delete u._notInLocalStorage,u._dirtyProperties={};continue}var f=!1;if(d.meta.localStorage){if(u._notInLocalStorage)f=!0,delete u._notInLocalStorage;else{for(var p in u._dirtyProperties)if(u._dirtyProperties.hasOwnProperty(p)){f=!0;break}u._dirtyProperties={}}f&&(c[d.meta.name]=!0,s.push(d))}}for(var l in t.objectsToRemove)if(t.objectsToRemove.hasOwnProperty(l)){var u=t.objectsToRemove[l],d=t.define(u._type);d.meta.syncStorage&&o.push({name:d.meta.name,id:l}),d.meta.localStorage&&(d.meta.name in c||(c[d.meta.name]=!0,s.push(d))),delete t.objectsToRemove[l];try{delete a[l]}catch(e){}}i(),e.each(s,function(e){e.saveToLocalStorage()}),o.length>0&&d.removeFromSyncStore(o)}),{DefaultActions:s}}),ABINE_DNTME.define("abine/storageRouter",["documentcloud/underscore","persistence","abine/core","abine/fixtures","abine/backgroundMessenger"],function(e,t,n,r,i){var a={dbName:"idme_data",dbDescription:"Storage for the dntme extension",dbSizeInBytes:5242880},s=/:([\w\d]+)/g,o=/\*([\w\d]+)/g,c=/[-[\]{}()+?.,\\^$|#\s]/g,l=n.BaseClass.extend({initialize:function(t){t=t||{};var n=this,r=t.ready||function(){};this.routes=[],this.storage={},e.defaults(t,a),this.messenger=t.messenger||new i.BackgroundMessenger,l.initialized?(n.startListener(),r.call()):(t.ready=function(){n.startListener(),r.call()},l.initializeWebSQLStorage(t))},initializeMemoryStorage:function(e){t.store.memory.config(t),e.call(this)},startListener:function(){this.messenger.on("all",this.messageHandler,this)},registerEntity:function(t,n){this.storage[n]=t,e(t.routes).each(function(t,r){if(!t||!r)throw"Bad routes on entity "+n;if(e.isRegExp(r)||(r=r.replace(c,"\\$&").replace(s,"([^/]*)").replace(o,"(.*?)"),r=new RegExp("^"+r+"$","i")),!r)throw"Bad route for "+t;this.routes.push([r,n,t])},this)},messageHandler:function(t,n,r){var i=t.split(":")[0];if(e(["create","read","update","delete","search"]).include(i)){var a=t.replace(/\:/g,"/");a=a.replace(/\/\//g,":");var s=e(this.routes).find(function(e){return a.match(e[0])}),o=this.storage[s[1]],c=s[2],l=s[0].exec(a).slice(1),d=new u({entityName:s[1],route:t,payload:n,sender:r,params:l,messenger:this.messenger});return o[c].call(o,d),d}},send:function(){return this.messageHandler.apply(this,arguments)}});l.initializeWebSQLStorage=function(e){var n=e.ready||function(){};return l.initialized?void n():(t.store.memory.config(t,e.dbName,e.dbDescription,e.dbSizeInBytes),l.initialized=!0,void(e.fixtures?r.createFixtures(function(){n()}):n()))};var u=n.BaseClass.extend({initialize:function(e){e=e||{},this.route=e.route,this.params=e.params,this.entityName=e.entityName,this.sender=e.sender||"background",this.messenger=e.messenger,this.payload=e.payload},getReturnRoute:function(){var e=this.route.split(":");return e[0]="response",e.join(":")},getReturnErrorRoute:function(){var e=this.route.split(":");return e[0]="error",e.join(":")},returnErrObj:function(e){return e=e||{},this.messenger.send(this.getReturnErrorRoute(this.route),e,this.sender),!0},returnError:function(e,t){t=t||500,e=e||"Server error";var n={error:!0,message:e,status:t};return this.messenger.send(this.getReturnErrorRoute(this.route),n,this.sender),!0},returnStatus:function(e){var t={status:e};return this.messenger.send(this.getReturnRoute(this.route),t,this.sender),!0},returnEntities:function(t){var n;t&&0!=t.length?e.isArray(t)&&1==t.length?n=t[0].toJSON():e.isArray(t)&&t.length>1?n=e(t).map(function(e){return e.toJSON()}):e.isObject(t)&&(n=t.toJSON()):n=[],this.messenger.send(this.getReturnRoute(this.route),n,this.sender)},returnJSON:function(e){this.messenger.send(this.getReturnRoute(this.route),e,this.sender)}});return{StorageRouter:l,StorageRequest:u}}),ABINE_DNTME.define("abine/pushNotifications",["documentcloud/underscore","abine/core","storage","abine/timer","abine/securityManager","abine/ajax","modules","abine/crypto"],function(e,t,n,r,i,a,s,o){function c(){var t=function(){var t=ABINE_DNTME.Socket;t||(t=io),this.socket=t.connect(ABINE_DNTME.config.pushNotificationUrl,{query:"authToken="+i.getAuthToken()+"&env="+ABINE_DNTME.config.environment,multiplex:!1,reconnection:!0,reconnectionDelay:1e4,reconnectionDelayMax:6e4,reconnectionAttempts:5,transports:m}),this.socket.myId=b,this.socket.on("connect",function(){g=0}),this.socket.on("connect_error",function(e){if("websocket error"==e.message){m=null,r.setTimeout(c,3e3);try{l()}catch(e){}}}),this.socket.on("error",e.bind(this.error,this)),this.socket.on("reconnect_failed",e.bind(function(){l.call(this),u.call(this)},this)),this.socket.on("logout",e.bind(this.logout,this)),this.socket.on("sync",e.bind(this.sync,this)),this.socket.on("mfaChanged",e.bind(this.mfaChanged,this)),this.socket.on("storeChanged",e.bind(this.storeChanged,this)),this.socket.on("biometricAuthResponse",e.bind(this.biometricAuthResponse,this)),this.socket.on("notify",e.bind(this.notify,this)),this.socket.on("growl",e.bind(this.growl,this))};p?(p=!1,r.setTimeout(e.bind(t,this),0)):a.ajax({url:ABINE_DNTME.config.pushNotificationUrl+"/ping",xhrFields:{withCredentials:!0},success:e.bind(t,this),error:e.bind(u,this)})}function l(){if(this.socket){try{this.socket.disconnect()}catch(e){}this.socket.off("connect"),this.socket.off("connect_error"),this.socket.off("error"),this.socket.off("reconnect_failed"),this.socket.off("logout"),this.socket.off("sync"),this.socket.off("mfaChanged"),this.socket.off("storeChanged"),this.socket.off("biometricAuthResponse"),this.socket.off("notify"),this.socket.off("growl"),this.socket=null}}function u(){g++>6&&(g=4);var t=Math.pow(2,g)*y+Math.round(Math.random()*y);r.clearTimeout(h),h=r.setTimeout(e.bind(c,this),t)}function d(e,t){ABINE_DNTME.backgroundMessenger.sendToWebapp(e,t)}var h,f=null,p=!0,m=["websocket"],g=0,y=1e3,b=Math.floor(1e7*Math.random()),v=t.BaseClass.extend({connect:function(){this.socket?this.socket.connect():c.call(this)},disconnect:function(){this.socket&&l.call(this)},error:function(e){g=0,"not authorized"==e&&i.logout()},logout:function(){i.logout(),d("websocket:push",{event:"logout",payload:null})},sync:function(e){ABINE_DNTME.require(["abine/blurstore-api"],function(t){t.synchronizeWhenOld(e)}),d("websocket:push",{event:"sync",payload:e})},mfaChanged:function(){i.refreshData(),d("websocket:push",{event:"mfaChanged",payload:null})},storeChanged:function(e){i.refreshData(),d("websocket:push",{event:"storeChanged",payload:e})},pushSync:function(e){s.licenseModule.pushSync(e),this.socket&&this.socket.emit("broadcast",{event:"sync",payload:e})},emit:function(e,t){this.socket&&this.socket.emit("broadcast",{event:e,payload:t})},biometricAuthResponse:function(e){if(f){if(f(e),e&&(e.ack||e.error&&e.error.match(/locked/i)))return;f=null}else d("websocket:push",{event:"biometricAuthResponse",payload:e})},biometricAuthCancel:function(){f=null},requestBiometricAuth:function(e,t,n,i,a,c,l){var u=this;if(r.clearTimeout(this.biometricTimer),f)try{f({success:!1})}catch(e){}f=l;var d={event:"biometricAuth",payload:{type:e,biometricKey:t,amount:i,number:a,account:c,sender:b,domain:n,domain_hash:o.sha1("abine"+n).toString()}};s.licenseModule.createBiometricAuthRequest(d,function(e){function t(e){s.licenseModule.getBiometricAuthResponse(null,function(n){n.status?(u.biometricAuthResponse({success:"success"==n.status,token:n.token,error:n.status}),n.status&&n.status.match(/locked/i)&&(u.biometricTimer=r.setTimeout(function(){t(e-1)},5e3))):e>0?u.biometricTimer=r.setTimeout(function(){t(e-1)},5e3):u.biometricAuthResponse({success:!1,error:"No response from mobile device"})})}e.success?(u.biometricAuthResponse({ack:!0}),t(20)):u.biometricAuthResponse(e)})},growl:function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}e.name&&e.name.match(/card-declined/)&&n.DisposableCard.findOrFetchCard(e.guid,function(t){if(t&&"dnt-panel"==t.source&&t.active){var n={msg:"",targetUrl:ABINE_DNTME.config.protocol+ABINE_DNTME.config.webAppHost+"/#/cards",targetId:"",model:{maskedCard:t.toJSON(),declined:e},height:260,type:"card",neverFade:!0,locked:i.isLocked()};i.messenger.broadcastToAllTabs("background:show:notification:"+t.domain,n)}}),d("websocket:push",{event:"growl",payload:data})},notify:function(e){if(e=JSON.parse(e),"expiration_warning"==e){var t={type:"expire_warning",neverFade:!0,panelWidth:320,locked:i.isLocked()};i.messenger.send("background:show:notification",t)}else if("expiration_notification"==e){var t={type:"expire_notify",neverFade:!0,panelWidth:320,locked:i.isLocked()};i.messenger.send("background:show:notification",t)}d("websocket:push",{event:"notify",payload:e})},getId:function(){return b}});return new v}),ABINE_DNTME.define("abine/stubs",["documentcloud/underscore","abine/core"],function(){function e(e){n=e,e.on("contentManager:proxy:connect",function(e,t){n.send("background:stub:response:"+e.id,t,t)}),e.on("contentManager:proxy:call",function(e,t){ABINE_DNTME.require([e.require],function(r){var i=e.callId,a=r[e.method].apply(r,e.params);n.send("background:stub:response:"+i,a,t)})}),e.on("contentManager:proxy:callAsync",function(e,t){ABINE_DNTME.require([e.require],function(r){var i=e.callId,a=function(e,r){n.send("background:stub:response:"+i,{err:e,data:r},t)};e.params=e.params||[],e.params.push(a),r[e.method].apply(r,e.params)})})}function t(){n&&(n.off("contentManager:proxy:connect"),n.off("contentManager:proxy:call"),n.off("contentManager:proxy:callAsync"),n=null)}var n;return{start:e,stop:t}}),ABINE_DNTME.define("abine/webapp",["documentcloud/underscore","abine/core","storage","abine/securityManager","abine/window"],function(e,t,n,r,i){function a(e,t,i){n.Preference.findBy("key","mergedMigrationPending",function(n){n&&n.isTrue()?r.openPage("/#/migrate"):r.openPage(e,t,i)})}function s(e){a("/#/client/home",e)}function o(){a("/#/client/dashboard/guide")}function c(e){a("/#/client/dashboard",!1,e)}function l(){a("/#/client/emails")}function u(e){a(e?"/#/client/accounts/"+e+"/1":"/#/client/accounts")}function d(){a("/#/client/wallet")}function h(){a("/#/client/masking")}function f(e){e=e||"",a("/#/client/help"+e)}function p(){a("/#/forgot")}function m(e,t){e=e||"",t=t||"";var n="/#/help/faq/"+e;t&&(n=n+"/"+t),a(n)}function g(){a("/#/client/emailsin30")}function y(){ABINE_DNTME.maskme_installed?r.openLink({type:"dntReport"}):a("/#/client/stats")}function b(){a("/#/client/understandingTracking")}function v(){n.Preference.findBy("key","cardsEarned",function(e){a(e?"/#/client/cashforcards/signup/"+e.value:"/#/client/cashforcards/signup")})}function _(){n.Preference.findBy("key","cardsEarned",function(e){a(e?"/#/client/cashforcards/faq/"+e.value:"/#/client/cashforcards/faq")})}function w(){n.Preference.findBy("key","authToken",function(e){e&&e.value&&e.value.length>0?c():y()})}function k(){n.Preference.batchFindBy([{by:"key",value:"authToken"},{by:"key",value:"entitledToPhone"}],function(e){var t=e.authToken&&""!=e.authToken.value,r=e.entitledToPhone;t?!r||r.isFalse()?a("/#/client/premium"):n.ShieldedPhone.index(null,function(e){a(e&&e.length>0&&!e[0].isValidated()?"/#/client/verifyPhone":"/#/client/phones")}):a("/#/client/premium")})}function E(e,t,r){e=e?"/link/"+e:"",t=t||"",n.Preference.batchFindBy([{by:"key",value:"authToken"},{by:"key",value:"entitledToPhone"}],function(n){var i=n.authToken&&""!=n.authToken.value,s=n.entitledToPhone;i?!s||s.isFalse()?a("/#"+e+"/client/premium/"+t,r):a("/#/client/settings"):a("/#"+e+"/client/premium/"+t,r)})}function A(e,t){a("/?pk_campaign="+e+"#"+t)}function T(){a("/#/client/featureAdded")}function S(e,t){e=e||"",n.Preference.batchFindBy([{by:"key",value:"authToken"},{by:"key",value:"entitledToPhone"}],function(n){var r=n.authToken&&""!=n.authToken.value,i=n.entitledToPhone;r?!i||i.isFalse()?a("/#/client/holiday/"+e,t):a("/#/client/settings"):a("/#/client/holiday/"+e,t)})}function N(e){n.ShieldedCard.index(null,function(t){n.Preference.batchFindBy([{by:"key",value:"authToken"},{by:"key",value:"entitledToPayments"},{by:"key",value:"hasEnabledPayments"}],function(n){var r=n.authToken&&""!=n.authToken.value,i=n.entitledToPayments;r?!i||i.isFalse()?a("/#/client/premium",e):t.length>0?a("/#/client/cards",e):a("/#/client/premium/setup/dashboard",e):a("/#/client/premium",e)})})}function C(){a("/#/client/settings")}function I(e){e=e||"",a("/#/client/login/"+e)}function M(){a("/#/dnt2upgrade")}function D(e){e=e||"",a("/#/client/setupPassword/"+e)}function x(){C()}function O(){a("/#/client/weeklyReport")}function P(){a("/#/mobilePrivacy")}function B(){i.reloadTab({doNotActivate:!0,doNotOpenNewTab:!0,url:ABINE_DNTME.config.protocol+ABINE_DNTME.config.webAppHost})}return{reload:B,openHome:s,openDashboard:c,openWallet:d,openMasking:h,openEmails:l,openStats:y,openUnderstandingTracking:b,openCards:N,openPhones:k,openLogin:I,openNewFeatureAdded:T,openSnowman:S,openPremium:E,openBlacklist:x,openSettings:C,openPasswordSetup:D,openPiwikCampaign:A,openHelp:f,openForgotPassword:p,openFAQ:m,openDashboardOrStats:w,openDnt2UpgradePage:M,openMaskedEmailsIn30:g,openPage:a,openWeeklyReport:O,openDntAnywhere:P,openCashForCardsFaq:_,openCashForCardsSignup:v,openTour:o,openAccounts:u}}),ABINE_DNTME.define("blueimp-md5",function(){return function(e){var t,n=[];for(n[(e.length>>2)-1]=void 0,t=0;t<n.length;t+=1)n[t]=0;for(t=0;t<8*e.length;t+=8)n[t>>5]|=e.charCodeAt(t/8)<<t%32;return MD5(n,e.length)}}),/*
 * JavaScript MD5 1.0.1
 * https://github.com/blueimp/JavaScript-MD5
 *
 * Copyright 2011, Sebastian Tschan
 * https://blueimp.net
 *
 * Licensed under the MIT license:
 * http://www.opensource.org/licenses/MIT
 *
 * Based on
 * A JavaScript implementation of the RSA Data Security, Inc. MD5 Message
 * Digest Algorithm, as defined in RFC 1321.
 * Version 2.2 Copyright (C) Paul Johnston 1999 - 2009
 * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet
 * Distributed under the BSD License
 * See http://pajhome.org.uk/crypt/md5 for more info.
 */
function(e){"use strict";function t(e,t){var n=(65535&e)+(65535&t),r=(e>>16)+(t>>16)+(n>>16);return r<<16|65535&n}function n(e,t){return e<<t|e>>>32-t}function r(e,r,i,a,s,o){return t(n(t(t(r,e),t(a,o)),s),i)}function i(e,t,n,i,a,s,o){return r(t&n|~t&i,e,t,a,s,o)}function a(e,t,n,i,a,s,o){return r(t&i|n&~i,e,t,a,s,o)}function s(e,t,n,i,a,s,o){return r(t^n^i,e,t,a,s,o)}function o(e,t,n,i,a,s,o){return r(n^(t|~i),e,t,a,s,o)}function c(e,n){e[n>>5]|=128<<n%32,e[(n+64>>>9<<4)+14]=n;var r,c,l,u,d,h=1732584193,f=-271733879,p=-1732584194,m=271733878;for(r=0;r<e.length;r+=16)c=h,l=f,u=p,d=m,h=i(h,f,p,m,e[r],7,-680876936),m=i(m,h,f,p,e[r+1],12,-389564586),p=i(p,m,h,f,e[r+2],17,606105819),f=i(f,p,m,h,e[r+3],22,-1044525330),h=i(h,f,p,m,e[r+4],7,-176418897),m=i(m,h,f,p,e[r+5],12,1200080426),p=i(p,m,h,f,e[r+6],17,-1473231341),f=i(f,p,m,h,e[r+7],22,-45705983),h=i(h,f,p,m,e[r+8],7,1770035416),m=i(m,h,f,p,e[r+9],12,-1958414417),p=i(p,m,h,f,e[r+10],17,-42063),f=i(f,p,m,h,e[r+11],22,-1990404162),h=i(h,f,p,m,e[r+12],7,1804603682),m=i(m,h,f,p,e[r+13],12,-40341101),p=i(p,m,h,f,e[r+14],17,-1502002290),f=i(f,p,m,h,e[r+15],22,1236535329),h=a(h,f,p,m,e[r+1],5,-165796510),m=a(m,h,f,p,e[r+6],9,-1069501632),p=a(p,m,h,f,e[r+11],14,643717713),f=a(f,p,m,h,e[r],20,-373897302),h=a(h,f,p,m,e[r+5],5,-701558691),m=a(m,h,f,p,e[r+10],9,38016083),p=a(p,m,h,f,e[r+15],14,-660478335),f=a(f,p,m,h,e[r+4],20,-405537848),h=a(h,f,p,m,e[r+9],5,568446438),m=a(m,h,f,p,e[r+14],9,-1019803690),p=a(p,m,h,f,e[r+3],14,-187363961),f=a(f,p,m,h,e[r+8],20,1163531501),h=a(h,f,p,m,e[r+13],5,-1444681467),m=a(m,h,f,p,e[r+2],9,-51403784),p=a(p,m,h,f,e[r+7],14,1735328473),f=a(f,p,m,h,e[r+12],20,-1926607734),h=s(h,f,p,m,e[r+5],4,-378558),m=s(m,h,f,p,e[r+8],11,-2022574463),p=s(p,m,h,f,e[r+11],16,1839030562),f=s(f,p,m,h,e[r+14],23,-35309556),h=s(h,f,p,m,e[r+1],4,-1530992060),m=s(m,h,f,p,e[r+4],11,1272893353),p=s(p,m,h,f,e[r+7],16,-155497632),f=s(f,p,m,h,e[r+10],23,-1094730640),h=s(h,f,p,m,e[r+13],4,681279174),m=s(m,h,f,p,e[r],11,-358537222),p=s(p,m,h,f,e[r+3],16,-722521979),f=s(f,p,m,h,e[r+6],23,76029189),h=s(h,f,p,m,e[r+9],4,-640364487),m=s(m,h,f,p,e[r+12],11,-421815835),p=s(p,m,h,f,e[r+15],16,530742520),f=s(f,p,m,h,e[r+2],23,-995338651),h=o(h,f,p,m,e[r],6,-198630844),m=o(m,h,f,p,e[r+7],10,1126891415),p=o(p,m,h,f,e[r+14],15,-1416354905),f=o(f,p,m,h,e[r+5],21,-57434055),h=o(h,f,p,m,e[r+12],6,1700485571),m=o(m,h,f,p,e[r+3],10,-1894986606),p=o(p,m,h,f,e[r+10],15,-1051523),f=o(f,p,m,h,e[r+1],21,-2054922799),h=o(h,f,p,m,e[r+8],6,1873313359),m=o(m,h,f,p,e[r+15],10,-30611744),p=o(p,m,h,f,e[r+6],15,-1560198380),f=o(f,p,m,h,e[r+13],21,1309151649),h=o(h,f,p,m,e[r+4],6,-145523070),m=o(m,h,f,p,e[r+11],10,-1120210379),p=o(p,m,h,f,e[r+2],15,718787259),f=o(f,p,m,h,e[r+9],21,-343485551),h=t(h,c),f=t(f,l),p=t(p,u),m=t(m,d);return[h,f,p,m]}function l(e){var t,n="";for(t=0;t<32*e.length;t+=8)n+=String.fromCharCode(e[t>>5]>>>t%32&255);return n}function u(e){var t,n,r="0123456789abcdef",i="";for(n=0;n<e.length;n+=1)t=e.charCodeAt(n),i+=r.charAt(t>>>4&15)+r.charAt(15&t);return i}e.MD5=function(e,t){return u(l(c(e,8*t)))}}(this),ABINE_DNTME.define("asmCrypto",function(){var e,t;/*! asmCrypto, (c) 2013 Artem S Vybornov, opensource.org/licenses/MIT */
return!function(n,r){function i(){var e=Error.apply(this,arguments);this.message=e.message,this.stack=e.stack}function a(){var e=Error.apply(this,arguments);this.message=e.message,this.stack=e.stack}function s(){var e=Error.apply(this,arguments);this.message=e.message,this.stack=e.stack}function o(e,t){t=!!t;for(var n=e.length,r=new Uint8Array(t?4*n:n),i=0,a=0;n>i;i++){var s=e.charCodeAt(i);if(t&&s>=55296&&56319>=s){if(++i>=n)throw new Error("Malformed string, low surrogate expected at position "+i);s=(55296^s)<<10|65536|56320^e.charCodeAt(i)}else if(!t&&s>>>8)throw new Error("Wide characters are not allowed.");!t||127>=s?r[a++]=s:2047>=s?(r[a++]=192|s>>6,r[a++]=128|63&s):65535>=s?(r[a++]=224|s>>12,r[a++]=128|s>>6&63,r[a++]=128|63&s):(r[a++]=240|s>>18,r[a++]=128|s>>12&63,r[a++]=128|s>>6&63,r[a++]=128|63&s)}return r.subarray(0,a)}function c(e){var t=e.length;1&t&&(e="0"+e,t++);for(var n=new Uint8Array(t>>1),r=0;t>r;r+=2)n[r>>1]=parseInt(e.substr(r,2),16);return n}function l(e){return o(atob(e))}function u(e,t){t=!!t;for(var n=e.length,r=new Array(n),i=0,a=0;n>i;i++){var s=e[i];if(!t||128>s)r[a++]=s;else if(s>=192&&224>s&&n>i+1)r[a++]=(31&s)<<6|63&e[++i];else if(s>=224&&240>s&&n>i+2)r[a++]=(15&s)<<12|(63&e[++i])<<6|63&e[++i];else{if(!(s>=240&&248>s&&n>i+3))throw new Error("Malformed UTF8 character at byte offset "+i);var o=(7&s)<<18|(63&e[++i])<<12|(63&e[++i])<<6|63&e[++i];65535>=o?r[a++]=o:(o^=65536,r[a++]=55296|o>>10,r[a++]=56320|1023&o)}}for(var c="",l=16384,i=0;a>i;i+=l)c+=String.fromCharCode.apply(String,r.slice(i,a>=i+l?i+l:a));return c}function d(e){for(var t="",n=0;n<e.length;n++){var r=(255&e[n]).toString(16);r.length<2&&(t+="0"),t+=r}return t}function h(e){return btoa(u(e))}function f(e){return e-=1,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e+=1}function p(e){return"number"==typeof e}function m(e){return"string"==typeof e}function g(e){return e instanceof ArrayBuffer}function y(e){return e instanceof Uint8Array}function b(e){return e instanceof Int8Array||e instanceof Uint8Array||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array}function v(e,t){var n=t.heap,r=n?n.byteLength:t.heapSize||65536;if(4095&r||0>=r)throw new Error("heap size must be a positive integer and a multiple of 4096");return n=n||new e(new ArrayBuffer(r))}function _(e,t,n,r,i){var a=e.length-t,s=i>a?a:i;return e.set(n.subarray(r,r+s),t),s}function w(e){e=e||{},this.heap=v(Uint8Array,e).subarray(Qt.HEAP_DATA),this.asm=e.asm||Qt(r,null,this.heap.buffer),this.mode=null,this.key=null,this.reset(e)}function k(e){if(void 0!==e){if(g(e)||y(e))e=new Uint8Array(e);else{if(!m(e))throw new TypeError("unexpected key type");e=o(e)}var t=e.length;if(16!==t&&24!==t&&32!==t)throw new a("illegal key size");var n=new DataView(e.buffer,e.byteOffset,e.byteLength);this.asm.set_key(t>>2,n.getUint32(0),n.getUint32(4),n.getUint32(8),n.getUint32(12),t>16?n.getUint32(16):0,t>16?n.getUint32(20):0,t>24?n.getUint32(24):0,t>24?n.getUint32(28):0),this.key=e}else if(!this.key)throw new Error("key is required")}function E(e){if(void 0!==e){if(g(e)||y(e))e=new Uint8Array(e);else{if(!m(e))throw new TypeError("unexpected iv type");e=o(e)}if(16!==e.length)throw new a("illegal iv size");var t=new DataView(e.buffer,e.byteOffset,e.byteLength);this.iv=e,this.asm.set_iv(t.getUint32(0),t.getUint32(4),t.getUint32(8),t.getUint32(12))}else this.iv=null,this.asm.set_iv(0,0,0,0)}function A(e){void 0!==e?this.padding=!!e:this.padding=!0}function T(e){return e=e||{},this.result=null,this.pos=0,this.len=0,k.call(this,e.key),this.hasOwnProperty("iv")&&E.call(this,e.iv),this.hasOwnProperty("padding")&&A.call(this,e.padding),this}function S(e){if(m(e)&&(e=o(e)),g(e)&&(e=new Uint8Array(e)),!y(e))throw new TypeError("data isn't of expected type");for(var t=this.asm,n=this.heap,r=Qt.ENC[this.mode],i=Qt.HEAP_DATA,a=this.pos,s=this.len,c=0,l=e.length||0,u=0,d=s+l&-16,h=0,f=new Uint8Array(d);l>0;)h=_(n,a+s,e,c,l),s+=h,c+=h,l-=h,h=t.cipher(r,i+a,s),h&&f.set(n.subarray(a,a+h),u),u+=h,s>h?(a+=h,s-=h):(a=0,s=0);return this.result=f,this.pos=a,this.len=s,this}function N(e){var t=null,n=0;void 0!==e&&(t=S.call(this,e).result,n=t.length);var r=this.asm,i=this.heap,s=Qt.ENC[this.mode],o=Qt.HEAP_DATA,c=this.pos,l=this.len,u=16-l%16,d=l;if(this.hasOwnProperty("padding")){if(this.padding){for(var h=0;u>h;++h)i[c+l+h]=u;l+=u,d=l}else if(l%16)throw new a("data length must be a multiple of the block size")}else l+=u;var f=new Uint8Array(n+d);return n&&f.set(t),l&&r.cipher(s,o+c,l),d&&f.set(i.subarray(c,c+d),n),this.result=f,this.pos=0,this.len=0,this}function C(e){if(m(e)&&(e=o(e)),g(e)&&(e=new Uint8Array(e)),!y(e))throw new TypeError("data isn't of expected type");var t=this.asm,n=this.heap,r=Qt.DEC[this.mode],i=Qt.HEAP_DATA,a=this.pos,s=this.len,c=0,l=e.length||0,u=0,d=s+l&-16,h=0,f=0;this.hasOwnProperty("padding")&&this.padding&&(h=s+l-d||16,d-=h);for(var p=new Uint8Array(d);l>0;)f=_(n,a+s,e,c,l),s+=f,c+=f,l-=f,f=t.cipher(r,i+a,s-(l?0:h)),f&&p.set(n.subarray(a,a+f),u),u+=f,s>f?(a+=f,s-=f):(a=0,s=0);return this.result=p,this.pos=a,this.len=s,this}function I(e){var t=null,n=0;void 0!==e&&(t=C.call(this,e).result,n=t.length);var r=this.asm,i=this.heap,o=Qt.DEC[this.mode],c=Qt.HEAP_DATA,l=this.pos,u=this.len,d=u;if(u>0){if(u%16){if(this.hasOwnProperty("padding"))throw new a("data length must be a multiple of the block size");u+=16-u%16}if(r.cipher(o,c+l,u),this.hasOwnProperty("padding")&&this.padding){var h=i[l+d-1];if(1>h||h>16||h>d)throw new s("bad padding");for(var f=0,p=h;p>1;p--)f|=h^i[l+d-p];if(f)throw new s("bad padding");d-=h}}var m=new Uint8Array(n+d);return n>0&&m.set(t),d>0&&m.set(i.subarray(l,l+d),n),this.result=m,this.pos=0,this.len=0,this}function M(e){this.padding=!0,this.iv=null,w.call(this,e),this.mode="CBC"}function D(e){M.call(this,e)}function x(e){M.call(this,e)}function O(e){this.nonce=null,this.counter=0,this.counterSize=0,w.call(this,e),this.mode="CTR"}function P(e){O.call(this,e)}function B(e,t,n){if(void 0!==n){if(8>n||n>48)throw new a("illegal counter size");this.counterSize=n;var r=Math.pow(2,n)-1;this.asm.set_mask(0,0,r/4294967296|0,0|r)}else this.counterSize=n=48,this.asm.set_mask(0,0,65535,4294967295);if(void 0===e)throw new Error("nonce is required");if(g(e)||y(e))e=new Uint8Array(e);else{if(!m(e))throw new TypeError("unexpected nonce type");e=o(e)}var i=e.length;if(!i||i>16)throw new a("illegal nonce size");this.nonce=e;var s=new DataView(new ArrayBuffer(16));if(new Uint8Array(s.buffer).set(e),this.asm.set_nonce(s.getUint32(0),s.getUint32(4),s.getUint32(8),s.getUint32(12)),void 0!==t){if(!p(t))throw new TypeError("unexpected counter type");if(0>t||t>=Math.pow(2,n))throw new a("illegal counter value");this.counter=t,this.asm.set_counter(0,0,t/4294967296|0,0|t)}else this.counter=t=0}function R(e){return e=e||{},T.call(this,e),B.call(this,e.nonce,e.counter,e.counterSize),this}function L(e){for(var t=this.heap,n=this.asm,r=0,i=e.length||0,a=0;i>0;){for(a=_(t,0,e,r,i),r+=a,i-=a;15&a;)t[a++]=0;n.mac(Qt.MAC.GCM,Qt.HEAP_DATA,a)}}function F(e){this.nonce=null,this.adata=null,this.iv=null,this.counter=1,this.tagSize=16,w.call(this,e),this.mode="GCM"}function q(e){F.call(this,e)}function U(e){F.call(this,e)}function H(e){e=e||{},T.call(this,e);var t=this.asm,n=this.heap;t.gcm_init();var r=e.tagSize;if(void 0!==r){if(!p(r))throw new TypeError("tagSize must be a number");if(4>r||r>16)throw new a("illegal tagSize value");this.tagSize=r}else this.tagSize=16;var i=e.nonce;if(void 0===i)throw new Error("nonce is required");if(y(i)||g(i))i=new Uint8Array(i);else{if(!m(i))throw new TypeError("unexpected nonce type");i=o(i)}this.nonce=i;var s=i.length||0,c=new Uint8Array(16);12!==s?(L.call(this,i),n[0]=n[1]=n[2]=n[3]=n[4]=n[5]=n[6]=n[7]=n[8]=n[9]=n[10]=0,n[11]=s>>>29,n[12]=s>>>21&255,n[13]=s>>>13&255,n[14]=s>>>5&255,n[15]=s<<3&255,t.mac(Qt.MAC.GCM,Qt.HEAP_DATA,16),t.get_iv(Qt.HEAP_DATA),t.set_iv(),c.set(n.subarray(0,16))):(c.set(i),c[15]=1);var l=new DataView(c.buffer);this.gamma0=l.getUint32(12),t.set_nonce(l.getUint32(0),l.getUint32(4),l.getUint32(8),0),t.set_mask(0,0,0,4294967295);var u=e.adata;if(void 0!==u&&null!==u){if(y(u)||g(u))u=new Uint8Array(u);else{if(!m(u))throw new TypeError("unexpected adata type");u=o(u)}if(u.length>rn)throw new a("illegal adata length");u.length?(this.adata=u,L.call(this,u)):this.adata=null}else this.adata=null;var d=e.counter;if(void 0!==d){if(!p(d))throw new TypeError("counter must be a number");if(1>d||d>4294967295)throw new RangeError("counter must be a positive 32-bit integer");this.counter=d,t.set_counter(0,0,0,this.gamma0+d|0)}else this.counter=1,t.set_counter(0,0,0,this.gamma0+1|0);var h=e.iv;if(void 0!==h){if(!p(d))throw new TypeError("counter must be a number");this.iv=h,E.call(this,h)}return this}function j(e){if(m(e)&&(e=o(e)),g(e)&&(e=new Uint8Array(e)),!y(e))throw new TypeError("data isn't of expected type");var t=0,n=e.length||0,r=this.asm,i=this.heap,a=this.counter,s=this.pos,c=this.len,l=0,u=c+n&-16,d=0;if((a-1<<4)+c+n>rn)throw new RangeError("counter overflow");for(var h=new Uint8Array(u);n>0;)d=_(i,s+c,e,t,n),c+=d,t+=d,n-=d,d=r.cipher(Qt.ENC.CTR,Qt.HEAP_DATA+s,c),d=r.mac(Qt.MAC.GCM,Qt.HEAP_DATA+s,d),d&&h.set(i.subarray(s,s+d),l),a+=d>>>4,l+=d,c>d?(s+=d,c-=d):(s=0,c=0);return this.result=h,this.counter=a,this.pos=s,this.len=c,this}function J(){var e=this.asm,t=this.heap,n=this.counter,r=this.tagSize,i=this.adata,a=this.pos,s=this.len,o=new Uint8Array(s+r);e.cipher(Qt.ENC.CTR,Qt.HEAP_DATA+a,s+15&-16),s&&o.set(t.subarray(a,a+s));for(var c=s;15&c;c++)t[a+c]=0;e.mac(Qt.MAC.GCM,Qt.HEAP_DATA+a,c);var l=null!==i?i.length:0,u=(n-1<<4)+s;return t[0]=t[1]=t[2]=0,t[3]=l>>>29,t[4]=l>>>21,t[5]=l>>>13&255,t[6]=l>>>5&255,t[7]=l<<3&255,t[8]=t[9]=t[10]=0,t[11]=u>>>29,t[12]=u>>>21&255,t[13]=u>>>13&255,t[14]=u>>>5&255,t[15]=u<<3&255,e.mac(Qt.MAC.GCM,Qt.HEAP_DATA,16),e.get_iv(Qt.HEAP_DATA),e.set_counter(0,0,0,this.gamma0),e.cipher(Qt.ENC.CTR,Qt.HEAP_DATA,16),o.set(t.subarray(0,r),s),this.result=o,this.counter=1,this.pos=0,this.len=0,this}function G(e){var t=j.call(this,e).result,n=J.call(this).result,r=new Uint8Array(t.length+n.length);return t.length&&r.set(t),n.length&&r.set(n,t.length),this.result=r,this}function z(e){if(m(e)&&(e=o(e)),g(e)&&(e=new Uint8Array(e)),!y(e))throw new TypeError("data isn't of expected type");var t=0,n=e.length||0,r=this.asm,i=this.heap,a=this.counter,s=this.tagSize,c=this.pos,l=this.len,u=0,d=l+n>s?l+n-s&-16:0,h=l+n-d,f=0;if((a-1<<4)+l+n>rn)throw new RangeError("counter overflow");for(var p=new Uint8Array(d);n>h;)f=_(i,c+l,e,t,n-h),l+=f,t+=f,n-=f,f=r.mac(Qt.MAC.GCM,Qt.HEAP_DATA+c,f),f=r.cipher(Qt.DEC.CTR,Qt.HEAP_DATA+c,f),f&&p.set(i.subarray(c,c+f),u),a+=f>>>4,u+=f,c=0,l=0;return n>0&&(l+=_(i,0,e,t,n)),this.result=p,this.counter=a,this.pos=c,this.len=l,this}function W(){var e=this.asm,t=this.heap,n=this.tagSize,r=this.adata,a=this.counter,o=this.pos,c=this.len,l=c-n,u=0;if(n>c)throw new i("authentication tag not found");for(var d=new Uint8Array(l),h=new Uint8Array(t.subarray(o+l,o+c)),f=l;15&f;f++)t[o+f]=0;u=e.mac(Qt.MAC.GCM,Qt.HEAP_DATA+o,f),u=e.cipher(Qt.DEC.CTR,Qt.HEAP_DATA+o,f),l&&d.set(t.subarray(o,o+l));var p=null!==r?r.length:0,m=(a-1<<4)+c-n;t[0]=t[1]=t[2]=0,t[3]=p>>>29,t[4]=p>>>21,t[5]=p>>>13&255,t[6]=p>>>5&255,t[7]=p<<3&255,t[8]=t[9]=t[10]=0,t[11]=m>>>29,t[12]=m>>>21&255,t[13]=m>>>13&255,t[14]=m>>>5&255,t[15]=m<<3&255,e.mac(Qt.MAC.GCM,Qt.HEAP_DATA,16),e.get_iv(Qt.HEAP_DATA),e.set_counter(0,0,0,this.gamma0),e.cipher(Qt.ENC.CTR,Qt.HEAP_DATA,16);for(var g=0,f=0;n>f;++f)g|=h[f]^t[f];if(g)throw new s("data integrity check failed");return this.result=d,this.counter=1,this.pos=0,this.len=0,this}function V(e){var t=z.call(this,e).result,n=W.call(this).result,r=new Uint8Array(t.length+n.length);return t.length&&r.set(t),n.length&&r.set(n,t.length),this.result=r,this}function K(e,t,n,r){if(void 0===e)throw new SyntaxError("data required");if(void 0===t)throw new SyntaxError("key required");return new M({heap:cn,asm:ln,key:t,padding:n,iv:r}).encrypt(e).result}function X(e,t,n,r){if(void 0===e)throw new SyntaxError("data required");if(void 0===t)throw new SyntaxError("key required");return new M({heap:cn,asm:ln,key:t,padding:n,iv:r}).decrypt(e).result}function Z(e,t,n,r,i){if(void 0===e)throw new SyntaxError("data required");if(void 0===t)throw new SyntaxError("key required");if(void 0===n)throw new SyntaxError("nonce required");return new F({heap:cn,asm:ln,key:t,nonce:n,adata:r,tagSize:i}).encrypt(e).result}function Q(e,t,n,r,i){if(void 0===e)throw new SyntaxError("data required");if(void 0===t)throw new SyntaxError("key required");if(void 0===n)throw new SyntaxError("nonce required");return new F({heap:cn,asm:ln,key:t,nonce:n,adata:r,tagSize:i}).decrypt(e).result}function Y(){return this.result=null,this.pos=0,this.len=0,this.asm.reset(),this}function $(e){if(null!==this.result)throw new i("state must be reset before processing new data");if(m(e)&&(e=o(e)),g(e)&&(e=new Uint8Array(e)),!y(e))throw new TypeError("data isn't of expected type");for(var t=this.asm,n=this.heap,r=this.pos,a=this.len,s=0,c=e.length,l=0;c>0;)l=_(n,r+a,e,s,c),a+=l,s+=l,c-=l,l=t.process(r,a),r+=l,a-=l,a||(r=0);return this.pos=r,this.len=a,this}function ee(){if(null!==this.result)throw new i("state must be reset before processing new data");return this.asm.finish(this.pos,this.len,0),this.result=new Uint8Array(this.HASH_SIZE),this.result.set(this.heap.subarray(0,this.HASH_SIZE)),this.pos=0,this.len=0,this}function te(e,t,n){"use asm";var r=0,i=0,a=0,s=0,o=0,c=0,l=0;var u=0,d=0,h=0,f=0,p=0,m=0,g=0,y=0,b=0,v=0;var _=new e.Uint8Array(n);function w(e,t,n,c,l,u,d,h,f,p,m,g,y,b,v,_){e=e|0;t=t|0;n=n|0;c=c|0;l=l|0;u=u|0;d=d|0;h=h|0;f=f|0;p=p|0;m=m|0;g=g|0;y=y|0;b=b|0;v=v|0;_=_|0;var w=0,k=0,E=0,A=0,T=0,S=0,N=0,C=0,I=0,M=0,D=0,x=0,O=0,P=0,B=0,R=0,L=0,F=0,q=0,U=0,H=0,j=0,J=0,G=0,z=0,W=0,V=0,K=0,X=0,Z=0,Q=0,Y=0,$=0,ee=0,te=0,ne=0,re=0,ie=0,ae=0,se=0,oe=0,ce=0,le=0,ue=0,de=0,he=0,fe=0,pe=0,me=0,ge=0,ye=0,be=0,ve=0,_e=0,we=0,ke=0,Ee=0,Ae=0,Te=0,Se=0,Ne=0,Ce=0,Ie=0,Me=0,De=0,xe=0,Oe=0,Pe=0,Be=0,Re=0,Le=0;w=r;k=i;E=a;A=s;T=o;N=e+(w<<5|w>>>27)+T+(k&E|~k&A)+1518500249|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;N=t+(w<<5|w>>>27)+T+(k&E|~k&A)+1518500249|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;N=n+(w<<5|w>>>27)+T+(k&E|~k&A)+1518500249|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;N=c+(w<<5|w>>>27)+T+(k&E|~k&A)+1518500249|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;N=l+(w<<5|w>>>27)+T+(k&E|~k&A)+1518500249|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;N=u+(w<<5|w>>>27)+T+(k&E|~k&A)+1518500249|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;N=d+(w<<5|w>>>27)+T+(k&E|~k&A)+1518500249|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;N=h+(w<<5|w>>>27)+T+(k&E|~k&A)+1518500249|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;N=f+(w<<5|w>>>27)+T+(k&E|~k&A)+1518500249|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;N=p+(w<<5|w>>>27)+T+(k&E|~k&A)+1518500249|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;N=m+(w<<5|w>>>27)+T+(k&E|~k&A)+1518500249|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;N=g+(w<<5|w>>>27)+T+(k&E|~k&A)+1518500249|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;N=y+(w<<5|w>>>27)+T+(k&E|~k&A)+1518500249|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;N=b+(w<<5|w>>>27)+T+(k&E|~k&A)+1518500249|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;N=v+(w<<5|w>>>27)+T+(k&E|~k&A)+1518500249|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;N=_+(w<<5|w>>>27)+T+(k&E|~k&A)+1518500249|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=b^f^n^e;C=S<<1|S>>>31;N=C+(w<<5|w>>>27)+T+(k&E|~k&A)+1518500249|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=v^p^c^t;I=S<<1|S>>>31;N=I+(w<<5|w>>>27)+T+(k&E|~k&A)+1518500249|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=_^m^l^n;M=S<<1|S>>>31;N=M+(w<<5|w>>>27)+T+(k&E|~k&A)+1518500249|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=C^g^u^c;D=S<<1|S>>>31;N=D+(w<<5|w>>>27)+T+(k&E|~k&A)+1518500249|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=I^y^d^l;x=S<<1|S>>>31;N=x+(w<<5|w>>>27)+T+(k^E^A)+1859775393|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=M^b^h^u;O=S<<1|S>>>31;N=O+(w<<5|w>>>27)+T+(k^E^A)+1859775393|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=D^v^f^d;P=S<<1|S>>>31;N=P+(w<<5|w>>>27)+T+(k^E^A)+1859775393|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=x^_^p^h;B=S<<1|S>>>31;N=B+(w<<5|w>>>27)+T+(k^E^A)+1859775393|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=O^C^m^f;R=S<<1|S>>>31;N=R+(w<<5|w>>>27)+T+(k^E^A)+1859775393|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=P^I^g^p;L=S<<1|S>>>31;N=L+(w<<5|w>>>27)+T+(k^E^A)+1859775393|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=B^M^y^m;F=S<<1|S>>>31;N=F+(w<<5|w>>>27)+T+(k^E^A)+1859775393|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=R^D^b^g;q=S<<1|S>>>31;N=q+(w<<5|w>>>27)+T+(k^E^A)+1859775393|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=L^x^v^y;U=S<<1|S>>>31;N=U+(w<<5|w>>>27)+T+(k^E^A)+1859775393|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=F^O^_^b;H=S<<1|S>>>31;N=H+(w<<5|w>>>27)+T+(k^E^A)+1859775393|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=q^P^C^v;j=S<<1|S>>>31;N=j+(w<<5|w>>>27)+T+(k^E^A)+1859775393|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=U^B^I^_;J=S<<1|S>>>31;N=J+(w<<5|w>>>27)+T+(k^E^A)+1859775393|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=H^R^M^C;G=S<<1|S>>>31;N=G+(w<<5|w>>>27)+T+(k^E^A)+1859775393|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=j^L^D^I;z=S<<1|S>>>31;N=z+(w<<5|w>>>27)+T+(k^E^A)+1859775393|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=J^F^x^M;W=S<<1|S>>>31;N=W+(w<<5|w>>>27)+T+(k^E^A)+1859775393|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=G^q^O^D;V=S<<1|S>>>31;N=V+(w<<5|w>>>27)+T+(k^E^A)+1859775393|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=z^U^P^x;K=S<<1|S>>>31;N=K+(w<<5|w>>>27)+T+(k^E^A)+1859775393|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=W^H^B^O;X=S<<1|S>>>31;N=X+(w<<5|w>>>27)+T+(k^E^A)+1859775393|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=V^j^R^P;Z=S<<1|S>>>31;N=Z+(w<<5|w>>>27)+T+(k^E^A)+1859775393|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=K^J^L^B;Q=S<<1|S>>>31;N=Q+(w<<5|w>>>27)+T+(k^E^A)+1859775393|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=X^G^F^R;Y=S<<1|S>>>31;N=Y+(w<<5|w>>>27)+T+(k&E|k&A|E&A)-1894007588|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=Z^z^q^L;$=S<<1|S>>>31;N=$+(w<<5|w>>>27)+T+(k&E|k&A|E&A)-1894007588|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=Q^W^U^F;ee=S<<1|S>>>31;N=ee+(w<<5|w>>>27)+T+(k&E|k&A|E&A)-1894007588|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=Y^V^H^q;te=S<<1|S>>>31;N=te+(w<<5|w>>>27)+T+(k&E|k&A|E&A)-1894007588|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=$^K^j^U;ne=S<<1|S>>>31;N=ne+(w<<5|w>>>27)+T+(k&E|k&A|E&A)-1894007588|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=ee^X^J^H;re=S<<1|S>>>31;N=re+(w<<5|w>>>27)+T+(k&E|k&A|E&A)-1894007588|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=te^Z^G^j;ie=S<<1|S>>>31;N=ie+(w<<5|w>>>27)+T+(k&E|k&A|E&A)-1894007588|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=ne^Q^z^J;ae=S<<1|S>>>31;N=ae+(w<<5|w>>>27)+T+(k&E|k&A|E&A)-1894007588|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=re^Y^W^G;se=S<<1|S>>>31;N=se+(w<<5|w>>>27)+T+(k&E|k&A|E&A)-1894007588|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=ie^$^V^z;oe=S<<1|S>>>31;N=oe+(w<<5|w>>>27)+T+(k&E|k&A|E&A)-1894007588|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=ae^ee^K^W;ce=S<<1|S>>>31;N=ce+(w<<5|w>>>27)+T+(k&E|k&A|E&A)-1894007588|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=se^te^X^V;le=S<<1|S>>>31;N=le+(w<<5|w>>>27)+T+(k&E|k&A|E&A)-1894007588|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=oe^ne^Z^K;ue=S<<1|S>>>31;N=ue+(w<<5|w>>>27)+T+(k&E|k&A|E&A)-1894007588|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=ce^re^Q^X;de=S<<1|S>>>31;N=de+(w<<5|w>>>27)+T+(k&E|k&A|E&A)-1894007588|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=le^ie^Y^Z;he=S<<1|S>>>31;N=he+(w<<5|w>>>27)+T+(k&E|k&A|E&A)-1894007588|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=ue^ae^$^Q;fe=S<<1|S>>>31;N=fe+(w<<5|w>>>27)+T+(k&E|k&A|E&A)-1894007588|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=de^se^ee^Y;pe=S<<1|S>>>31;N=pe+(w<<5|w>>>27)+T+(k&E|k&A|E&A)-1894007588|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=he^oe^te^$;me=S<<1|S>>>31;N=me+(w<<5|w>>>27)+T+(k&E|k&A|E&A)-1894007588|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=fe^ce^ne^ee;ge=S<<1|S>>>31;N=ge+(w<<5|w>>>27)+T+(k&E|k&A|E&A)-1894007588|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=pe^le^re^te;ye=S<<1|S>>>31;N=ye+(w<<5|w>>>27)+T+(k&E|k&A|E&A)-1894007588|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=me^ue^ie^ne;be=S<<1|S>>>31;N=be+(w<<5|w>>>27)+T+(k^E^A)-899497514|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=ge^de^ae^re;ve=S<<1|S>>>31;N=ve+(w<<5|w>>>27)+T+(k^E^A)-899497514|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=ye^he^se^ie;_e=S<<1|S>>>31;N=_e+(w<<5|w>>>27)+T+(k^E^A)-899497514|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=be^fe^oe^ae;we=S<<1|S>>>31;N=we+(w<<5|w>>>27)+T+(k^E^A)-899497514|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=ve^pe^ce^se;ke=S<<1|S>>>31;N=ke+(w<<5|w>>>27)+T+(k^E^A)-899497514|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=_e^me^le^oe;Ee=S<<1|S>>>31;N=Ee+(w<<5|w>>>27)+T+(k^E^A)-899497514|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=we^ge^ue^ce;Ae=S<<1|S>>>31;N=Ae+(w<<5|w>>>27)+T+(k^E^A)-899497514|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=ke^ye^de^le;Te=S<<1|S>>>31;N=Te+(w<<5|w>>>27)+T+(k^E^A)-899497514|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=Ee^be^he^ue;Se=S<<1|S>>>31;N=Se+(w<<5|w>>>27)+T+(k^E^A)-899497514|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=Ae^ve^fe^de;Ne=S<<1|S>>>31;N=Ne+(w<<5|w>>>27)+T+(k^E^A)-899497514|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=Te^_e^pe^he;Ce=S<<1|S>>>31;N=Ce+(w<<5|w>>>27)+T+(k^E^A)-899497514|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=Se^we^me^fe;Ie=S<<1|S>>>31;N=Ie+(w<<5|w>>>27)+T+(k^E^A)-899497514|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=Ne^ke^ge^pe;Me=S<<1|S>>>31;N=Me+(w<<5|w>>>27)+T+(k^E^A)-899497514|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=Ce^Ee^ye^me;De=S<<1|S>>>31;N=De+(w<<5|w>>>27)+T+(k^E^A)-899497514|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=Ie^Ae^be^ge;xe=S<<1|S>>>31;N=xe+(w<<5|w>>>27)+T+(k^E^A)-899497514|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=Me^Te^ve^ye;Oe=S<<1|S>>>31;N=Oe+(w<<5|w>>>27)+T+(k^E^A)-899497514|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=De^Se^_e^be;Pe=S<<1|S>>>31;N=Pe+(w<<5|w>>>27)+T+(k^E^A)-899497514|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=xe^Ne^we^ve;Be=S<<1|S>>>31;N=Be+(w<<5|w>>>27)+T+(k^E^A)-899497514|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=Oe^Ce^ke^_e;Re=S<<1|S>>>31;N=Re+(w<<5|w>>>27)+T+(k^E^A)-899497514|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;S=Pe^Ie^Ee^we;Le=S<<1|S>>>31;N=Le+(w<<5|w>>>27)+T+(k^E^A)-899497514|0;T=A;A=E;E=k<<30|k>>>2;k=w;w=N;r=r+w|0;i=i+k|0;a=a+E|0;s=s+A|0;o=o+T|0}function k(e){e=e|0;w(_[e|0]<<24|_[e|1]<<16|_[e|2]<<8|_[e|3],_[e|4]<<24|_[e|5]<<16|_[e|6]<<8|_[e|7],_[e|8]<<24|_[e|9]<<16|_[e|10]<<8|_[e|11],_[e|12]<<24|_[e|13]<<16|_[e|14]<<8|_[e|15],_[e|16]<<24|_[e|17]<<16|_[e|18]<<8|_[e|19],_[e|20]<<24|_[e|21]<<16|_[e|22]<<8|_[e|23],_[e|24]<<24|_[e|25]<<16|_[e|26]<<8|_[e|27],_[e|28]<<24|_[e|29]<<16|_[e|30]<<8|_[e|31],_[e|32]<<24|_[e|33]<<16|_[e|34]<<8|_[e|35],_[e|36]<<24|_[e|37]<<16|_[e|38]<<8|_[e|39],_[e|40]<<24|_[e|41]<<16|_[e|42]<<8|_[e|43],_[e|44]<<24|_[e|45]<<16|_[e|46]<<8|_[e|47],_[e|48]<<24|_[e|49]<<16|_[e|50]<<8|_[e|51],_[e|52]<<24|_[e|53]<<16|_[e|54]<<8|_[e|55],_[e|56]<<24|_[e|57]<<16|_[e|58]<<8|_[e|59],_[e|60]<<24|_[e|61]<<16|_[e|62]<<8|_[e|63])}function E(e){e=e|0;_[e|0]=r>>>24;_[e|1]=r>>>16&255;_[e|2]=r>>>8&255;_[e|3]=r&255;_[e|4]=i>>>24;_[e|5]=i>>>16&255;_[e|6]=i>>>8&255;_[e|7]=i&255;_[e|8]=a>>>24;_[e|9]=a>>>16&255;_[e|10]=a>>>8&255;_[e|11]=a&255;_[e|12]=s>>>24;_[e|13]=s>>>16&255;_[e|14]=s>>>8&255;_[e|15]=s&255;_[e|16]=o>>>24;_[e|17]=o>>>16&255;_[e|18]=o>>>8&255;_[e|19]=o&255}function A(){r=1732584193;i=4023233417;a=2562383102;s=271733878;o=3285377520;c=l=0}function T(e,t,n,u,d,h,f){e=e|0;t=t|0;n=n|0;u=u|0;d=d|0;h=h|0;f=f|0;r=e;i=t;a=n;s=u;o=d;c=h;l=f}function S(e,t){e=e|0;t=t|0;var n=0;if(e&63)return-1;while((t|0)>=64){k(e);e=e+64|0;t=t-64|0;n=n+64|0}c=c+n|0;if(c>>>0<n>>>0)l=l+1|0;return n|0}function N(e,t,n){e=e|0;t=t|0;n=n|0;var r=0,i=0;if(e&63)return-1;if(~n)if(n&31)return-1;if((t|0)>=64){r=S(e,t)|0;if((r|0)==-1)return-1;e=e+r|0;t=t-r|0}r=r+t|0;c=c+t|0;if(c>>>0<t>>>0)l=l+1|0;_[e|t]=128;if((t|0)>=56){for(i=t+1|0;(i|0)<64;i=i+1|0)_[e|i]=0;k(e);t=0;_[e|0]=0}for(i=t+1|0;(i|0)<59;i=i+1|0)_[e|i]=0;_[e|56]=l>>>21&255;_[e|57]=l>>>13&255;_[e|58]=l>>>5&255;_[e|59]=l<<3&255|c>>>29;_[e|60]=c>>>21&255;_[e|61]=c>>>13&255;_[e|62]=c>>>5&255;_[e|63]=c<<3&255;k(e);if(~n)E(n);return r|0}function C(){r=u;i=d;a=h;s=f;o=p;c=64;l=0}function I(){r=m;i=g;a=y;s=b;o=v;c=64;l=0}function M(e,t,n,_,k,E,T,S,N,C,I,M,D,x,O,P){e=e|0;t=t|0;n=n|0;_=_|0;k=k|0;E=E|0;T=T|0;S=S|0;N=N|0;C=C|0;I=I|0;M=M|0;D=D|0;x=x|0;O=O|0;P=P|0;A();w(e^1549556828,t^1549556828,n^1549556828,_^1549556828,k^1549556828,E^1549556828,T^1549556828,S^1549556828,N^1549556828,C^1549556828,I^1549556828,M^1549556828,D^1549556828,x^1549556828,O^1549556828,P^1549556828);m=r;g=i;y=a;b=s;v=o;A();w(e^909522486,t^909522486,n^909522486,_^909522486,k^909522486,E^909522486,T^909522486,S^909522486,N^909522486,C^909522486,I^909522486,M^909522486,D^909522486,x^909522486,O^909522486,P^909522486);u=r;d=i;h=a;f=s;p=o;c=64;l=0}function D(e,t,n){e=e|0;t=t|0;n=n|0;var c=0,l=0,u=0,d=0,h=0,f=0;if(e&63)return-1;if(~n)if(n&31)return-1;f=N(e,t,-1)|0;c=r,l=i,u=a,d=s,h=o;I();w(c,l,u,d,h,2147483648,0,0,0,0,0,0,0,0,0,672);if(~n)E(n);return f|0}function x(e,t,n,c,l){e=e|0;t=t|0;n=n|0;c=c|0;l=l|0;var u=0,d=0,h=0,f=0,p=0,m=0,g=0,y=0,b=0,v=0;if(e&63)return-1;if(~l)if(l&31)return-1;_[e+t|0]=n>>>24;_[e+t+1|0]=n>>>16&255;_[e+t+2|0]=n>>>8&255;_[e+t+3|0]=n&255;D(e,t+4|0,-1)|0;u=m=r,d=g=i,h=y=a,f=b=s,p=v=o;c=c-1|0;while((c|0)>0){C();w(m,g,y,b,v,2147483648,0,0,0,0,0,0,0,0,0,672);m=r,g=i,y=a,b=s,v=o;I();w(m,g,y,b,v,2147483648,0,0,0,0,0,0,0,0,0,672);m=r,g=i,y=a,b=s,v=o;u=u^r;d=d^i;h=h^a;f=f^s;p=p^o;c=c-1|0}r=u;i=d;a=h;s=f;o=p;if(~l)E(l);return 0}return{reset:A,init:T,process:S,finish:N,hmac_reset:C,hmac_init:M,hmac_finish:D,pbkdf2_generate_block:x}}function ne(e){e=e||{},this.heap=v(Uint8Array,e),this.asm=e.asm||te(r,null,this.heap.buffer),this.BLOCK_SIZE=un,this.HASH_SIZE=dn,this.reset()}function re(){return null===fn&&(fn=new ne({heapSize:1048576})),fn}function ie(e){if(void 0===e)throw new SyntaxError("data required");return re().reset().process(e).finish().result}function ae(e){var t=ie(e);return d(t)}function se(e){var t=ie(e);return h(t)}function oe(e,t,n){"use asm";var r=0,i=0,a=0,s=0,o=0,c=0,l=0,u=0,d=0,h=0;var f=0,p=0,m=0,g=0,y=0,b=0,v=0,_=0,w=0,k=0,E=0,A=0,T=0,S=0,N=0,C=0;var I=new e.Uint8Array(n);function M(e,t,n,d,h,f,p,m,g,y,b,v,_,w,k,E){e=e|0;t=t|0;n=n|0;d=d|0;h=h|0;f=f|0;p=p|0;m=m|0;g=g|0;y=y|0;b=b|0;v=v|0;_=_|0;w=w|0;k=k|0;E=E|0;var A=0,T=0,S=0,N=0,C=0,I=0,M=0,D=0,x=0;A=r;T=i;S=a;N=s;C=o;I=c;M=l;D=u;x=e+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+1116352408|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;x=t+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+1899447441|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;x=n+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+3049323471|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;x=d+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+3921009573|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;x=h+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+961987163|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;x=f+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+1508970993|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;x=p+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+2453635748|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;x=m+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+2870763221|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;x=g+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+3624381080|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;x=y+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+310598401|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;x=b+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+607225278|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;x=v+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+1426881987|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;x=_+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+1925078388|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;x=w+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+2162078206|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;x=k+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+2614888103|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;x=E+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+3248222580|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;e=x=(t>>>7^t>>>18^t>>>3^t<<25^t<<14)+(k>>>17^k>>>19^k>>>10^k<<15^k<<13)+e+y|0;x=x+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+3835390401|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;t=x=(n>>>7^n>>>18^n>>>3^n<<25^n<<14)+(E>>>17^E>>>19^E>>>10^E<<15^E<<13)+t+b|0;x=x+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+4022224774|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;n=x=(d>>>7^d>>>18^d>>>3^d<<25^d<<14)+(e>>>17^e>>>19^e>>>10^e<<15^e<<13)+n+v|0;x=x+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+264347078|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;d=x=(h>>>7^h>>>18^h>>>3^h<<25^h<<14)+(t>>>17^t>>>19^t>>>10^t<<15^t<<13)+d+_|0;x=x+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+604807628|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;h=x=(f>>>7^f>>>18^f>>>3^f<<25^f<<14)+(n>>>17^n>>>19^n>>>10^n<<15^n<<13)+h+w|0;x=x+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+770255983|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;f=x=(p>>>7^p>>>18^p>>>3^p<<25^p<<14)+(d>>>17^d>>>19^d>>>10^d<<15^d<<13)+f+k|0;x=x+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+1249150122|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;p=x=(m>>>7^m>>>18^m>>>3^m<<25^m<<14)+(h>>>17^h>>>19^h>>>10^h<<15^h<<13)+p+E|0;x=x+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+1555081692|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;m=x=(g>>>7^g>>>18^g>>>3^g<<25^g<<14)+(f>>>17^f>>>19^f>>>10^f<<15^f<<13)+m+e|0;x=x+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+1996064986|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;g=x=(y>>>7^y>>>18^y>>>3^y<<25^y<<14)+(p>>>17^p>>>19^p>>>10^p<<15^p<<13)+g+t|0;x=x+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+2554220882|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;y=x=(b>>>7^b>>>18^b>>>3^b<<25^b<<14)+(m>>>17^m>>>19^m>>>10^m<<15^m<<13)+y+n|0;x=x+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+2821834349|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;b=x=(v>>>7^v>>>18^v>>>3^v<<25^v<<14)+(g>>>17^g>>>19^g>>>10^g<<15^g<<13)+b+d|0;x=x+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+2952996808|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;v=x=(_>>>7^_>>>18^_>>>3^_<<25^_<<14)+(y>>>17^y>>>19^y>>>10^y<<15^y<<13)+v+h|0;x=x+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+3210313671|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;_=x=(w>>>7^w>>>18^w>>>3^w<<25^w<<14)+(b>>>17^b>>>19^b>>>10^b<<15^b<<13)+_+f|0;x=x+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+3336571891|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;w=x=(k>>>7^k>>>18^k>>>3^k<<25^k<<14)+(v>>>17^v>>>19^v>>>10^v<<15^v<<13)+w+p|0;x=x+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+3584528711|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;k=x=(E>>>7^E>>>18^E>>>3^E<<25^E<<14)+(_>>>17^_>>>19^_>>>10^_<<15^_<<13)+k+m|0;x=x+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+113926993|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;E=x=(e>>>7^e>>>18^e>>>3^e<<25^e<<14)+(w>>>17^w>>>19^w>>>10^w<<15^w<<13)+E+g|0;x=x+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+338241895|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;e=x=(t>>>7^t>>>18^t>>>3^t<<25^t<<14)+(k>>>17^k>>>19^k>>>10^k<<15^k<<13)+e+y|0;x=x+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+666307205|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;t=x=(n>>>7^n>>>18^n>>>3^n<<25^n<<14)+(E>>>17^E>>>19^E>>>10^E<<15^E<<13)+t+b|0;x=x+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+773529912|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;
n=x=(d>>>7^d>>>18^d>>>3^d<<25^d<<14)+(e>>>17^e>>>19^e>>>10^e<<15^e<<13)+n+v|0;x=x+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+1294757372|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;d=x=(h>>>7^h>>>18^h>>>3^h<<25^h<<14)+(t>>>17^t>>>19^t>>>10^t<<15^t<<13)+d+_|0;x=x+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+1396182291|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;h=x=(f>>>7^f>>>18^f>>>3^f<<25^f<<14)+(n>>>17^n>>>19^n>>>10^n<<15^n<<13)+h+w|0;x=x+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+1695183700|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;f=x=(p>>>7^p>>>18^p>>>3^p<<25^p<<14)+(d>>>17^d>>>19^d>>>10^d<<15^d<<13)+f+k|0;x=x+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+1986661051|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;p=x=(m>>>7^m>>>18^m>>>3^m<<25^m<<14)+(h>>>17^h>>>19^h>>>10^h<<15^h<<13)+p+E|0;x=x+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+2177026350|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;m=x=(g>>>7^g>>>18^g>>>3^g<<25^g<<14)+(f>>>17^f>>>19^f>>>10^f<<15^f<<13)+m+e|0;x=x+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+2456956037|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;g=x=(y>>>7^y>>>18^y>>>3^y<<25^y<<14)+(p>>>17^p>>>19^p>>>10^p<<15^p<<13)+g+t|0;x=x+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+2730485921|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;y=x=(b>>>7^b>>>18^b>>>3^b<<25^b<<14)+(m>>>17^m>>>19^m>>>10^m<<15^m<<13)+y+n|0;x=x+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+2820302411|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;b=x=(v>>>7^v>>>18^v>>>3^v<<25^v<<14)+(g>>>17^g>>>19^g>>>10^g<<15^g<<13)+b+d|0;x=x+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+3259730800|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;v=x=(_>>>7^_>>>18^_>>>3^_<<25^_<<14)+(y>>>17^y>>>19^y>>>10^y<<15^y<<13)+v+h|0;x=x+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+3345764771|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;_=x=(w>>>7^w>>>18^w>>>3^w<<25^w<<14)+(b>>>17^b>>>19^b>>>10^b<<15^b<<13)+_+f|0;x=x+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+3516065817|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;w=x=(k>>>7^k>>>18^k>>>3^k<<25^k<<14)+(v>>>17^v>>>19^v>>>10^v<<15^v<<13)+w+p|0;x=x+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+3600352804|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;k=x=(E>>>7^E>>>18^E>>>3^E<<25^E<<14)+(_>>>17^_>>>19^_>>>10^_<<15^_<<13)+k+m|0;x=x+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+4094571909|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;E=x=(e>>>7^e>>>18^e>>>3^e<<25^e<<14)+(w>>>17^w>>>19^w>>>10^w<<15^w<<13)+E+g|0;x=x+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+275423344|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;e=x=(t>>>7^t>>>18^t>>>3^t<<25^t<<14)+(k>>>17^k>>>19^k>>>10^k<<15^k<<13)+e+y|0;x=x+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+430227734|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;t=x=(n>>>7^n>>>18^n>>>3^n<<25^n<<14)+(E>>>17^E>>>19^E>>>10^E<<15^E<<13)+t+b|0;x=x+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+506948616|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;n=x=(d>>>7^d>>>18^d>>>3^d<<25^d<<14)+(e>>>17^e>>>19^e>>>10^e<<15^e<<13)+n+v|0;x=x+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+659060556|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;d=x=(h>>>7^h>>>18^h>>>3^h<<25^h<<14)+(t>>>17^t>>>19^t>>>10^t<<15^t<<13)+d+_|0;x=x+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+883997877|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;h=x=(f>>>7^f>>>18^f>>>3^f<<25^f<<14)+(n>>>17^n>>>19^n>>>10^n<<15^n<<13)+h+w|0;x=x+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+958139571|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;f=x=(p>>>7^p>>>18^p>>>3^p<<25^p<<14)+(d>>>17^d>>>19^d>>>10^d<<15^d<<13)+f+k|0;x=x+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+1322822218|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;p=x=(m>>>7^m>>>18^m>>>3^m<<25^m<<14)+(h>>>17^h>>>19^h>>>10^h<<15^h<<13)+p+E|0;x=x+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+1537002063|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;m=x=(g>>>7^g>>>18^g>>>3^g<<25^g<<14)+(f>>>17^f>>>19^f>>>10^f<<15^f<<13)+m+e|0;x=x+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+1747873779|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;g=x=(y>>>7^y>>>18^y>>>3^y<<25^y<<14)+(p>>>17^p>>>19^p>>>10^p<<15^p<<13)+g+t|0;x=x+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+1955562222|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;y=x=(b>>>7^b>>>18^b>>>3^b<<25^b<<14)+(m>>>17^m>>>19^m>>>10^m<<15^m<<13)+y+n|0;x=x+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+2024104815|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;b=x=(v>>>7^v>>>18^v>>>3^v<<25^v<<14)+(g>>>17^g>>>19^g>>>10^g<<15^g<<13)+b+d|0;x=x+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+2227730452|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;v=x=(_>>>7^_>>>18^_>>>3^_<<25^_<<14)+(y>>>17^y>>>19^y>>>10^y<<15^y<<13)+v+h|0;x=x+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+2361852424|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;_=x=(w>>>7^w>>>18^w>>>3^w<<25^w<<14)+(b>>>17^b>>>19^b>>>10^b<<15^b<<13)+_+f|0;x=x+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+2428436474|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;w=x=(k>>>7^k>>>18^k>>>3^k<<25^k<<14)+(v>>>17^v>>>19^v>>>10^v<<15^v<<13)+w+p|0;x=x+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+2756734187|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;k=x=(E>>>7^E>>>18^E>>>3^E<<25^E<<14)+(_>>>17^_>>>19^_>>>10^_<<15^_<<13)+k+m|0;x=x+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+3204031479|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;E=x=(e>>>7^e>>>18^e>>>3^e<<25^e<<14)+(w>>>17^w>>>19^w>>>10^w<<15^w<<13)+E+g|0;x=x+D+(C>>>6^C>>>11^C>>>25^C<<26^C<<21^C<<7)+(M^C&(I^M))+3329325298|0;D=M;M=I;I=C;C=N+x|0;N=S;S=T;T=A;A=x+(T&S^N&(T^S))+(T>>>2^T>>>13^T>>>22^T<<30^T<<19^T<<10)|0;r=r+A|0;i=i+T|0;a=a+S|0;s=s+N|0;o=o+C|0;c=c+I|0;l=l+M|0;u=u+D|0}function D(e){e=e|0;M(I[e|0]<<24|I[e|1]<<16|I[e|2]<<8|I[e|3],I[e|4]<<24|I[e|5]<<16|I[e|6]<<8|I[e|7],I[e|8]<<24|I[e|9]<<16|I[e|10]<<8|I[e|11],I[e|12]<<24|I[e|13]<<16|I[e|14]<<8|I[e|15],I[e|16]<<24|I[e|17]<<16|I[e|18]<<8|I[e|19],I[e|20]<<24|I[e|21]<<16|I[e|22]<<8|I[e|23],I[e|24]<<24|I[e|25]<<16|I[e|26]<<8|I[e|27],I[e|28]<<24|I[e|29]<<16|I[e|30]<<8|I[e|31],I[e|32]<<24|I[e|33]<<16|I[e|34]<<8|I[e|35],I[e|36]<<24|I[e|37]<<16|I[e|38]<<8|I[e|39],I[e|40]<<24|I[e|41]<<16|I[e|42]<<8|I[e|43],I[e|44]<<24|I[e|45]<<16|I[e|46]<<8|I[e|47],I[e|48]<<24|I[e|49]<<16|I[e|50]<<8|I[e|51],I[e|52]<<24|I[e|53]<<16|I[e|54]<<8|I[e|55],I[e|56]<<24|I[e|57]<<16|I[e|58]<<8|I[e|59],I[e|60]<<24|I[e|61]<<16|I[e|62]<<8|I[e|63])}function x(e){e=e|0;I[e|0]=r>>>24;I[e|1]=r>>>16&255;I[e|2]=r>>>8&255;I[e|3]=r&255;I[e|4]=i>>>24;I[e|5]=i>>>16&255;I[e|6]=i>>>8&255;I[e|7]=i&255;I[e|8]=a>>>24;I[e|9]=a>>>16&255;I[e|10]=a>>>8&255;I[e|11]=a&255;I[e|12]=s>>>24;I[e|13]=s>>>16&255;I[e|14]=s>>>8&255;I[e|15]=s&255;I[e|16]=o>>>24;I[e|17]=o>>>16&255;I[e|18]=o>>>8&255;I[e|19]=o&255;I[e|20]=c>>>24;I[e|21]=c>>>16&255;I[e|22]=c>>>8&255;I[e|23]=c&255;I[e|24]=l>>>24;I[e|25]=l>>>16&255;I[e|26]=l>>>8&255;I[e|27]=l&255;I[e|28]=u>>>24;I[e|29]=u>>>16&255;I[e|30]=u>>>8&255;I[e|31]=u&255}function O(){r=1779033703;i=3144134277;a=1013904242;s=2773480762;o=1359893119;c=2600822924;l=528734635;u=1541459225;d=h=0}function P(e,t,n,f,p,m,g,y,b,v){e=e|0;t=t|0;n=n|0;f=f|0;p=p|0;m=m|0;g=g|0;y=y|0;b=b|0;v=v|0;r=e;i=t;a=n;s=f;o=p;c=m;l=g;u=y;d=b;h=v}function B(e,t){e=e|0;t=t|0;var n=0;if(e&63)return-1;while((t|0)>=64){D(e);e=e+64|0;t=t-64|0;n=n+64|0}d=d+n|0;if(d>>>0<n>>>0)h=h+1|0;return n|0}function R(e,t,n){e=e|0;t=t|0;n=n|0;var r=0,i=0;if(e&63)return-1;if(~n)if(n&31)return-1;if((t|0)>=64){r=B(e,t)|0;if((r|0)==-1)return-1;e=e+r|0;t=t-r|0}r=r+t|0;d=d+t|0;if(d>>>0<t>>>0)h=h+1|0;I[e|t]=128;if((t|0)>=56){for(i=t+1|0;(i|0)<64;i=i+1|0)I[e|i]=0;D(e);t=0;I[e|0]=0}for(i=t+1|0;(i|0)<59;i=i+1|0)I[e|i]=0;I[e|56]=h>>>21&255;I[e|57]=h>>>13&255;I[e|58]=h>>>5&255;I[e|59]=h<<3&255|d>>>29;I[e|60]=d>>>21&255;I[e|61]=d>>>13&255;I[e|62]=d>>>5&255;I[e|63]=d<<3&255;D(e);if(~n)x(n);return r|0}function L(){r=f;i=p;a=m;s=g;o=y;c=b;l=v;u=_;d=64;h=0}function F(){r=w;i=k;a=E;s=A;o=T;c=S;l=N;u=C;d=64;h=0}function q(e,t,n,I,D,x,P,B,R,L,F,q,U,H,j,J){e=e|0;t=t|0;n=n|0;I=I|0;D=D|0;x=x|0;P=P|0;B=B|0;R=R|0;L=L|0;F=F|0;q=q|0;U=U|0;H=H|0;j=j|0;J=J|0;O();M(e^1549556828,t^1549556828,n^1549556828,I^1549556828,D^1549556828,x^1549556828,P^1549556828,B^1549556828,R^1549556828,L^1549556828,F^1549556828,q^1549556828,U^1549556828,H^1549556828,j^1549556828,J^1549556828);w=r;k=i;E=a;A=s;T=o;S=c;N=l;C=u;O();M(e^909522486,t^909522486,n^909522486,I^909522486,D^909522486,x^909522486,P^909522486,B^909522486,R^909522486,L^909522486,F^909522486,q^909522486,U^909522486,H^909522486,j^909522486,J^909522486);f=r;p=i;m=a;g=s;y=o;b=c;v=l;_=u;d=64;h=0}function U(e,t,n){e=e|0;t=t|0;n=n|0;var d=0,h=0,f=0,p=0,m=0,g=0,y=0,b=0,v=0;if(e&63)return-1;if(~n)if(n&31)return-1;v=R(e,t,-1)|0;d=r,h=i,f=a,p=s,m=o,g=c,y=l,b=u;F();M(d,h,f,p,m,g,y,b,2147483648,0,0,0,0,0,0,768);if(~n)x(n);return v|0}function H(e,t,n,d,h){e=e|0;t=t|0;n=n|0;d=d|0;h=h|0;var f=0,p=0,m=0,g=0,y=0,b=0,v=0,_=0,w=0,k=0,E=0,A=0,T=0,S=0,N=0,C=0;if(e&63)return-1;if(~h)if(h&31)return-1;I[e+t|0]=n>>>24;I[e+t+1|0]=n>>>16&255;I[e+t+2|0]=n>>>8&255;I[e+t+3|0]=n&255;U(e,t+4|0,-1)|0;f=w=r,p=k=i,m=E=a,g=A=s,y=T=o,b=S=c,v=N=l,_=C=u;d=d-1|0;while((d|0)>0){L();M(w,k,E,A,T,S,N,C,2147483648,0,0,0,0,0,0,768);w=r,k=i,E=a,A=s,T=o,S=c,N=l,C=u;F();M(w,k,E,A,T,S,N,C,2147483648,0,0,0,0,0,0,768);w=r,k=i,E=a,A=s,T=o,S=c,N=l,C=u;f=f^r;p=p^i;m=m^a;g=g^s;y=y^o;b=b^c;v=v^l;_=_^u;d=d-1|0}r=f;i=p;a=m;s=g;o=y;c=b;l=v;u=_;if(~h)x(h);return 0}return{reset:O,init:P,process:B,finish:R,hmac_reset:L,hmac_init:q,hmac_finish:U,pbkdf2_generate_block:H}}function ce(e){e=e||{},this.heap=v(Uint8Array,e),this.asm=e.asm||oe(r,null,this.heap.buffer),this.BLOCK_SIZE=pn,this.HASH_SIZE=mn,this.reset()}function le(){return null===yn&&(yn=new ce({heapSize:1048576})),yn}function ue(e){if(void 0===e)throw new SyntaxError("data required");return le().reset().process(e).finish().result}function de(e){var t=ue(e);return d(t)}function he(e){var t=ue(e);return h(t)}function fe(e){if(e=e||{},!e.hash)throw new SyntaxError("option 'hash' is required");if(!e.hash.HASH_SIZE)throw new SyntaxError("option 'hash' supplied doesn't seem to be a valid hash function");return this.hash=e.hash,this.BLOCK_SIZE=this.hash.BLOCK_SIZE,this.HMAC_SIZE=this.hash.HASH_SIZE,this.key=null,this.verify=null,this.result=null,(void 0!==e.password||void 0!==e.verify)&&this.reset(e),this}function pe(e,t){if(g(t)&&(t=new Uint8Array(t)),m(t)&&(t=o(t)),!y(t))throw new TypeError("password isn't of expected type");var n=new Uint8Array(e.BLOCK_SIZE);return t.length>e.BLOCK_SIZE?n.set(e.reset().process(t).finish().result):n.set(t),n}function me(e){if(g(e)||y(e))e=new Uint8Array(e);else{if(!m(e))throw new TypeError("verify tag isn't of expected type");e=o(e)}if(e.length!==this.HMAC_SIZE)throw new a("illegal verification tag size");this.verify=e}function ge(e){e=e||{};var t=e.password;if(null===this.key&&!m(t)&&!t)throw new i("no key is associated with the instance");this.result=null,this.hash.reset(),(t||m(t))&&(this.key=pe(this.hash,t));for(var n=new Uint8Array(this.key),r=0;r<n.length;++r)n[r]^=54;this.hash.process(n);var a=e.verify;return void 0!==a?me.call(this,a):this.verify=null,this}function ye(e){if(null===this.key)throw new i("no key is associated with the instance");if(null!==this.result)throw new i("state must be reset before processing new data");return this.hash.process(e),this}function be(){if(null===this.key)throw new i("no key is associated with the instance");if(null!==this.result)throw new i("state must be reset before processing new data");for(var e=this.hash.finish().result,t=new Uint8Array(this.key),n=0;n<t.length;++n)t[n]^=92;var r=this.verify,a=this.hash.reset().process(t).process(e).finish().result;if(r)if(r.length===a.length){for(var s=0,n=0;n<r.length;n++)s|=r[n]^a[n];this.result=!s}else this.result=!1;else this.result=a;return this}function ve(e){return e=e||{},e.hash instanceof ne||(e.hash=re()),fe.call(this,e),this}function _e(e){e=e||{},this.result=null,this.hash.reset();var t=e.password;if(void 0!==t){m(t)&&(t=o(t));var n=this.key=pe(this.hash,t);this.hash.reset().asm.hmac_init(n[0]<<24|n[1]<<16|n[2]<<8|n[3],n[4]<<24|n[5]<<16|n[6]<<8|n[7],n[8]<<24|n[9]<<16|n[10]<<8|n[11],n[12]<<24|n[13]<<16|n[14]<<8|n[15],n[16]<<24|n[17]<<16|n[18]<<8|n[19],n[20]<<24|n[21]<<16|n[22]<<8|n[23],n[24]<<24|n[25]<<16|n[26]<<8|n[27],n[28]<<24|n[29]<<16|n[30]<<8|n[31],n[32]<<24|n[33]<<16|n[34]<<8|n[35],n[36]<<24|n[37]<<16|n[38]<<8|n[39],n[40]<<24|n[41]<<16|n[42]<<8|n[43],n[44]<<24|n[45]<<16|n[46]<<8|n[47],n[48]<<24|n[49]<<16|n[50]<<8|n[51],n[52]<<24|n[53]<<16|n[54]<<8|n[55],n[56]<<24|n[57]<<16|n[58]<<8|n[59],n[60]<<24|n[61]<<16|n[62]<<8|n[63])}else this.hash.asm.hmac_reset();var r=e.verify;return void 0!==r?me.call(this,r):this.verify=null,this}function we(){if(null===this.key)throw new i("no key is associated with the instance");if(null!==this.result)throw new i("state must be reset before processing new data");var e=this.hash,t=this.hash.asm,n=this.hash.heap;t.hmac_finish(e.pos,e.len,0);var r=this.verify,a=new Uint8Array(dn);if(a.set(n.subarray(0,dn)),r)if(r.length===a.length){for(var s=0,o=0;o<r.length;o++)s|=r[o]^a[o];this.result=!s}else this.result=!1;else this.result=a;return this}function ke(){return null===_n&&(_n=new ve),_n}function Ee(e){return e=e||{},e.hash instanceof ce||(e.hash=le()),fe.call(this,e),this}function Ae(e){e=e||{},this.result=null,this.hash.reset();var t=e.password;if(void 0!==t){m(t)&&(t=o(t));var n=this.key=pe(this.hash,t);this.hash.reset().asm.hmac_init(n[0]<<24|n[1]<<16|n[2]<<8|n[3],n[4]<<24|n[5]<<16|n[6]<<8|n[7],n[8]<<24|n[9]<<16|n[10]<<8|n[11],n[12]<<24|n[13]<<16|n[14]<<8|n[15],n[16]<<24|n[17]<<16|n[18]<<8|n[19],n[20]<<24|n[21]<<16|n[22]<<8|n[23],n[24]<<24|n[25]<<16|n[26]<<8|n[27],n[28]<<24|n[29]<<16|n[30]<<8|n[31],n[32]<<24|n[33]<<16|n[34]<<8|n[35],n[36]<<24|n[37]<<16|n[38]<<8|n[39],n[40]<<24|n[41]<<16|n[42]<<8|n[43],n[44]<<24|n[45]<<16|n[46]<<8|n[47],n[48]<<24|n[49]<<16|n[50]<<8|n[51],n[52]<<24|n[53]<<16|n[54]<<8|n[55],n[56]<<24|n[57]<<16|n[58]<<8|n[59],n[60]<<24|n[61]<<16|n[62]<<8|n[63])}else this.hash.asm.hmac_reset();var r=e.verify;return void 0!==r?me.call(this,r):this.verify=null,this}function Te(){if(null===this.key)throw new i("no key is associated with the instance");if(null!==this.result)throw new i("state must be reset before processing new data");var e=this.hash,t=this.hash.asm,n=this.hash.heap;t.hmac_finish(e.pos,e.len,0);var r=this.verify,a=new Uint8Array(mn);if(a.set(n.subarray(0,mn)),r)if(r.length===a.length){for(var s=0,o=0;o<r.length;o++)s|=r[o]^a[o];this.result=!s}else this.result=!1;else this.result=a;return this}function Se(){return null===kn&&(kn=new Ee),kn}function Ne(e,t){if(void 0===e)throw new SyntaxError("data required");if(void 0===t)throw new SyntaxError("password required");return ke().reset({password:t}).process(e).finish().result}function Ce(e,t){var n=Ne(e,t);return d(n)}function Ie(e,t){var n=Ne(e,t);return h(n)}function Me(e,t){if(void 0===e)throw new SyntaxError("data required");if(void 0===t)throw new SyntaxError("password required");return Se().reset({password:t}).process(e).finish().result}function De(e,t){var n=Me(e,t);return d(n)}function xe(e,t){var n=Me(e,t);return h(n)}function Oe(e){if(e=e||{},!e.hmac)throw new SyntaxError("option 'hmac' is required");if(!e.hmac.HMAC_SIZE)throw new SyntaxError("option 'hmac' supplied doesn't seem to be a valid HMAC function");this.hmac=e.hmac,this.count=e.count||4096,this.length=e.length||this.hmac.HMAC_SIZE,this.result=null;var t=e.password;return(t||m(t))&&this.reset(e),this}function Pe(e){return this.result=null,this.hmac.reset(e),this}function Be(e,t,n){if(null!==this.result)throw new i("state must be reset before processing new data");if(!e&&!m(e))throw new a("bad 'salt' value");t=t||this.count,n=n||this.length,this.result=new Uint8Array(n);for(var r=Math.ceil(n/this.hmac.HMAC_SIZE),s=1;r>=s;++s){var o=(s-1)*this.hmac.HMAC_SIZE,c=(r>s?0:n%this.hmac.HMAC_SIZE)||this.hmac.HMAC_SIZE,l=new Uint8Array(this.hmac.reset().process(e).process(new Uint8Array([s>>>24&255,s>>>16&255,s>>>8&255,255&s])).finish().result);this.result.set(l.subarray(0,c),o);for(var u=1;t>u;++u){l=new Uint8Array(this.hmac.reset().process(l).finish().result);for(var d=0;c>d;++d)this.result[o+d]^=l[d]}}return this}function Re(e){return e=e||{},e.hmac instanceof ve||(e.hmac=ke()),Oe.call(this,e),this}function Le(e,t,n){if(null!==this.result)throw new i("state must be reset before processing new data");if(!e&&!m(e))throw new a("bad 'salt' value");t=t||this.count,n=n||this.length,this.result=new Uint8Array(n);for(var r=Math.ceil(n/this.hmac.HMAC_SIZE),s=1;r>=s;++s){var o=(s-1)*this.hmac.HMAC_SIZE,c=(r>s?0:n%this.hmac.HMAC_SIZE)||this.hmac.HMAC_SIZE;this.hmac.reset().process(e),this.hmac.hash.asm.pbkdf2_generate_block(this.hmac.hash.pos,this.hmac.hash.len,s,t,0),this.result.set(this.hmac.hash.heap.subarray(0,c),o)}return this}function Fe(){return null===Tn&&(Tn=new Re),Tn}function qe(e){return e=e||{},e.hmac instanceof Ee||(e.hmac=Se()),Oe.call(this,e),this}function Ue(e,t,n){if(null!==this.result)throw new i("state must be reset before processing new data");if(!e&&!m(e))throw new a("bad 'salt' value");t=t||this.count,n=n||this.length,this.result=new Uint8Array(n);for(var r=Math.ceil(n/this.hmac.HMAC_SIZE),s=1;r>=s;++s){var o=(s-1)*this.hmac.HMAC_SIZE,c=(r>s?0:n%this.hmac.HMAC_SIZE)||this.hmac.HMAC_SIZE;this.hmac.reset().process(e),this.hmac.hash.asm.pbkdf2_generate_block(this.hmac.hash.pos,this.hmac.hash.len,s,t,0),this.result.set(this.hmac.hash.heap.subarray(0,c),o)}return this}function He(){return null===Nn&&(Nn=new qe),Nn}function je(e,t,n,r){if(void 0===e)throw new SyntaxError("password required");if(void 0===t)throw new SyntaxError("salt required");return Fe().reset({password:e}).generate(t,n,r).result}function Je(e,t,n,r){var i=je(e,t,n,r);return d(i)}function Ge(e,t,n,r){var i=je(e,t,n,r);return h(i)}function ze(e,t,n,r){if(void 0===e)throw new SyntaxError("password required");if(void 0===t)throw new SyntaxError("salt required");return He().reset({password:e}).generate(t,n,r).result}function We(e,t,n,r){var i=ze(e,t,n,r);return d(i)}function Ve(e,t,n,r){var i=ze(e,t,n,r);return h(i)}function Ke(){if(void 0!==On)n=new Uint8Array(32),Cn.call(On,n),Rn(n);else{var e,t,n=new Kt(3);n[0]=Dn(),n[1]=Mn(),n[2]=Pn(),n=new Uint8Array(n.buffer);var i=He();for(e=0;100>e;e++)n=i.reset({password:n}).generate(r.location.href,1e3,32).result,t=Pn(),n[0]^=t>>>24,n[1]^=t>>>16,n[2]^=t>>>8,n[3]^=t;Rn(n)}Ln=0,Fn=!0}function Xe(e){if(!g(e)&&!b(e))throw new TypeError("bad seed type");var t=e.byteOffest||0,n=e.byteLength||e.length,r=new Uint8Array(e.buffer||e,t,n);Rn(r),Ln=0;for(var i=0,a=0;a<r.length;a++)i|=r[a],r[a]=0;return 0!==i&&(Un+=4*n),qn=Un>=Hn}function Ze(e){if(Fn||Ke(),!qn&&void 0===On){if(!jn)throw new s("No strong PRNGs available. Use asmCrypto.random.seed().");void 0!==Xt&&Xt.error("No strong PRNGs available; your security is greatly lowered. Use asmCrypto.random.seed().")}if(!Jn&&!qn&&void 0!==On&&void 0!==Xt){var t=(new Error).stack;Gn[t]|=0,Gn[t]++||Xt.warn("asmCrypto PRNG not seeded; your security relies on your system PRNG. If this is not acceptable, use asmCrypto.random.seed().")}if(!g(e)&&!b(e))throw new TypeError("unexpected buffer type");var n,r,i=e.byteOffset||0,a=e.byteLength||e.length,o=new Uint8Array(e.buffer||e,i,a);for(void 0!==On&&Cn.call(On,o),n=0;a>n;n++)0===(3&n)&&(Ln>=1099511627776&&Ke(),r=Bn(),Ln++),o[n]^=r,r>>>=8;return e}function Qe(){(!Fn||Ln>=1099511627776)&&Ke();var e=(1048576*Bn()+(Bn()>>>12))/4503599627370496;return Ln+=2,e}function Ye(e,t){return e*t|0}function $e(e,t,n){"use asm";var r=0;var i=new e.Uint32Array(n);var a=e.Math.imul;function s(e){e=e|0;r=e=e+31&-32;return e|0}function o(e){e=e|0;var t=0;t=r;r=t+(e+31&-32)|0;return t|0}function c(e){e=e|0;r=r-(e+31&-32)|0}function l(e,t,n){e=e|0;t=t|0;n=n|0;var r=0;if((t|0)>(n|0)){for(;(r|0)<(e|0);r=r+4|0){i[n+r>>2]=i[t+r>>2]}}else{for(r=e-4|0;(r|0)>=0;r=r-4|0){i[n+r>>2]=i[t+r>>2]}}}function u(e,t,n){e=e|0;t=t|0;n=n|0;var r=0;for(;(r|0)<(e|0);r=r+4|0){i[n+r>>2]=t}}function d(e,t,n,r){e=e|0;t=t|0;n=n|0;r=r|0;var a=0,s=0,o=0,c=0,l=0;if((r|0)<=0)r=t;if((r|0)<(t|0))t=r;s=1;for(;(l|0)<(t|0);l=l+4|0){a=~i[e+l>>2];o=(a&65535)+s|0;c=(a>>>16)+(o>>>16)|0;i[n+l>>2]=c<<16|o&65535;s=c>>>16}for(;(l|0)<(r|0);l=l+4|0){i[n+l>>2]=s-1|0}return s|0}function h(e,t,n,r){e=e|0;t=t|0;n=n|0;r=r|0;var a=0,s=0,o=0;if((t|0)>(r|0)){for(o=t-4|0;(o|0)>=(r|0);o=o-4|0){if(i[e+o>>2]|0)return 1}}else{for(o=r-4|0;(o|0)>=(t|0);o=o-4|0){if(i[n+o>>2]|0)return-1}}for(;(o|0)>=0;o=o-4|0){a=i[e+o>>2]|0,s=i[n+o>>2]|0;if(a>>>0<s>>>0)return-1;if(a>>>0>s>>>0)return 1}return 0}function f(e,t){e=e|0;t=t|0;var n=0;for(n=t-4|0;(n|0)>=0;n=n-4|0){if(i[e+n>>2]|0)return n+4|0}return 0}function p(e,t,n,r,a,s){e=e|0;t=t|0;n=n|0;r=r|0;a=a|0;s=s|0;var o=0,c=0,l=0,u=0,d=0,h=0;if((t|0)<(r|0)){u=e,e=n,n=u;u=t,t=r,r=u}if((s|0)<=0)s=t+4|0;if((s|0)<(r|0))t=r=s;for(;(h|0)<(r|0);h=h+4|0){o=i[e+h>>2]|0;c=i[n+h>>2]|0;u=((o&65535)+(c&65535)|0)+l|0;d=((o>>>16)+(c>>>16)|0)+(u>>>16)|0;i[a+h>>2]=u&65535|d<<16;l=d>>>16}for(;(h|0)<(t|0);h=h+4|0){o=i[e+h>>2]|0;u=(o&65535)+l|0;d=(o>>>16)+(u>>>16)|0;i[a+h>>2]=u&65535|d<<16;l=d>>>16}for(;(h|0)<(s|0);h=h+4|0){i[a+h>>2]=l|0;l=0}return l|0}function m(e,t,n,r,a,s){e=e|0;t=t|0;n=n|0;r=r|0;a=a|0;s=s|0;var o=0,c=0,l=0,u=0,d=0,h=0;if((s|0)<=0)s=(t|0)>(r|0)?t+4|0:r+4|0;if((s|0)<(t|0))t=s;if((s|0)<(r|0))r=s;if((t|0)<(r|0)){for(;(h|0)<(t|0);h=h+4|0){o=i[e+h>>2]|0;c=i[n+h>>2]|0;u=((o&65535)-(c&65535)|0)+l|0;d=((o>>>16)-(c>>>16)|0)+(u>>16)|0;i[a+h>>2]=u&65535|d<<16;l=d>>16}for(;(h|0)<(r|0);h=h+4|0){c=i[n+h>>2]|0;u=l-(c&65535)|0;d=(u>>16)-(c>>>16)|0;i[a+h>>2]=u&65535|d<<16;l=d>>16}}else{for(;(h|0)<(r|0);h=h+4|0){o=i[e+h>>2]|0;c=i[n+h>>2]|0;u=((o&65535)-(c&65535)|0)+l|0;d=((o>>>16)-(c>>>16)|0)+(u>>16)|0;i[a+h>>2]=u&65535|d<<16;l=d>>16}for(;(h|0)<(t|0);h=h+4|0){o=i[e+h>>2]|0;u=(o&65535)+l|0;d=(o>>>16)+(u>>16)|0;i[a+h>>2]=u&65535|d<<16;l=d>>16}}for(;(h|0)<(s|0);h=h+4|0){i[a+h>>2]=l|0}return l|0}function g(e,t,n,r,s,o){e=e|0;t=t|0;n=n|0;r=r|0;s=s|0;o=o|0;var c=0,l=0,u=0,d=0,h=0,f=0,p=0,m=0,g=0,y=0,b=0,v=0,_=0,w=0,k=0,E=0,A=0,T=0,S=0,N=0,C=0,I=0,M=0,D=0,x=0,O=0,P=0,B=0,R=0,L=0,F=0,q=0,U=0,H=0,j=0,J=0,G=0,z=0,W=0,V=0,K=0,X=0,Z=0,Q=0,Y=0,$=0,ee=0,te=0,ne=0,re=0,ie=0,ae=0,se=0,oe=0,ce=0,le=0,ue=0;if((t|0)>(r|0)){ne=e,re=t;e=n,t=r;n=ne,r=re}ae=t+r|0;if((o|0)>(ae|0)|(o|0)<=0)o=ae;if((o|0)<(t|0))t=o;if((o|0)<(r|0))r=o;for(;(se|0)<(t|0);se=se+32|0){oe=e+se|0;g=i[(oe|0)>>2]|0,y=i[(oe|4)>>2]|0,b=i[(oe|8)>>2]|0,v=i[(oe|12)>>2]|0,_=i[(oe|16)>>2]|0,w=i[(oe|20)>>2]|0,k=i[(oe|24)>>2]|0,E=i[(oe|28)>>2]|0,c=g&65535,l=y&65535,u=b&65535,d=v&65535,h=_&65535,f=w&65535,p=k&65535,m=E&65535,g=g>>>16,y=y>>>16,b=b>>>16,v=v>>>16,_=_>>>16,w=w>>>16,k=k>>>16,E=E>>>16;K=X=Z=Q=Y=$=ee=te=0;for(ce=0;(ce|0)<(r|0);ce=ce+32|0){le=n+ce|0;ue=s+(se+ce|0)|0;x=i[(le|0)>>2]|0,O=i[(le|4)>>2]|0,P=i[(le|8)>>2]|0,B=i[(le|12)>>2]|0,R=i[(le|16)>>2]|0,L=i[(le|20)>>2]|0,F=i[(le|24)>>2]|0,q=i[(le|28)>>2]|0,A=x&65535,T=O&65535,S=P&65535,N=B&65535,C=R&65535,I=L&65535,M=F&65535,D=q&65535,x=x>>>16,O=O>>>16,P=P>>>16,B=B>>>16,R=R>>>16,L=L>>>16,F=F>>>16,q=q>>>16;U=i[(ue|0)>>2]|0,H=i[(ue|4)>>2]|0,j=i[(ue|8)>>2]|0,J=i[(ue|12)>>2]|0,G=i[(ue|16)>>2]|0,z=i[(ue|20)>>2]|0,W=i[(ue|24)>>2]|0,V=i[(ue|28)>>2]|0;ne=((a(c,A)|0)+(K&65535)|0)+(U&65535)|0;re=((a(g,A)|0)+(K>>>16)|0)+(U>>>16)|0;ie=((a(c,x)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(g,x)|0)+(re>>>16)|0)+(ie>>>16)|0;U=ie<<16|ne&65535;ne=((a(c,T)|0)+(ae&65535)|0)+(H&65535)|0;re=((a(g,T)|0)+(ae>>>16)|0)+(H>>>16)|0;ie=((a(c,O)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(g,O)|0)+(re>>>16)|0)+(ie>>>16)|0;H=ie<<16|ne&65535;ne=((a(c,S)|0)+(ae&65535)|0)+(j&65535)|0;re=((a(g,S)|0)+(ae>>>16)|0)+(j>>>16)|0;ie=((a(c,P)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(g,P)|0)+(re>>>16)|0)+(ie>>>16)|0;j=ie<<16|ne&65535;ne=((a(c,N)|0)+(ae&65535)|0)+(J&65535)|0;re=((a(g,N)|0)+(ae>>>16)|0)+(J>>>16)|0;ie=((a(c,B)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(g,B)|0)+(re>>>16)|0)+(ie>>>16)|0;J=ie<<16|ne&65535;ne=((a(c,C)|0)+(ae&65535)|0)+(G&65535)|0;re=((a(g,C)|0)+(ae>>>16)|0)+(G>>>16)|0;ie=((a(c,R)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(g,R)|0)+(re>>>16)|0)+(ie>>>16)|0;G=ie<<16|ne&65535;ne=((a(c,I)|0)+(ae&65535)|0)+(z&65535)|0;re=((a(g,I)|0)+(ae>>>16)|0)+(z>>>16)|0;ie=((a(c,L)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(g,L)|0)+(re>>>16)|0)+(ie>>>16)|0;z=ie<<16|ne&65535;ne=((a(c,M)|0)+(ae&65535)|0)+(W&65535)|0;re=((a(g,M)|0)+(ae>>>16)|0)+(W>>>16)|0;ie=((a(c,F)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(g,F)|0)+(re>>>16)|0)+(ie>>>16)|0;W=ie<<16|ne&65535;ne=((a(c,D)|0)+(ae&65535)|0)+(V&65535)|0;re=((a(g,D)|0)+(ae>>>16)|0)+(V>>>16)|0;ie=((a(c,q)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(g,q)|0)+(re>>>16)|0)+(ie>>>16)|0;V=ie<<16|ne&65535;K=ae;ne=((a(l,A)|0)+(X&65535)|0)+(H&65535)|0;re=((a(y,A)|0)+(X>>>16)|0)+(H>>>16)|0;ie=((a(l,x)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(y,x)|0)+(re>>>16)|0)+(ie>>>16)|0;H=ie<<16|ne&65535;ne=((a(l,T)|0)+(ae&65535)|0)+(j&65535)|0;re=((a(y,T)|0)+(ae>>>16)|0)+(j>>>16)|0;ie=((a(l,O)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(y,O)|0)+(re>>>16)|0)+(ie>>>16)|0;j=ie<<16|ne&65535;ne=((a(l,S)|0)+(ae&65535)|0)+(J&65535)|0;re=((a(y,S)|0)+(ae>>>16)|0)+(J>>>16)|0;ie=((a(l,P)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(y,P)|0)+(re>>>16)|0)+(ie>>>16)|0;J=ie<<16|ne&65535;ne=((a(l,N)|0)+(ae&65535)|0)+(G&65535)|0;re=((a(y,N)|0)+(ae>>>16)|0)+(G>>>16)|0;ie=((a(l,B)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(y,B)|0)+(re>>>16)|0)+(ie>>>16)|0;G=ie<<16|ne&65535;ne=((a(l,C)|0)+(ae&65535)|0)+(z&65535)|0;re=((a(y,C)|0)+(ae>>>16)|0)+(z>>>16)|0;ie=((a(l,R)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(y,R)|0)+(re>>>16)|0)+(ie>>>16)|0;z=ie<<16|ne&65535;ne=((a(l,I)|0)+(ae&65535)|0)+(W&65535)|0;re=((a(y,I)|0)+(ae>>>16)|0)+(W>>>16)|0;ie=((a(l,L)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(y,L)|0)+(re>>>16)|0)+(ie>>>16)|0;W=ie<<16|ne&65535;ne=((a(l,M)|0)+(ae&65535)|0)+(V&65535)|0;re=((a(y,M)|0)+(ae>>>16)|0)+(V>>>16)|0;ie=((a(l,F)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(y,F)|0)+(re>>>16)|0)+(ie>>>16)|0;V=ie<<16|ne&65535;ne=((a(l,D)|0)+(ae&65535)|0)+(K&65535)|0;re=((a(y,D)|0)+(ae>>>16)|0)+(K>>>16)|0;ie=((a(l,q)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(y,q)|0)+(re>>>16)|0)+(ie>>>16)|0;K=ie<<16|ne&65535;X=ae;ne=((a(u,A)|0)+(Z&65535)|0)+(j&65535)|0;re=((a(b,A)|0)+(Z>>>16)|0)+(j>>>16)|0;ie=((a(u,x)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(b,x)|0)+(re>>>16)|0)+(ie>>>16)|0;j=ie<<16|ne&65535;ne=((a(u,T)|0)+(ae&65535)|0)+(J&65535)|0;re=((a(b,T)|0)+(ae>>>16)|0)+(J>>>16)|0;ie=((a(u,O)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(b,O)|0)+(re>>>16)|0)+(ie>>>16)|0;J=ie<<16|ne&65535;ne=((a(u,S)|0)+(ae&65535)|0)+(G&65535)|0;re=((a(b,S)|0)+(ae>>>16)|0)+(G>>>16)|0;ie=((a(u,P)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(b,P)|0)+(re>>>16)|0)+(ie>>>16)|0;G=ie<<16|ne&65535;ne=((a(u,N)|0)+(ae&65535)|0)+(z&65535)|0;re=((a(b,N)|0)+(ae>>>16)|0)+(z>>>16)|0;ie=((a(u,B)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(b,B)|0)+(re>>>16)|0)+(ie>>>16)|0;z=ie<<16|ne&65535;ne=((a(u,C)|0)+(ae&65535)|0)+(W&65535)|0;re=((a(b,C)|0)+(ae>>>16)|0)+(W>>>16)|0;ie=((a(u,R)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(b,R)|0)+(re>>>16)|0)+(ie>>>16)|0;W=ie<<16|ne&65535;ne=((a(u,I)|0)+(ae&65535)|0)+(V&65535)|0;re=((a(b,I)|0)+(ae>>>16)|0)+(V>>>16)|0;ie=((a(u,L)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(b,L)|0)+(re>>>16)|0)+(ie>>>16)|0;V=ie<<16|ne&65535;ne=((a(u,M)|0)+(ae&65535)|0)+(K&65535)|0;re=((a(b,M)|0)+(ae>>>16)|0)+(K>>>16)|0;ie=((a(u,F)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(b,F)|0)+(re>>>16)|0)+(ie>>>16)|0;K=ie<<16|ne&65535;ne=((a(u,D)|0)+(ae&65535)|0)+(X&65535)|0;re=((a(b,D)|0)+(ae>>>16)|0)+(X>>>16)|0;ie=((a(u,q)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(b,q)|0)+(re>>>16)|0)+(ie>>>16)|0;X=ie<<16|ne&65535;Z=ae;ne=((a(d,A)|0)+(Q&65535)|0)+(J&65535)|0;re=((a(v,A)|0)+(Q>>>16)|0)+(J>>>16)|0;ie=((a(d,x)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(v,x)|0)+(re>>>16)|0)+(ie>>>16)|0;J=ie<<16|ne&65535;ne=((a(d,T)|0)+(ae&65535)|0)+(G&65535)|0;re=((a(v,T)|0)+(ae>>>16)|0)+(G>>>16)|0;ie=((a(d,O)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(v,O)|0)+(re>>>16)|0)+(ie>>>16)|0;G=ie<<16|ne&65535;ne=((a(d,S)|0)+(ae&65535)|0)+(z&65535)|0;re=((a(v,S)|0)+(ae>>>16)|0)+(z>>>16)|0;ie=((a(d,P)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(v,P)|0)+(re>>>16)|0)+(ie>>>16)|0;z=ie<<16|ne&65535;ne=((a(d,N)|0)+(ae&65535)|0)+(W&65535)|0;re=((a(v,N)|0)+(ae>>>16)|0)+(W>>>16)|0;ie=((a(d,B)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(v,B)|0)+(re>>>16)|0)+(ie>>>16)|0;W=ie<<16|ne&65535;ne=((a(d,C)|0)+(ae&65535)|0)+(V&65535)|0;re=((a(v,C)|0)+(ae>>>16)|0)+(V>>>16)|0;ie=((a(d,R)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(v,R)|0)+(re>>>16)|0)+(ie>>>16)|0;V=ie<<16|ne&65535;ne=((a(d,I)|0)+(ae&65535)|0)+(K&65535)|0;re=((a(v,I)|0)+(ae>>>16)|0)+(K>>>16)|0;ie=((a(d,L)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(v,L)|0)+(re>>>16)|0)+(ie>>>16)|0;K=ie<<16|ne&65535;ne=((a(d,M)|0)+(ae&65535)|0)+(X&65535)|0;re=((a(v,M)|0)+(ae>>>16)|0)+(X>>>16)|0;ie=((a(d,F)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(v,F)|0)+(re>>>16)|0)+(ie>>>16)|0;X=ie<<16|ne&65535;ne=((a(d,D)|0)+(ae&65535)|0)+(Z&65535)|0;re=((a(v,D)|0)+(ae>>>16)|0)+(Z>>>16)|0;ie=((a(d,q)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(v,q)|0)+(re>>>16)|0)+(ie>>>16)|0;Z=ie<<16|ne&65535;Q=ae;ne=((a(h,A)|0)+(Y&65535)|0)+(G&65535)|0;re=((a(_,A)|0)+(Y>>>16)|0)+(G>>>16)|0;ie=((a(h,x)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(_,x)|0)+(re>>>16)|0)+(ie>>>16)|0;G=ie<<16|ne&65535;ne=((a(h,T)|0)+(ae&65535)|0)+(z&65535)|0;re=((a(_,T)|0)+(ae>>>16)|0)+(z>>>16)|0;ie=((a(h,O)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(_,O)|0)+(re>>>16)|0)+(ie>>>16)|0;z=ie<<16|ne&65535;ne=((a(h,S)|0)+(ae&65535)|0)+(W&65535)|0;re=((a(_,S)|0)+(ae>>>16)|0)+(W>>>16)|0;ie=((a(h,P)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(_,P)|0)+(re>>>16)|0)+(ie>>>16)|0;W=ie<<16|ne&65535;ne=((a(h,N)|0)+(ae&65535)|0)+(V&65535)|0;re=((a(_,N)|0)+(ae>>>16)|0)+(V>>>16)|0;ie=((a(h,B)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(_,B)|0)+(re>>>16)|0)+(ie>>>16)|0;V=ie<<16|ne&65535;ne=((a(h,C)|0)+(ae&65535)|0)+(K&65535)|0;re=((a(_,C)|0)+(ae>>>16)|0)+(K>>>16)|0;ie=((a(h,R)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(_,R)|0)+(re>>>16)|0)+(ie>>>16)|0;K=ie<<16|ne&65535;ne=((a(h,I)|0)+(ae&65535)|0)+(X&65535)|0;re=((a(_,I)|0)+(ae>>>16)|0)+(X>>>16)|0;ie=((a(h,L)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(_,L)|0)+(re>>>16)|0)+(ie>>>16)|0;X=ie<<16|ne&65535;ne=((a(h,M)|0)+(ae&65535)|0)+(Z&65535)|0;re=((a(_,M)|0)+(ae>>>16)|0)+(Z>>>16)|0;ie=((a(h,F)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(_,F)|0)+(re>>>16)|0)+(ie>>>16)|0;Z=ie<<16|ne&65535;ne=((a(h,D)|0)+(ae&65535)|0)+(Q&65535)|0;re=((a(_,D)|0)+(ae>>>16)|0)+(Q>>>16)|0;ie=((a(h,q)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(_,q)|0)+(re>>>16)|0)+(ie>>>16)|0;Q=ie<<16|ne&65535;Y=ae;ne=((a(f,A)|0)+($&65535)|0)+(z&65535)|0;re=((a(w,A)|0)+($>>>16)|0)+(z>>>16)|0;ie=((a(f,x)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(w,x)|0)+(re>>>16)|0)+(ie>>>16)|0;z=ie<<16|ne&65535;ne=((a(f,T)|0)+(ae&65535)|0)+(W&65535)|0;re=((a(w,T)|0)+(ae>>>16)|0)+(W>>>16)|0;ie=((a(f,O)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(w,O)|0)+(re>>>16)|0)+(ie>>>16)|0;W=ie<<16|ne&65535;ne=((a(f,S)|0)+(ae&65535)|0)+(V&65535)|0;re=((a(w,S)|0)+(ae>>>16)|0)+(V>>>16)|0;ie=((a(f,P)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(w,P)|0)+(re>>>16)|0)+(ie>>>16)|0;V=ie<<16|ne&65535;ne=((a(f,N)|0)+(ae&65535)|0)+(K&65535)|0;re=((a(w,N)|0)+(ae>>>16)|0)+(K>>>16)|0;ie=((a(f,B)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(w,B)|0)+(re>>>16)|0)+(ie>>>16)|0;K=ie<<16|ne&65535;ne=((a(f,C)|0)+(ae&65535)|0)+(X&65535)|0;re=((a(w,C)|0)+(ae>>>16)|0)+(X>>>16)|0;ie=((a(f,R)|0)+(re&65535)|0)+(ne>>>16)|0;
ae=((a(w,R)|0)+(re>>>16)|0)+(ie>>>16)|0;X=ie<<16|ne&65535;ne=((a(f,I)|0)+(ae&65535)|0)+(Z&65535)|0;re=((a(w,I)|0)+(ae>>>16)|0)+(Z>>>16)|0;ie=((a(f,L)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(w,L)|0)+(re>>>16)|0)+(ie>>>16)|0;Z=ie<<16|ne&65535;ne=((a(f,M)|0)+(ae&65535)|0)+(Q&65535)|0;re=((a(w,M)|0)+(ae>>>16)|0)+(Q>>>16)|0;ie=((a(f,F)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(w,F)|0)+(re>>>16)|0)+(ie>>>16)|0;Q=ie<<16|ne&65535;ne=((a(f,D)|0)+(ae&65535)|0)+(Y&65535)|0;re=((a(w,D)|0)+(ae>>>16)|0)+(Y>>>16)|0;ie=((a(f,q)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(w,q)|0)+(re>>>16)|0)+(ie>>>16)|0;Y=ie<<16|ne&65535;$=ae;ne=((a(p,A)|0)+(ee&65535)|0)+(W&65535)|0;re=((a(k,A)|0)+(ee>>>16)|0)+(W>>>16)|0;ie=((a(p,x)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(k,x)|0)+(re>>>16)|0)+(ie>>>16)|0;W=ie<<16|ne&65535;ne=((a(p,T)|0)+(ae&65535)|0)+(V&65535)|0;re=((a(k,T)|0)+(ae>>>16)|0)+(V>>>16)|0;ie=((a(p,O)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(k,O)|0)+(re>>>16)|0)+(ie>>>16)|0;V=ie<<16|ne&65535;ne=((a(p,S)|0)+(ae&65535)|0)+(K&65535)|0;re=((a(k,S)|0)+(ae>>>16)|0)+(K>>>16)|0;ie=((a(p,P)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(k,P)|0)+(re>>>16)|0)+(ie>>>16)|0;K=ie<<16|ne&65535;ne=((a(p,N)|0)+(ae&65535)|0)+(X&65535)|0;re=((a(k,N)|0)+(ae>>>16)|0)+(X>>>16)|0;ie=((a(p,B)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(k,B)|0)+(re>>>16)|0)+(ie>>>16)|0;X=ie<<16|ne&65535;ne=((a(p,C)|0)+(ae&65535)|0)+(Z&65535)|0;re=((a(k,C)|0)+(ae>>>16)|0)+(Z>>>16)|0;ie=((a(p,R)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(k,R)|0)+(re>>>16)|0)+(ie>>>16)|0;Z=ie<<16|ne&65535;ne=((a(p,I)|0)+(ae&65535)|0)+(Q&65535)|0;re=((a(k,I)|0)+(ae>>>16)|0)+(Q>>>16)|0;ie=((a(p,L)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(k,L)|0)+(re>>>16)|0)+(ie>>>16)|0;Q=ie<<16|ne&65535;ne=((a(p,M)|0)+(ae&65535)|0)+(Y&65535)|0;re=((a(k,M)|0)+(ae>>>16)|0)+(Y>>>16)|0;ie=((a(p,F)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(k,F)|0)+(re>>>16)|0)+(ie>>>16)|0;Y=ie<<16|ne&65535;ne=((a(p,D)|0)+(ae&65535)|0)+($&65535)|0;re=((a(k,D)|0)+(ae>>>16)|0)+($>>>16)|0;ie=((a(p,q)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(k,q)|0)+(re>>>16)|0)+(ie>>>16)|0;$=ie<<16|ne&65535;ee=ae;ne=((a(m,A)|0)+(te&65535)|0)+(V&65535)|0;re=((a(E,A)|0)+(te>>>16)|0)+(V>>>16)|0;ie=((a(m,x)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(E,x)|0)+(re>>>16)|0)+(ie>>>16)|0;V=ie<<16|ne&65535;ne=((a(m,T)|0)+(ae&65535)|0)+(K&65535)|0;re=((a(E,T)|0)+(ae>>>16)|0)+(K>>>16)|0;ie=((a(m,O)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(E,O)|0)+(re>>>16)|0)+(ie>>>16)|0;K=ie<<16|ne&65535;ne=((a(m,S)|0)+(ae&65535)|0)+(X&65535)|0;re=((a(E,S)|0)+(ae>>>16)|0)+(X>>>16)|0;ie=((a(m,P)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(E,P)|0)+(re>>>16)|0)+(ie>>>16)|0;X=ie<<16|ne&65535;ne=((a(m,N)|0)+(ae&65535)|0)+(Z&65535)|0;re=((a(E,N)|0)+(ae>>>16)|0)+(Z>>>16)|0;ie=((a(m,B)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(E,B)|0)+(re>>>16)|0)+(ie>>>16)|0;Z=ie<<16|ne&65535;ne=((a(m,C)|0)+(ae&65535)|0)+(Q&65535)|0;re=((a(E,C)|0)+(ae>>>16)|0)+(Q>>>16)|0;ie=((a(m,R)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(E,R)|0)+(re>>>16)|0)+(ie>>>16)|0;Q=ie<<16|ne&65535;ne=((a(m,I)|0)+(ae&65535)|0)+(Y&65535)|0;re=((a(E,I)|0)+(ae>>>16)|0)+(Y>>>16)|0;ie=((a(m,L)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(E,L)|0)+(re>>>16)|0)+(ie>>>16)|0;Y=ie<<16|ne&65535;ne=((a(m,M)|0)+(ae&65535)|0)+($&65535)|0;re=((a(E,M)|0)+(ae>>>16)|0)+($>>>16)|0;ie=((a(m,F)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(E,F)|0)+(re>>>16)|0)+(ie>>>16)|0;$=ie<<16|ne&65535;ne=((a(m,D)|0)+(ae&65535)|0)+(ee&65535)|0;re=((a(E,D)|0)+(ae>>>16)|0)+(ee>>>16)|0;ie=((a(m,q)|0)+(re&65535)|0)+(ne>>>16)|0;ae=((a(E,q)|0)+(re>>>16)|0)+(ie>>>16)|0;ee=ie<<16|ne&65535;te=ae;i[(ue|0)>>2]=U,i[(ue|4)>>2]=H,i[(ue|8)>>2]=j,i[(ue|12)>>2]=J,i[(ue|16)>>2]=G,i[(ue|20)>>2]=z,i[(ue|24)>>2]=W,i[(ue|28)>>2]=V}ue=s+(se+ce|0)|0;i[(ue|0)>>2]=K,i[(ue|4)>>2]=X,i[(ue|8)>>2]=Z,i[(ue|12)>>2]=Q,i[(ue|16)>>2]=Y,i[(ue|20)>>2]=$,i[(ue|24)>>2]=ee,i[(ue|28)>>2]=te}}function y(e,t,n){e=e|0;t=t|0;n=n|0;var r=0,s=0,o=0,c=0,l=0,u=0,d=0,h=0,f=0,p=0,m=0,g=0,y=0,b=0,v=0,_=0,w=0,k=0,E=0,A=0,T=0,S=0,N=0,C=0,I=0,M=0,D=0,x=0,O=0,P=0,B=0,R=0,L=0,F=0,q=0,U=0,H=0,j=0,J=0,G=0,z=0,W=0,V=0,K=0,X=0,Z=0,Q=0,Y=0,$=0,ee=0,te=0,ne=0,re=0,ie=0,ae=0,se=0,oe=0,ce=0,le=0,ue=0,de=0,he=0,fe=0,pe=0;for(;(le|0)<(t|0);le=le+4|0){pe=n+(le<<1)|0;f=i[e+le>>2]|0,r=f&65535,f=f>>>16;$=a(r,r)|0;ee=(a(r,f)|0)+($>>>17)|0;te=(a(f,f)|0)+(ee>>>15)|0;i[pe>>2]=ee<<17|$&131071;i[(pe|4)>>2]=te}for(ce=0;(ce|0)<(t|0);ce=ce+8|0){he=e+ce|0,pe=n+(ce<<1)|0;f=i[he>>2]|0,r=f&65535,f=f>>>16;I=i[(he|4)>>2]|0,w=I&65535,I=I>>>16;$=a(r,w)|0;ee=(a(r,I)|0)+($>>>16)|0;te=(a(f,w)|0)+(ee&65535)|0;ie=((a(f,I)|0)+(ee>>>16)|0)+(te>>>16)|0;ae=i[(pe|4)>>2]|0;$=(ae&65535)+(($&65535)<<1)|0;te=((ae>>>16)+((te&65535)<<1)|0)+($>>>16)|0;i[(pe|4)>>2]=te<<16|$&65535;ne=te>>>16;ae=i[(pe|8)>>2]|0;$=((ae&65535)+((ie&65535)<<1)|0)+ne|0;te=((ae>>>16)+(ie>>>16<<1)|0)+($>>>16)|0;i[(pe|8)>>2]=te<<16|$&65535;ne=te>>>16;if(ne){ae=i[(pe|12)>>2]|0;$=(ae&65535)+ne|0;te=(ae>>>16)+($>>>16)|0;i[(pe|12)>>2]=te<<16|$&65535}}for(ce=0;(ce|0)<(t|0);ce=ce+16|0){he=e+ce|0,pe=n+(ce<<1)|0;f=i[he>>2]|0,r=f&65535,f=f>>>16,p=i[(he|4)>>2]|0,s=p&65535,p=p>>>16;I=i[(he|8)>>2]|0,w=I&65535,I=I>>>16,M=i[(he|12)>>2]|0,k=M&65535,M=M>>>16;$=a(r,w)|0;ee=a(f,w)|0;te=((a(r,I)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(f,I)|0)+(ee>>>16)|0)+(te>>>16)|0;L=te<<16|$&65535;$=(a(r,k)|0)+(ie&65535)|0;ee=(a(f,k)|0)+(ie>>>16)|0;te=((a(r,M)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(f,M)|0)+(ee>>>16)|0)+(te>>>16)|0;F=te<<16|$&65535;q=ie;$=(a(s,w)|0)+(F&65535)|0;ee=(a(p,w)|0)+(F>>>16)|0;te=((a(s,I)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(p,I)|0)+(ee>>>16)|0)+(te>>>16)|0;F=te<<16|$&65535;$=((a(s,k)|0)+(q&65535)|0)+(ie&65535)|0;ee=((a(p,k)|0)+(q>>>16)|0)+(ie>>>16)|0;te=((a(s,M)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(p,M)|0)+(ee>>>16)|0)+(te>>>16)|0;q=te<<16|$&65535;U=ie;ae=i[(pe|8)>>2]|0;$=(ae&65535)+((L&65535)<<1)|0;te=((ae>>>16)+(L>>>16<<1)|0)+($>>>16)|0;i[(pe|8)>>2]=te<<16|$&65535;ne=te>>>16;ae=i[(pe|12)>>2]|0;$=((ae&65535)+((F&65535)<<1)|0)+ne|0;te=((ae>>>16)+(F>>>16<<1)|0)+($>>>16)|0;i[(pe|12)>>2]=te<<16|$&65535;ne=te>>>16;ae=i[(pe|16)>>2]|0;$=((ae&65535)+((q&65535)<<1)|0)+ne|0;te=((ae>>>16)+(q>>>16<<1)|0)+($>>>16)|0;i[(pe|16)>>2]=te<<16|$&65535;ne=te>>>16;ae=i[(pe|20)>>2]|0;$=((ae&65535)+((U&65535)<<1)|0)+ne|0;te=((ae>>>16)+(U>>>16<<1)|0)+($>>>16)|0;i[(pe|20)>>2]=te<<16|$&65535;ne=te>>>16;for(de=24;!!ne&(de|0)<32;de=de+4|0){ae=i[(pe|de)>>2]|0;$=(ae&65535)+ne|0;te=(ae>>>16)+($>>>16)|0;i[(pe|de)>>2]=te<<16|$&65535;ne=te>>>16}}for(ce=0;(ce|0)<(t|0);ce=ce+32|0){he=e+ce|0,pe=n+(ce<<1)|0;f=i[he>>2]|0,r=f&65535,f=f>>>16,p=i[(he|4)>>2]|0,s=p&65535,p=p>>>16,m=i[(he|8)>>2]|0,o=m&65535,m=m>>>16,g=i[(he|12)>>2]|0,c=g&65535,g=g>>>16;I=i[(he|16)>>2]|0,w=I&65535,I=I>>>16,M=i[(he|20)>>2]|0,k=M&65535,M=M>>>16,D=i[(he|24)>>2]|0,E=D&65535,D=D>>>16,x=i[(he|28)>>2]|0,A=x&65535,x=x>>>16;$=a(r,w)|0;ee=a(f,w)|0;te=((a(r,I)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(f,I)|0)+(ee>>>16)|0)+(te>>>16)|0;L=te<<16|$&65535;$=(a(r,k)|0)+(ie&65535)|0;ee=(a(f,k)|0)+(ie>>>16)|0;te=((a(r,M)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(f,M)|0)+(ee>>>16)|0)+(te>>>16)|0;F=te<<16|$&65535;$=(a(r,E)|0)+(ie&65535)|0;ee=(a(f,E)|0)+(ie>>>16)|0;te=((a(r,D)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(f,D)|0)+(ee>>>16)|0)+(te>>>16)|0;q=te<<16|$&65535;$=(a(r,A)|0)+(ie&65535)|0;ee=(a(f,A)|0)+(ie>>>16)|0;te=((a(r,x)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(f,x)|0)+(ee>>>16)|0)+(te>>>16)|0;U=te<<16|$&65535;H=ie;$=(a(s,w)|0)+(F&65535)|0;ee=(a(p,w)|0)+(F>>>16)|0;te=((a(s,I)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(p,I)|0)+(ee>>>16)|0)+(te>>>16)|0;F=te<<16|$&65535;$=((a(s,k)|0)+(q&65535)|0)+(ie&65535)|0;ee=((a(p,k)|0)+(q>>>16)|0)+(ie>>>16)|0;te=((a(s,M)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(p,M)|0)+(ee>>>16)|0)+(te>>>16)|0;q=te<<16|$&65535;$=((a(s,E)|0)+(U&65535)|0)+(ie&65535)|0;ee=((a(p,E)|0)+(U>>>16)|0)+(ie>>>16)|0;te=((a(s,D)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(p,D)|0)+(ee>>>16)|0)+(te>>>16)|0;U=te<<16|$&65535;$=((a(s,A)|0)+(H&65535)|0)+(ie&65535)|0;ee=((a(p,A)|0)+(H>>>16)|0)+(ie>>>16)|0;te=((a(s,x)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(p,x)|0)+(ee>>>16)|0)+(te>>>16)|0;H=te<<16|$&65535;j=ie;$=(a(o,w)|0)+(q&65535)|0;ee=(a(m,w)|0)+(q>>>16)|0;te=((a(o,I)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(m,I)|0)+(ee>>>16)|0)+(te>>>16)|0;q=te<<16|$&65535;$=((a(o,k)|0)+(U&65535)|0)+(ie&65535)|0;ee=((a(m,k)|0)+(U>>>16)|0)+(ie>>>16)|0;te=((a(o,M)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(m,M)|0)+(ee>>>16)|0)+(te>>>16)|0;U=te<<16|$&65535;$=((a(o,E)|0)+(H&65535)|0)+(ie&65535)|0;ee=((a(m,E)|0)+(H>>>16)|0)+(ie>>>16)|0;te=((a(o,D)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(m,D)|0)+(ee>>>16)|0)+(te>>>16)|0;H=te<<16|$&65535;$=((a(o,A)|0)+(j&65535)|0)+(ie&65535)|0;ee=((a(m,A)|0)+(j>>>16)|0)+(ie>>>16)|0;te=((a(o,x)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(m,x)|0)+(ee>>>16)|0)+(te>>>16)|0;j=te<<16|$&65535;J=ie;$=(a(c,w)|0)+(U&65535)|0;ee=(a(g,w)|0)+(U>>>16)|0;te=((a(c,I)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(g,I)|0)+(ee>>>16)|0)+(te>>>16)|0;U=te<<16|$&65535;$=((a(c,k)|0)+(H&65535)|0)+(ie&65535)|0;ee=((a(g,k)|0)+(H>>>16)|0)+(ie>>>16)|0;te=((a(c,M)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(g,M)|0)+(ee>>>16)|0)+(te>>>16)|0;H=te<<16|$&65535;$=((a(c,E)|0)+(j&65535)|0)+(ie&65535)|0;ee=((a(g,E)|0)+(j>>>16)|0)+(ie>>>16)|0;te=((a(c,D)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(g,D)|0)+(ee>>>16)|0)+(te>>>16)|0;j=te<<16|$&65535;$=((a(c,A)|0)+(J&65535)|0)+(ie&65535)|0;ee=((a(g,A)|0)+(J>>>16)|0)+(ie>>>16)|0;te=((a(c,x)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(g,x)|0)+(ee>>>16)|0)+(te>>>16)|0;J=te<<16|$&65535;G=ie;ae=i[(pe|16)>>2]|0;$=(ae&65535)+((L&65535)<<1)|0;te=((ae>>>16)+(L>>>16<<1)|0)+($>>>16)|0;i[(pe|16)>>2]=te<<16|$&65535;ne=te>>>16;ae=i[(pe|20)>>2]|0;$=((ae&65535)+((F&65535)<<1)|0)+ne|0;te=((ae>>>16)+(F>>>16<<1)|0)+($>>>16)|0;i[(pe|20)>>2]=te<<16|$&65535;ne=te>>>16;ae=i[(pe|24)>>2]|0;$=((ae&65535)+((q&65535)<<1)|0)+ne|0;te=((ae>>>16)+(q>>>16<<1)|0)+($>>>16)|0;i[(pe|24)>>2]=te<<16|$&65535;ne=te>>>16;ae=i[(pe|28)>>2]|0;$=((ae&65535)+((U&65535)<<1)|0)+ne|0;te=((ae>>>16)+(U>>>16<<1)|0)+($>>>16)|0;i[(pe|28)>>2]=te<<16|$&65535;ne=te>>>16;ae=i[pe+32>>2]|0;$=((ae&65535)+((H&65535)<<1)|0)+ne|0;te=((ae>>>16)+(H>>>16<<1)|0)+($>>>16)|0;i[pe+32>>2]=te<<16|$&65535;ne=te>>>16;ae=i[pe+36>>2]|0;$=((ae&65535)+((j&65535)<<1)|0)+ne|0;te=((ae>>>16)+(j>>>16<<1)|0)+($>>>16)|0;i[pe+36>>2]=te<<16|$&65535;ne=te>>>16;ae=i[pe+40>>2]|0;$=((ae&65535)+((J&65535)<<1)|0)+ne|0;te=((ae>>>16)+(J>>>16<<1)|0)+($>>>16)|0;i[pe+40>>2]=te<<16|$&65535;ne=te>>>16;ae=i[pe+44>>2]|0;$=((ae&65535)+((G&65535)<<1)|0)+ne|0;te=((ae>>>16)+(G>>>16<<1)|0)+($>>>16)|0;i[pe+44>>2]=te<<16|$&65535;ne=te>>>16;for(de=48;!!ne&(de|0)<64;de=de+4|0){ae=i[pe+de>>2]|0;$=(ae&65535)+ne|0;te=(ae>>>16)+($>>>16)|0;i[pe+de>>2]=te<<16|$&65535;ne=te>>>16}}for(se=32;(se|0)<(t|0);se=se<<1){oe=se<<1;for(ce=0;(ce|0)<(t|0);ce=ce+oe|0){pe=n+(ce<<1)|0;re=0;for(le=0;(le|0)<(se|0);le=le+32|0){he=(e+ce|0)+le|0;f=i[he>>2]|0,r=f&65535,f=f>>>16,p=i[(he|4)>>2]|0,s=p&65535,p=p>>>16,m=i[(he|8)>>2]|0,o=m&65535,m=m>>>16,g=i[(he|12)>>2]|0,c=g&65535,g=g>>>16,y=i[(he|16)>>2]|0,l=y&65535,y=y>>>16,b=i[(he|20)>>2]|0,u=b&65535,b=b>>>16,v=i[(he|24)>>2]|0,d=v&65535,v=v>>>16,_=i[(he|28)>>2]|0,h=_&65535,_=_>>>16;z=W=V=K=X=Z=Q=Y=ne=0;for(ue=0;(ue|0)<(se|0);ue=ue+32|0){fe=((e+ce|0)+se|0)+ue|0;I=i[fe>>2]|0,w=I&65535,I=I>>>16,M=i[(fe|4)>>2]|0,k=M&65535,M=M>>>16,D=i[(fe|8)>>2]|0,E=D&65535,D=D>>>16,x=i[(fe|12)>>2]|0,A=x&65535,x=x>>>16,O=i[(fe|16)>>2]|0,T=O&65535,O=O>>>16,P=i[(fe|20)>>2]|0,S=P&65535,P=P>>>16,B=i[(fe|24)>>2]|0,N=B&65535,B=B>>>16,R=i[(fe|28)>>2]|0,C=R&65535,R=R>>>16;L=F=q=U=H=j=J=G=0;$=((a(r,w)|0)+(L&65535)|0)+(z&65535)|0;ee=((a(f,w)|0)+(L>>>16)|0)+(z>>>16)|0;te=((a(r,I)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(f,I)|0)+(ee>>>16)|0)+(te>>>16)|0;L=te<<16|$&65535;$=((a(r,k)|0)+(F&65535)|0)+(ie&65535)|0;ee=((a(f,k)|0)+(F>>>16)|0)+(ie>>>16)|0;te=((a(r,M)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(f,M)|0)+(ee>>>16)|0)+(te>>>16)|0;F=te<<16|$&65535;$=((a(r,E)|0)+(q&65535)|0)+(ie&65535)|0;ee=((a(f,E)|0)+(q>>>16)|0)+(ie>>>16)|0;te=((a(r,D)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(f,D)|0)+(ee>>>16)|0)+(te>>>16)|0;q=te<<16|$&65535;$=((a(r,A)|0)+(U&65535)|0)+(ie&65535)|0;ee=((a(f,A)|0)+(U>>>16)|0)+(ie>>>16)|0;te=((a(r,x)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(f,x)|0)+(ee>>>16)|0)+(te>>>16)|0;U=te<<16|$&65535;$=((a(r,T)|0)+(H&65535)|0)+(ie&65535)|0;ee=((a(f,T)|0)+(H>>>16)|0)+(ie>>>16)|0;te=((a(r,O)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(f,O)|0)+(ee>>>16)|0)+(te>>>16)|0;H=te<<16|$&65535;$=((a(r,S)|0)+(j&65535)|0)+(ie&65535)|0;ee=((a(f,S)|0)+(j>>>16)|0)+(ie>>>16)|0;te=((a(r,P)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(f,P)|0)+(ee>>>16)|0)+(te>>>16)|0;j=te<<16|$&65535;$=((a(r,N)|0)+(J&65535)|0)+(ie&65535)|0;ee=((a(f,N)|0)+(J>>>16)|0)+(ie>>>16)|0;te=((a(r,B)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(f,B)|0)+(ee>>>16)|0)+(te>>>16)|0;J=te<<16|$&65535;$=((a(r,C)|0)+(G&65535)|0)+(ie&65535)|0;ee=((a(f,C)|0)+(G>>>16)|0)+(ie>>>16)|0;te=((a(r,R)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(f,R)|0)+(ee>>>16)|0)+(te>>>16)|0;G=te<<16|$&65535;z=ie;$=((a(s,w)|0)+(F&65535)|0)+(W&65535)|0;ee=((a(p,w)|0)+(F>>>16)|0)+(W>>>16)|0;te=((a(s,I)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(p,I)|0)+(ee>>>16)|0)+(te>>>16)|0;F=te<<16|$&65535;$=((a(s,k)|0)+(q&65535)|0)+(ie&65535)|0;ee=((a(p,k)|0)+(q>>>16)|0)+(ie>>>16)|0;te=((a(s,M)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(p,M)|0)+(ee>>>16)|0)+(te>>>16)|0;q=te<<16|$&65535;$=((a(s,E)|0)+(U&65535)|0)+(ie&65535)|0;ee=((a(p,E)|0)+(U>>>16)|0)+(ie>>>16)|0;te=((a(s,D)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(p,D)|0)+(ee>>>16)|0)+(te>>>16)|0;U=te<<16|$&65535;$=((a(s,A)|0)+(H&65535)|0)+(ie&65535)|0;ee=((a(p,A)|0)+(H>>>16)|0)+(ie>>>16)|0;te=((a(s,x)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(p,x)|0)+(ee>>>16)|0)+(te>>>16)|0;H=te<<16|$&65535;$=((a(s,T)|0)+(j&65535)|0)+(ie&65535)|0;ee=((a(p,T)|0)+(j>>>16)|0)+(ie>>>16)|0;te=((a(s,O)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(p,O)|0)+(ee>>>16)|0)+(te>>>16)|0;j=te<<16|$&65535;$=((a(s,S)|0)+(J&65535)|0)+(ie&65535)|0;ee=((a(p,S)|0)+(J>>>16)|0)+(ie>>>16)|0;te=((a(s,P)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(p,P)|0)+(ee>>>16)|0)+(te>>>16)|0;J=te<<16|$&65535;$=((a(s,N)|0)+(G&65535)|0)+(ie&65535)|0;ee=((a(p,N)|0)+(G>>>16)|0)+(ie>>>16)|0;te=((a(s,B)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(p,B)|0)+(ee>>>16)|0)+(te>>>16)|0;G=te<<16|$&65535;$=((a(s,C)|0)+(z&65535)|0)+(ie&65535)|0;ee=((a(p,C)|0)+(z>>>16)|0)+(ie>>>16)|0;te=((a(s,R)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(p,R)|0)+(ee>>>16)|0)+(te>>>16)|0;z=te<<16|$&65535;W=ie;$=((a(o,w)|0)+(q&65535)|0)+(V&65535)|0;ee=((a(m,w)|0)+(q>>>16)|0)+(V>>>16)|0;te=((a(o,I)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(m,I)|0)+(ee>>>16)|0)+(te>>>16)|0;q=te<<16|$&65535;$=((a(o,k)|0)+(U&65535)|0)+(ie&65535)|0;ee=((a(m,k)|0)+(U>>>16)|0)+(ie>>>16)|0;te=((a(o,M)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(m,M)|0)+(ee>>>16)|0)+(te>>>16)|0;U=te<<16|$&65535;$=((a(o,E)|0)+(H&65535)|0)+(ie&65535)|0;ee=((a(m,E)|0)+(H>>>16)|0)+(ie>>>16)|0;te=((a(o,D)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(m,D)|0)+(ee>>>16)|0)+(te>>>16)|0;H=te<<16|$&65535;$=((a(o,A)|0)+(j&65535)|0)+(ie&65535)|0;ee=((a(m,A)|0)+(j>>>16)|0)+(ie>>>16)|0;te=((a(o,x)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(m,x)|0)+(ee>>>16)|0)+(te>>>16)|0;j=te<<16|$&65535;$=((a(o,T)|0)+(J&65535)|0)+(ie&65535)|0;ee=((a(m,T)|0)+(J>>>16)|0)+(ie>>>16)|0;te=((a(o,O)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(m,O)|0)+(ee>>>16)|0)+(te>>>16)|0;J=te<<16|$&65535;$=((a(o,S)|0)+(G&65535)|0)+(ie&65535)|0;ee=((a(m,S)|0)+(G>>>16)|0)+(ie>>>16)|0;te=((a(o,P)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(m,P)|0)+(ee>>>16)|0)+(te>>>16)|0;G=te<<16|$&65535;$=((a(o,N)|0)+(z&65535)|0)+(ie&65535)|0;ee=((a(m,N)|0)+(z>>>16)|0)+(ie>>>16)|0;te=((a(o,B)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(m,B)|0)+(ee>>>16)|0)+(te>>>16)|0;z=te<<16|$&65535;$=((a(o,C)|0)+(W&65535)|0)+(ie&65535)|0;ee=((a(m,C)|0)+(W>>>16)|0)+(ie>>>16)|0;te=((a(o,R)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(m,R)|0)+(ee>>>16)|0)+(te>>>16)|0;W=te<<16|$&65535;V=ie;$=((a(c,w)|0)+(U&65535)|0)+(K&65535)|0;ee=((a(g,w)|0)+(U>>>16)|0)+(K>>>16)|0;te=((a(c,I)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(g,I)|0)+(ee>>>16)|0)+(te>>>16)|0;U=te<<16|$&65535;$=((a(c,k)|0)+(H&65535)|0)+(ie&65535)|0;ee=((a(g,k)|0)+(H>>>16)|0)+(ie>>>16)|0;te=((a(c,M)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(g,M)|0)+(ee>>>16)|0)+(te>>>16)|0;H=te<<16|$&65535;$=((a(c,E)|0)+(j&65535)|0)+(ie&65535)|0;ee=((a(g,E)|0)+(j>>>16)|0)+(ie>>>16)|0;te=((a(c,D)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(g,D)|0)+(ee>>>16)|0)+(te>>>16)|0;j=te<<16|$&65535;$=((a(c,A)|0)+(J&65535)|0)+(ie&65535)|0;ee=((a(g,A)|0)+(J>>>16)|0)+(ie>>>16)|0;te=((a(c,x)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(g,x)|0)+(ee>>>16)|0)+(te>>>16)|0;J=te<<16|$&65535;$=((a(c,T)|0)+(G&65535)|0)+(ie&65535)|0;ee=((a(g,T)|0)+(G>>>16)|0)+(ie>>>16)|0;te=((a(c,O)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(g,O)|0)+(ee>>>16)|0)+(te>>>16)|0;G=te<<16|$&65535;$=((a(c,S)|0)+(z&65535)|0)+(ie&65535)|0;ee=((a(g,S)|0)+(z>>>16)|0)+(ie>>>16)|0;te=((a(c,P)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(g,P)|0)+(ee>>>16)|0)+(te>>>16)|0;z=te<<16|$&65535;$=((a(c,N)|0)+(W&65535)|0)+(ie&65535)|0;ee=((a(g,N)|0)+(W>>>16)|0)+(ie>>>16)|0;te=((a(c,B)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(g,B)|0)+(ee>>>16)|0)+(te>>>16)|0;W=te<<16|$&65535;$=((a(c,C)|0)+(V&65535)|0)+(ie&65535)|0;ee=((a(g,C)|0)+(V>>>16)|0)+(ie>>>16)|0;te=((a(c,R)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(g,R)|0)+(ee>>>16)|0)+(te>>>16)|0;V=te<<16|$&65535;K=ie;$=((a(l,w)|0)+(H&65535)|0)+(X&65535)|0;ee=((a(y,w)|0)+(H>>>16)|0)+(X>>>16)|0;te=((a(l,I)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(y,I)|0)+(ee>>>16)|0)+(te>>>16)|0;H=te<<16|$&65535;$=((a(l,k)|0)+(j&65535)|0)+(ie&65535)|0;ee=((a(y,k)|0)+(j>>>16)|0)+(ie>>>16)|0;te=((a(l,M)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(y,M)|0)+(ee>>>16)|0)+(te>>>16)|0;j=te<<16|$&65535;$=((a(l,E)|0)+(J&65535)|0)+(ie&65535)|0;ee=((a(y,E)|0)+(J>>>16)|0)+(ie>>>16)|0;te=((a(l,D)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(y,D)|0)+(ee>>>16)|0)+(te>>>16)|0;J=te<<16|$&65535;$=((a(l,A)|0)+(G&65535)|0)+(ie&65535)|0;ee=((a(y,A)|0)+(G>>>16)|0)+(ie>>>16)|0;te=((a(l,x)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(y,x)|0)+(ee>>>16)|0)+(te>>>16)|0;G=te<<16|$&65535;$=((a(l,T)|0)+(z&65535)|0)+(ie&65535)|0;ee=((a(y,T)|0)+(z>>>16)|0)+(ie>>>16)|0;te=((a(l,O)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(y,O)|0)+(ee>>>16)|0)+(te>>>16)|0;z=te<<16|$&65535;$=((a(l,S)|0)+(W&65535)|0)+(ie&65535)|0;ee=((a(y,S)|0)+(W>>>16)|0)+(ie>>>16)|0;te=((a(l,P)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(y,P)|0)+(ee>>>16)|0)+(te>>>16)|0;W=te<<16|$&65535;$=((a(l,N)|0)+(V&65535)|0)+(ie&65535)|0;ee=((a(y,N)|0)+(V>>>16)|0)+(ie>>>16)|0;te=((a(l,B)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(y,B)|0)+(ee>>>16)|0)+(te>>>16)|0;V=te<<16|$&65535;$=((a(l,C)|0)+(K&65535)|0)+(ie&65535)|0;ee=((a(y,C)|0)+(K>>>16)|0)+(ie>>>16)|0;te=((a(l,R)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(y,R)|0)+(ee>>>16)|0)+(te>>>16)|0;K=te<<16|$&65535;X=ie;$=((a(u,w)|0)+(j&65535)|0)+(Z&65535)|0;ee=((a(b,w)|0)+(j>>>16)|0)+(Z>>>16)|0;te=((a(u,I)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(b,I)|0)+(ee>>>16)|0)+(te>>>16)|0;j=te<<16|$&65535;$=((a(u,k)|0)+(J&65535)|0)+(ie&65535)|0;ee=((a(b,k)|0)+(J>>>16)|0)+(ie>>>16)|0;te=((a(u,M)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(b,M)|0)+(ee>>>16)|0)+(te>>>16)|0;J=te<<16|$&65535;$=((a(u,E)|0)+(G&65535)|0)+(ie&65535)|0;ee=((a(b,E)|0)+(G>>>16)|0)+(ie>>>16)|0;te=((a(u,D)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(b,D)|0)+(ee>>>16)|0)+(te>>>16)|0;G=te<<16|$&65535;$=((a(u,A)|0)+(z&65535)|0)+(ie&65535)|0;ee=((a(b,A)|0)+(z>>>16)|0)+(ie>>>16)|0;te=((a(u,x)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(b,x)|0)+(ee>>>16)|0)+(te>>>16)|0;z=te<<16|$&65535;$=((a(u,T)|0)+(W&65535)|0)+(ie&65535)|0;ee=((a(b,T)|0)+(W>>>16)|0)+(ie>>>16)|0;te=((a(u,O)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(b,O)|0)+(ee>>>16)|0)+(te>>>16)|0;W=te<<16|$&65535;$=((a(u,S)|0)+(V&65535)|0)+(ie&65535)|0;ee=((a(b,S)|0)+(V>>>16)|0)+(ie>>>16)|0;te=((a(u,P)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(b,P)|0)+(ee>>>16)|0)+(te>>>16)|0;V=te<<16|$&65535;$=((a(u,N)|0)+(K&65535)|0)+(ie&65535)|0;ee=((a(b,N)|0)+(K>>>16)|0)+(ie>>>16)|0;te=((a(u,B)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(b,B)|0)+(ee>>>16)|0)+(te>>>16)|0;K=te<<16|$&65535;$=((a(u,C)|0)+(X&65535)|0)+(ie&65535)|0;ee=((a(b,C)|0)+(X>>>16)|0)+(ie>>>16)|0;te=((a(u,R)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(b,R)|0)+(ee>>>16)|0)+(te>>>16)|0;X=te<<16|$&65535;Z=ie;$=((a(d,w)|0)+(J&65535)|0)+(Q&65535)|0;ee=((a(v,w)|0)+(J>>>16)|0)+(Q>>>16)|0;te=((a(d,I)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(v,I)|0)+(ee>>>16)|0)+(te>>>16)|0;J=te<<16|$&65535;$=((a(d,k)|0)+(G&65535)|0)+(ie&65535)|0;ee=((a(v,k)|0)+(G>>>16)|0)+(ie>>>16)|0;te=((a(d,M)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(v,M)|0)+(ee>>>16)|0)+(te>>>16)|0;G=te<<16|$&65535;$=((a(d,E)|0)+(z&65535)|0)+(ie&65535)|0;ee=((a(v,E)|0)+(z>>>16)|0)+(ie>>>16)|0;te=((a(d,D)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(v,D)|0)+(ee>>>16)|0)+(te>>>16)|0;z=te<<16|$&65535;$=((a(d,A)|0)+(W&65535)|0)+(ie&65535)|0;ee=((a(v,A)|0)+(W>>>16)|0)+(ie>>>16)|0;te=((a(d,x)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(v,x)|0)+(ee>>>16)|0)+(te>>>16)|0;W=te<<16|$&65535;$=((a(d,T)|0)+(V&65535)|0)+(ie&65535)|0;ee=((a(v,T)|0)+(V>>>16)|0)+(ie>>>16)|0;te=((a(d,O)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(v,O)|0)+(ee>>>16)|0)+(te>>>16)|0;V=te<<16|$&65535;$=((a(d,S)|0)+(K&65535)|0)+(ie&65535)|0;ee=((a(v,S)|0)+(K>>>16)|0)+(ie>>>16)|0;te=((a(d,P)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(v,P)|0)+(ee>>>16)|0)+(te>>>16)|0;K=te<<16|$&65535;$=((a(d,N)|0)+(X&65535)|0)+(ie&65535)|0;ee=((a(v,N)|0)+(X>>>16)|0)+(ie>>>16)|0;te=((a(d,B)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(v,B)|0)+(ee>>>16)|0)+(te>>>16)|0;X=te<<16|$&65535;$=((a(d,C)|0)+(Z&65535)|0)+(ie&65535)|0;ee=((a(v,C)|0)+(Z>>>16)|0)+(ie>>>16)|0;te=((a(d,R)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(v,R)|0)+(ee>>>16)|0)+(te>>>16)|0;Z=te<<16|$&65535;Q=ie;$=((a(h,w)|0)+(G&65535)|0)+(Y&65535)|0;ee=((a(_,w)|0)+(G>>>16)|0)+(Y>>>16)|0;te=((a(h,I)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(_,I)|0)+(ee>>>16)|0)+(te>>>16)|0;G=te<<16|$&65535;$=((a(h,k)|0)+(z&65535)|0)+(ie&65535)|0;ee=((a(_,k)|0)+(z>>>16)|0)+(ie>>>16)|0;te=((a(h,M)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(_,M)|0)+(ee>>>16)|0)+(te>>>16)|0;z=te<<16|$&65535;$=((a(h,E)|0)+(W&65535)|0)+(ie&65535)|0;ee=((a(_,E)|0)+(W>>>16)|0)+(ie>>>16)|0;te=((a(h,D)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(_,D)|0)+(ee>>>16)|0)+(te>>>16)|0;W=te<<16|$&65535;$=((a(h,A)|0)+(V&65535)|0)+(ie&65535)|0;ee=((a(_,A)|0)+(V>>>16)|0)+(ie>>>16)|0;te=((a(h,x)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(_,x)|0)+(ee>>>16)|0)+(te>>>16)|0;V=te<<16|$&65535;$=((a(h,T)|0)+(K&65535)|0)+(ie&65535)|0;ee=((a(_,T)|0)+(K>>>16)|0)+(ie>>>16)|0;te=((a(h,O)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(_,O)|0)+(ee>>>16)|0)+(te>>>16)|0;K=te<<16|$&65535;$=((a(h,S)|0)+(X&65535)|0)+(ie&65535)|0;ee=((a(_,S)|0)+(X>>>16)|0)+(ie>>>16)|0;te=((a(h,P)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(_,P)|0)+(ee>>>16)|0)+(te>>>16)|0;X=te<<16|$&65535;$=((a(h,N)|0)+(Z&65535)|0)+(ie&65535)|0;ee=((a(_,N)|0)+(Z>>>16)|0)+(ie>>>16)|0;te=((a(h,B)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(_,B)|0)+(ee>>>16)|0)+(te>>>16)|0;Z=te<<16|$&65535;$=((a(h,C)|0)+(Q&65535)|0)+(ie&65535)|0;ee=((a(_,C)|0)+(Q>>>16)|0)+(ie>>>16)|0;te=((a(h,R)|0)+(ee&65535)|0)+($>>>16)|0;ie=((a(_,R)|0)+(ee>>>16)|0)+(te>>>16)|0;Q=te<<16|$&65535;Y=ie;de=se+(le+ue|0)|0;ae=i[pe+de>>2]|0;$=((ae&65535)+((L&65535)<<1)|0)+ne|0;te=((ae>>>16)+(L>>>16<<1)|0)+($>>>16)|0;i[pe+de>>2]=te<<16|$&65535;ne=te>>>16;de=de+4|0;ae=i[pe+de>>2]|0;$=((ae&65535)+((F&65535)<<1)|0)+ne|0;te=((ae>>>16)+(F>>>16<<1)|0)+($>>>16)|0;i[pe+de>>2]=te<<16|$&65535;ne=te>>>16;de=de+4|0;ae=i[pe+de>>2]|0;$=((ae&65535)+((q&65535)<<1)|0)+ne|0;te=((ae>>>16)+(q>>>16<<1)|0)+($>>>16)|0;i[pe+de>>2]=te<<16|$&65535;ne=te>>>16;de=de+4|0;ae=i[pe+de>>2]|0;$=((ae&65535)+((U&65535)<<1)|0)+ne|0;te=((ae>>>16)+(U>>>16<<1)|0)+($>>>16)|0;i[pe+de>>2]=te<<16|$&65535;ne=te>>>16;de=de+4|0;ae=i[pe+de>>2]|0;$=((ae&65535)+((H&65535)<<1)|0)+ne|0;te=((ae>>>16)+(H>>>16<<1)|0)+($>>>16)|0;i[pe+de>>2]=te<<16|$&65535;ne=te>>>16;de=de+4|0;ae=i[pe+de>>2]|0;$=((ae&65535)+((j&65535)<<1)|0)+ne|0;te=((ae>>>16)+(j>>>16<<1)|0)+($>>>16)|0;i[pe+de>>2]=te<<16|$&65535;ne=te>>>16;de=de+4|0;ae=i[pe+de>>2]|0;$=((ae&65535)+((J&65535)<<1)|0)+ne|0;te=((ae>>>16)+(J>>>16<<1)|0)+($>>>16)|0;i[pe+de>>2]=te<<16|$&65535;ne=te>>>16;de=de+4|0;ae=i[pe+de>>2]|0;$=((ae&65535)+((G&65535)<<1)|0)+ne|0;te=((ae>>>16)+(G>>>16<<1)|0)+($>>>16)|0;i[pe+de>>2]=te<<16|$&65535;ne=te>>>16}de=se+(le+ue|0)|0;ae=i[pe+de>>2]|0;$=(((ae&65535)+((z&65535)<<1)|0)+ne|0)+re|0;te=((ae>>>16)+(z>>>16<<1)|0)+($>>>16)|0;i[pe+de>>2]=te<<16|$&65535;ne=te>>>16;de=de+4|0;ae=i[pe+de>>2]|0;$=((ae&65535)+((W&65535)<<1)|0)+ne|0;te=((ae>>>16)+(W>>>16<<1)|0)+($>>>16)|0;i[pe+de>>2]=te<<16|$&65535;ne=te>>>16;de=de+4|0;ae=i[pe+de>>2]|0;$=((ae&65535)+((V&65535)<<1)|0)+ne|0;te=((ae>>>16)+(V>>>16<<1)|0)+($>>>16)|0;i[pe+de>>2]=te<<16|$&65535;ne=te>>>16;de=de+4|0;ae=i[pe+de>>2]|0;$=((ae&65535)+((K&65535)<<1)|0)+ne|0;te=((ae>>>16)+(K>>>16<<1)|0)+($>>>16)|0;i[pe+de>>2]=te<<16|$&65535;ne=te>>>16;de=de+4|0;ae=i[pe+de>>2]|0;$=((ae&65535)+((X&65535)<<1)|0)+ne|0;te=((ae>>>16)+(X>>>16<<1)|0)+($>>>16)|0;i[pe+de>>2]=te<<16|$&65535;ne=te>>>16;de=de+4|0;ae=i[pe+de>>2]|0;$=((ae&65535)+((Z&65535)<<1)|0)+ne|0;te=((ae>>>16)+(Z>>>16<<1)|0)+($>>>16)|0;i[pe+de>>2]=te<<16|$&65535;ne=te>>>16;de=de+4|0;ae=i[pe+de>>2]|0;$=((ae&65535)+((Q&65535)<<1)|0)+ne|0;te=((ae>>>16)+(Q>>>16<<1)|0)+($>>>16)|0;i[pe+de>>2]=te<<16|$&65535;ne=te>>>16;de=de+4|0;ae=i[pe+de>>2]|0;$=((ae&65535)+((Y&65535)<<1)|0)+ne|0;te=((ae>>>16)+(Y>>>16<<1)|0)+($>>>16)|0;i[pe+de>>2]=te<<16|$&65535;re=te>>>16}for(de=de+4|0;!!re&(de|0)<oe<<1;de=de+4|0){ae=i[pe+de>>2]|0;$=(ae&65535)+re|0;te=(ae>>>16)+($>>>16)|0;i[pe+de>>2]=te<<16|$&65535;re=te>>>16}}}}function b(e,t,n,r,s){e=e|0;t=t|0;n=n|0;r=r|0;s=s|0;var o=0,c=0,l=0,u=0,d=0,h=0,f=0,p=0,m=0,g=0,y=0,b=0,v=0,_=0,w=0,k=0,E=0,A=0,T=0;for(E=t-1&-4;(E|0)>=0;E=E-4|0){o=i[e+E>>2]|0;if(o){t=E;break}}for(E=r-1&-4;(E|0)>=0;E=E-4|0){c=i[n+E>>2]|0;if(c){r=E;break}}while((c&2147483648)==0){c=c<<1;l=l+1|0}d=i[e+t>>2]|0;if(l){u=d>>>(32-l|0);for(E=t-4|0;(E|0)>=0;E=E-4|0){o=i[e+E>>2]|0;i[e+E+4>>2]=d<<l|(l?o>>>(32-l|0):0);d=o}i[e>>2]=d<<l}if(l){h=i[n+r>>2]|0;for(E=r-4|0;(E|0)>=0;E=E-4|0){c=i[n+E>>2]|0;i[n+E+4>>2]=h<<l|c>>>(32-l|0);h=c}i[n>>2]=h<<l}h=i[n+r>>2]|0;f=h>>>16,p=h&65535;for(E=t;(E|0)>=(r|0);E=E-4|0){A=E-r|0;d=i[e+E>>2]|0;m=(u>>>0)/(f>>>0)|0,y=(u>>>0)%(f>>>0)|0,v=a(m,p)|0;while((m|0)==65536|v>>>0>(y<<16|d>>>16)>>>0){m=m-1|0,y=y+f|0,v=v-p|0;if((y|0)>=65536)break}w=0,k=0;for(T=0;(T|0)<=(r|0);T=T+4|0){c=i[n+T>>2]|0;v=(a(m,c&65535)|0)+(w>>>16)|0;_=(a(m,c>>>16)|0)+(v>>>16)|0;c=w&65535|v<<16;w=_;o=i[e+A+T>>2]|0;v=((o&65535)-(c&65535)|0)+k|0;_=((o>>>16)-(c>>>16)|0)+(v>>16)|0;i[e+A+T>>2]=_<<16|v&65535;k=_>>16}v=((u&65535)-(w&65535)|0)+k|0;_=((u>>>16)-(w>>>16)|0)+(v>>16)|0;u=_<<16|v&65535;k=_>>16;if(k){m=m-1|0;k=0;for(T=0;(T|0)<=(r|0);T=T+4|0){c=i[n+T>>2]|0;o=i[e+A+T>>2]|0;v=(o&65535)+k|0;_=(o>>>16)+c+(v>>>16)|0;i[e+A+T>>2]=_<<16|v&65535;k=_>>>16}u=u+k|0}d=i[e+E>>2]|0;o=u<<16|d>>>16;g=(o>>>0)/(f>>>0)|0,b=(o>>>0)%(f>>>0)|0,v=a(g,p)|0;while((g|0)==65536|v>>>0>(b<<16|d&65535)>>>0){g=g-1|0,b=b+f|0,v=v-p|0;if((b|0)>=65536)break}w=0,k=0;for(T=0;(T|0)<=(r|0);T=T+4|0){c=i[n+T>>2]|0;v=(a(g,c&65535)|0)+(w&65535)|0;_=((a(g,c>>>16)|0)+(v>>>16)|0)+(w>>>16)|0;c=v&65535|_<<16;w=_>>>16;o=i[e+A+T>>2]|0;v=((o&65535)-(c&65535)|0)+k|0;_=((o>>>16)-(c>>>16)|0)+(v>>16)|0;k=_>>16;i[e+A+T>>2]=_<<16|v&65535}v=((u&65535)-(w&65535)|0)+k|0;_=((u>>>16)-(w>>>16)|0)+(v>>16)|0;k=_>>16;if(k){g=g-1|0;k=0;for(T=0;(T|0)<=(r|0);T=T+4|0){c=i[n+T>>2]|0;o=i[e+A+T>>2]|0;v=((o&65535)+(c&65535)|0)+k|0;_=((o>>>16)+(c>>>16)|0)+(v>>>16)|0;k=_>>>16;i[e+A+T>>2]=v&65535|_<<16}}i[s+A>>2]=m<<16|g;u=i[e+E>>2]|0}if(l){d=i[e>>2]|0;for(E=4;(E|0)<=(r|0);E=E+4|0){o=i[e+E>>2]|0;i[e+E-4>>2]=o<<(32-l|0)|d>>>l;d=o}i[e+r>>2]=d>>>l}}function v(e,t,n,r,s,d){e=e|0;t=t|0;n=n|0;r=r|0;s=s|0;d=d|0;var f=0,p=0,g=0,y=0,b=0,v=0,_=0,w=0,k=0,E=0,A=0,T=0,S=0,N=0;f=o(r<<1)|0;u(r<<1,0,f);l(t,e,f);for(T=0;(T|0)<(r|0);T=T+4|0){g=i[f+T>>2]|0,y=g&65535,g=g>>>16;v=s>>>16,b=s&65535;_=a(y,b)|0,w=((a(y,v)|0)+(a(g,b)|0)|0)+(_>>>16)|0;y=_&65535,g=w&65535;A=0;for(S=0;(S|0)<(r|0);S=S+4|0){N=T+S|0;v=i[n+S>>2]|0,b=v&65535,v=v>>>16;E=i[f+N>>2]|0;_=((a(y,b)|0)+(A&65535)|0)+(E&65535)|0;w=((a(y,v)|0)+(A>>>16)|0)+(E>>>16)|0;k=((a(g,b)|0)+(w&65535)|0)+(_>>>16)|0;A=((a(g,v)|0)+(k>>>16)|0)+(w>>>16)|0;E=k<<16|_&65535;i[f+N>>2]=E}N=T+S|0;E=i[f+N>>2]|0;_=((E&65535)+(A&65535)|0)+p|0;w=((E>>>16)+(A>>>16)|0)+(_>>>16)|0;i[f+N>>2]=w<<16|_&65535;p=w>>>16}l(r,f+r|0,d);c(r<<1);if(p|(h(n,r,d,r)|0)<=0){m(d,r,n,r,d,r)|0}}return{sreset:s,salloc:o,sfree:c,z:u,tst:f,neg:d,cmp:h,add:p,sub:m,mul:g,sqr:y,div:b,mredc:v}}function et(e){return e instanceof tt}function tt(e){var t=Kn,n=0,r=0;if(m(e)&&(e=o(e)),g(e)&&(e=new Uint8Array(e)),void 0===e);else if(p(e)){var i=Math.abs(e);i>4294967295?(t=new Uint32Array(2),t[0]=0|i,t[1]=i/4294967296|0,n=52):i>0?(t=new Uint32Array(1),t[0]=i,n=32):(t=Kn,n=0),r=0>e?-1:1}else if(y(e)){if(n=8*e.length,!n)return Zn;t=new Uint32Array(n+31>>5);for(var a=e.length-4;a>=0;a-=4)t[e.length-4-a>>2]=e[a]<<24|e[a+1]<<16|e[a+2]<<8|e[a+3];-3===a?t[t.length-1]=e[0]:-2===a?t[t.length-1]=e[0]<<8|e[1]:-1===a&&(t[t.length-1]=e[0]<<16|e[1]<<8|e[2]),r=1}else{if("object"!=typeof e||null===e)throw new TypeError("number is of unexpected type");t=new Uint32Array(e.limbs),n=e.bitLength,r=e.sign}this.limbs=t,this.bitLength=n,this.sign=r}function nt(e){e=e||16;var t=this.limbs,n=this.bitLength,r="";if(16!==e)throw new a("bad radix");for(var i=(n+31>>5)-1;i>=0;i--){var s=t[i].toString(16);r+="00000000".substr(s.length),r+=s}return r=r.replace(/^0+/,""),r.length||(r="0"),this.sign<0&&(r="-"+r),r}function rt(){var e=this.bitLength,t=this.limbs;if(0===e)return new Uint8Array(0);for(var n=e+7>>3,r=new Uint8Array(n),i=0;n>i;i++){var a=n-i-1;r[i]=t[a>>2]>>((3&a)<<3)}return r}function it(){var e=this.limbs,t=this.bitLength,n=this.sign;if(!n)return 0;if(32>=t)return n*(e[0]>>>0);if(52>=t)return n*(4294967296*(e[1]>>>0)+(e[0]>>>0));var r,i,a=0;for(r=e.length-1;r>=0;r--)if(0!==(i=e[r])){for(;0===(i<<a&2147483648);)a++;break}return 0===r?n*(e[0]>>>0):n*(1048576*((e[r]<<a|(a?e[r-1]>>>32-a:0))>>>0)+((e[r-1]<<a|(a&&r>1?e[r-2]>>>32-a:0))>>>12))*Math.pow(2,32*r-a-52)}function at(e){var t=this.limbs,n=this.bitLength;if(e>=n)return this;var r=new tt,i=e+31>>5,a=e%32;return r.limbs=new Uint32Array(t.subarray(0,i)),r.bitLength=e,r.sign=this.sign,a&&(r.limbs[i-1]&=-1>>>32-a),r}function st(e,t){if(!p(e))throw new TypeError("TODO");if(void 0!==t&&!p(t))throw new TypeError("TODO");var n=this.limbs,r=this.bitLength;if(0>e)throw new RangeError("TODO");if(e>=r)return Zn;(void 0===t||t>r-e)&&(t=r-e);var i,a=new tt,s=e>>5,o=e+t+31>>5,c=t+31>>5,l=e%32,u=t%32;if(i=new Uint32Array(c),l){for(var d=0;o-s-1>d;d++)i[d]=n[s+d]>>>l|n[s+d+1]<<32-l;i[d]=n[s+d]>>>l}else i.set(n.subarray(s,o));return u&&(i[c-1]&=-1>>>32-u),a.limbs=i,a.bitLength=t,a.sign=this.sign,a}function ot(){var e=new tt;return e.limbs=this.limbs,e.bitLength=this.bitLength,e.sign=-1*this.sign,e}function ct(e){et(e)||(e=new tt(e));var t=this.limbs,n=t.length,r=e.limbs,i=r.length,a=0;return this.sign<e.sign?-1:this.sign>e.sign?1:(Vn.set(t,0),Vn.set(r,n),a=$e.cmp(0,n<<2,n<<2,i<<2),a*this.sign)}function lt(e){if(et(e)||(e=new tt(e)),!this.sign)return e;if(!e.sign)return this;var t,n,r,i,a=this.bitLength,s=this.limbs,o=s.length,c=this.sign,l=e.bitLength,u=e.limbs,d=u.length,h=e.sign,f=new tt;t=(a>l?a:l)+(c*h>0?1:0),n=t+31>>5,$e.sreset();var p=$e.salloc(o<<2),m=$e.salloc(d<<2),g=$e.salloc(n<<2);return $e.z(g-p+(n<<2),0,p),Vn.set(s,p>>2),Vn.set(u,m>>2),c*h>0?($e.add(p,o<<2,m,d<<2,g,n<<2),r=c):c>h?(i=$e.sub(p,o<<2,m,d<<2,g,n<<2),r=i?h:c):(i=$e.sub(m,d<<2,p,o<<2,g,n<<2),r=i?c:h),i&&$e.neg(g,n<<2,g,n<<2),0===$e.tst(g,n<<2)?Zn:(f.limbs=new Uint32Array(Vn.subarray(g>>2,(g>>2)+n)),f.bitLength=t,f.sign=r,f)}function ut(e){return et(e)||(e=new tt(e)),this.add(e.negate())}function dt(e){if(et(e)||(e=new tt(e)),!this.sign||!e.sign)return Zn;var t,n,r=this.bitLength,i=this.limbs,a=i.length,s=e.bitLength,o=e.limbs,c=o.length,l=new tt;t=r+s,n=t+31>>5,$e.sreset();var u=$e.salloc(a<<2),d=$e.salloc(c<<2),h=$e.salloc(n<<2);return $e.z(h-u+(n<<2),0,u),Vn.set(i,u>>2),Vn.set(o,d>>2),$e.mul(u,a<<2,d,c<<2,h,n<<2),l.limbs=new Uint32Array(Vn.subarray(h>>2,(h>>2)+n)),l.sign=this.sign*e.sign,l.bitLength=t,l}function ht(){if(!this.sign)return Zn;var e,t,n=this.bitLength,r=this.limbs,i=r.length,a=new tt;e=n<<1,t=e+31>>5,$e.sreset();var s=$e.salloc(i<<2),o=$e.salloc(t<<2);return $e.z(o-s+(t<<2),0,s),Vn.set(r,s>>2),$e.sqr(s,i<<2,o),a.limbs=new Uint32Array(Vn.subarray(o>>2,(o>>2)+t)),a.bitLength=e,a.sign=1,a}function ft(e){et(e)||(e=new tt(e));var t,n,r=this.bitLength,i=this.limbs,a=i.length,s=e.bitLength,o=e.limbs,c=o.length,l=Zn,u=Zn;$e.sreset();var d=$e.salloc(a<<2),h=$e.salloc(c<<2),f=$e.salloc(a<<2);return $e.z(f-d+(a<<2),0,d),Vn.set(i,d>>2),Vn.set(o,h>>2),$e.div(d,a<<2,h,c<<2,f),t=$e.tst(f,a<<2)>>2,t&&(l=new tt,l.limbs=new Uint32Array(Vn.subarray(f>>2,(f>>2)+t)),l.bitLength=t<<5>r?r:t<<5,l.sign=this.sign*e.sign),n=$e.tst(d,c<<2)>>2,n&&(u=new tt,u.limbs=new Uint32Array(Vn.subarray(d>>2,(d>>2)+n)),u.bitLength=n<<5>s?s:n<<5,u.sign=this.sign),{quotient:l,remainder:u}}function pt(e,t){var n,r,i,a,s=0>e?-1:1,o=0>t?-1:1,c=1,l=0,u=0,d=1;for(e*=s,t*=o,a=t>e,a&&(i=e,e=t,t=i,i=s,s=o,o=i),r=Math.floor(e/t),n=e-r*t;n;)i=c-r*l,c=l,l=i,i=u-r*d,u=d,d=i,e=t,t=n,r=Math.floor(e/t),n=e-r*t;return l*=s,d*=o,a&&(i=l,l=d,d=i),{gcd:t,x:l,y:d}}function mt(e,t){
et(e)||(e=new tt(e)),et(t)||(t=new tt(t));var n=e.sign,r=t.sign;0>n&&(e=e.negate()),0>r&&(t=t.negate());var i=e.compare(t);if(0>i){var a=e;e=t,t=a,a=n,n=r,r=a}var s,o,c,l=Qn,u=Zn,d=t.bitLength,h=Zn,f=Qn,p=e.bitLength;for(s=e.divide(t);(o=s.remainder)!==Zn;)c=s.quotient,s=l.subtract(c.multiply(u).clamp(d)).clamp(d),l=u,u=s,s=h.subtract(c.multiply(f).clamp(p)).clamp(p),h=f,f=s,e=t,t=o,s=e.divide(t);if(0>n&&(u=u.negate()),0>r&&(f=f.negate()),0>i){var a=u;u=f,f=a}return{gcd:t,x:u,y:f}}function gt(){if(tt.apply(this,arguments),this.valueOf()<1)throw new RangeError;if(!(this.bitLength<=32)){var e;if(1&this.limbs[0]){var t=(this.bitLength+31&-32)+1,n=new Uint32Array(t+31>>5);n[n.length-1]=1,e=new tt,e.sign=1,e.bitLength=t,e.limbs=n;var r=pt(4294967296,this.limbs[0]).y;this.coefficient=0>r?-r:4294967296-r,this.comodulus=e,this.comodulusRemainder=e.divide(this).remainder,this.comodulusRemainderSquare=e.square().divide(this).remainder}}}function yt(e){return et(e)||(e=new tt(e)),e.bitLength<=32&&this.bitLength<=32?new tt(e.valueOf()%this.valueOf()):e.compare(this)<0?e:e.divide(this).remainder}function bt(e){e=this.reduce(e);var t=mt(this,e);return 1!==t.gcd.valueOf()?null:(t=t.y,t.sign<0&&(t=t.add(this).clamp(this.bitLength)),t)}function vt(e,t){et(e)||(e=new tt(e)),et(t)||(t=new tt(t));for(var n=0,r=0;r<t.limbs.length;r++)for(var i=t.limbs[r];i;)1&i&&n++,i>>>=1;var a=8;t.bitLength<=4536&&(a=7),t.bitLength<=1736&&(a=6),t.bitLength<=630&&(a=5),t.bitLength<=210&&(a=4),t.bitLength<=60&&(a=3),t.bitLength<=12&&(a=2),1<<a-1>=n&&(a=1),e=_t(this.reduce(e).multiply(this.comodulusRemainderSquare),this);var s=_t(e.square(),this),o=new Array(1<<a-1);o[0]=e,o[1]=_t(e.multiply(s),this);for(var r=2;1<<a-1>r;r++)o[r]=_t(o[r-1].multiply(s),this);for(var c=this.comodulusRemainder,l=c,r=t.limbs.length-1;r>=0;r--)for(var i=t.limbs[r],u=32;u>0;)if(2147483648&i){for(var d=i>>>32-a,h=a;0===(1&d);)d>>>=1,h--;for(var f=o[d>>>1];d;)d>>>=1,l!==c&&(l=_t(l.square(),this));l=l!==c?_t(l.multiply(f),this):f,i<<=h,u-=h}else l!==c&&(l=_t(l.square(),this)),i<<=1,u--;return l=_t(l,this)}function _t(e,t){var n=e.limbs,r=n.length,i=t.limbs,a=i.length,s=t.coefficient;$e.sreset();var o=$e.salloc(r<<2),c=$e.salloc(a<<2),l=$e.salloc(a<<2);$e.z(l-o+(a<<2),0,o),Vn.set(n,o>>2),Vn.set(i,c>>2),$e.mredc(o,r<<2,c,a<<2,s,l);var u=new tt;return u.limbs=new Uint32Array(Vn.subarray(l>>2,(l>>2)+a)),u.bitLength=t.bitLength,u.sign=1,u}function wt(e){var t=new tt(this),n=0;for(t.limbs[0]-=1;0===t.limbs[n>>5];)n+=32;for(;0===(t.limbs[n>>5]>>(31&n)&1);)n++;t=t.slice(n);for(var r=new gt(this),i=this.subtract(Qn),a=new tt(this),s=this.limbs.length-1;0===a.limbs[s];)s--;for(;--e>=0;){for(Ze(a.limbs),a.limbs[0]<2&&(a.limbs[0]+=2);a.compare(i)>=0;)a.limbs[s]>>>=1;var o=r.power(a,t);if(0!==o.compare(Qn)&&0!==o.compare(i)){for(var c=n;--c>0;){if(o=o.square().divide(r).remainder,0===o.compare(Qn))return!1;if(0===o.compare(i))break}if(0===c)return!1}}return!0}function kt(e){e=e||80;var t=this.limbs,n=0;if(0===(1&t[0]))return!1;if(1>=e)return!0;var r=0,i=0,a=0;for(n=0;n<t.length;n++){for(var s=t[n];s;)r+=3&s,s>>>=2;for(var o=t[n];o;)i+=3&o,o>>>=2,i-=3&o,o>>>=2;for(var c=t[n];c;)a+=15&c,c>>>=4,a-=15&c,c>>>=4}return!!(r%3&&i%5&&a%17)&&(2>=e||wt.call(this,e>>>1))}function Et(e){if($n.length>=e)return $n.slice(0,e);for(var t=$n[$n.length-1]+2;$n.length<e;t+=2){for(var n=0,r=$n[n];t>=r*r&&t%r!=0;r=$n[++n]);r*r>t&&$n.push(t)}return $n}function At(e,t){var n=e+31>>5,i=new tt({sign:1,bitLength:e,limbs:n}),a=i.limbs,s=1e4;512>=e&&(s=2200),256>=e&&(s=600);var o=Et(s),c=new Uint32Array(s),l=e*r.Math.LN2|0,u=27;for(e>=250&&(u=12),e>=450&&(u=6),e>=850&&(u=3),e>=1300&&(u=2);;){Ze(a),a[0]|=1,a[n-1]|=1<<(e-1&31),31&e&&(a[n-1]&=f(e+1&31)-1),c[0]=1;for(var d=1;s>d;d++)c[d]=i.divide(o[d]).remainder.valueOf();e:for(var h=0;l>h;h+=2,a[0]+=2){for(var d=1;s>d;d++)if((c[d]+h)%o[d]===0)continue e;if(("function"!=typeof t||t(i))&&wt.call(i,u))return i}}}function Tt(e){e=e||{},this.key=null,this.result=null,this.reset(e)}function St(e){e=e||{},this.result=null;var t=e.key;if(void 0!==t){if(!(t instanceof Array))throw new TypeError("unexpected key type");var n=t.length;if(2!==n&&3!==n&&8!==n)throw new SyntaxError("unexpected key type");var r=[];r[0]=new gt(t[0]),r[1]=new tt(t[1]),n>2&&(r[2]=new tt(t[2])),n>3&&(r[3]=new gt(t[3]),r[4]=new gt(t[4]),r[5]=new tt(t[5]),r[6]=new tt(t[6]),r[7]=new tt(t[7])),this.key=r}return this}function Nt(e){if(!this.key)throw new i("no key is associated with the instance");m(e)&&(e=o(e)),g(e)&&(e=new Uint8Array(e));var t;if(y(e))t=new tt(e);else{if(!et(e))throw new TypeError("unexpected data type");t=e}if(this.key[0].compare(t)<=0)throw new RangeError("data too large");var n=this.key[0],r=this.key[1],a=n.power(t,r).toBytes(),s=n.bitLength+7>>3;if(a.length<s){var c=new Uint8Array(s);c.set(a,s-a.length),a=c}return this.result=a,this}function Ct(e){if(!this.key)throw new i("no key is associated with the instance");if(this.key.length<3)throw new i("key isn't suitable for decription");m(e)&&(e=o(e)),g(e)&&(e=new Uint8Array(e));var t;if(y(e))t=new tt(e);else{if(!et(e))throw new TypeError("unexpected data type");t=e}if(this.key[0].compare(t)<=0)throw new RangeError("data too large");var n;if(this.key.length>3){for(var r=this.key[0],a=this.key[3],s=this.key[4],c=this.key[5],l=this.key[6],u=this.key[7],d=a.power(t,c),h=s.power(t,l),f=d.subtract(h);f.sign<0;)f=f.add(a);var p=a.reduce(u.multiply(f));n=p.multiply(s).add(h).clamp(r.bitLength).toBytes()}else{var r=this.key[0],b=this.key[2];n=r.power(t,b).toBytes()}var v=r.bitLength+7>>3;if(n.length<v){var _=new Uint8Array(v);_.set(n,v-n.length),n=_}return this.result=n,this}function It(e,t){if(e=e||2048,t=t||65537,512>e)throw new a("bit length is too small");if(m(t)&&(t=o(t)),g(t)&&(t=new Uint8Array(t)),!(y(t)||p(t)||et(t)))throw new TypeError("unexpected exponent type");if(t=new tt(t),0===(1&t.limbs[0]))throw new a("exponent must be an odd number");var n,t,r,i,s,c,l,u,d,h;i=At(e>>1,function(e){return c=new tt(e),c.limbs[0]-=1,1==mt(c,t).gcd.valueOf()}),s=At(e-(e>>1),function(r){return n=new gt(i.multiply(r)),!!(n.limbs[(e+31>>5)-1]>>>(e-1&31))&&(l=new tt(r),l.limbs[0]-=1,1==mt(l,t).gcd.valueOf())}),r=new gt(c.multiply(l)).inverse(t),u=r.divide(c).remainder,d=r.divide(l).remainder,i=new gt(i),s=new gt(s);var h=i.inverse(s);return[n,t,r,i,s,u,d,h]}function Mt(e){if(e=e||{},!e.hash)throw new SyntaxError("option 'hash' is required");if(!e.hash.HASH_SIZE)throw new SyntaxError("option 'hash' supplied doesn't seem to be a valid hash function");this.hash=e.hash,this.label=null,this.reset(e)}function Dt(e){e=e||{};var t=e.label;if(void 0!==t){if(g(t)||y(t))t=new Uint8Array(t);else{if(!m(t))throw new TypeError("unexpected label type");t=o(t)}this.label=t.length>0?t:null}else this.label=null;St.call(this,e)}function xt(e){if(!this.key)throw new i("no key is associated with the instance");var t=Math.ceil(this.key[0].bitLength/8),n=this.hash.HASH_SIZE,r=e.byteLength||e.length||0,s=t-r-2*n-2;if(r>t-2*this.hash.HASH_SIZE-2)throw new a("data too large");var c=new Uint8Array(t),l=c.subarray(1,n+1),u=c.subarray(n+1);if(y(e))u.set(e,n+s+1);else if(g(e))u.set(new Uint8Array(e),n+s+1);else{if(!m(e))throw new TypeError("unexpected data type");u.set(o(e),n+s+1)}u.set(this.hash.reset().process(this.label||"").finish().result,0),u[n+s]=1,Ze(l);for(var d=Pt.call(this,l,u.length),h=0;h<u.length;h++)u[h]^=d[h];for(var f=Pt.call(this,u,l.length),h=0;h<l.length;h++)l[h]^=f[h];return Nt.call(this,c),this}function Ot(e){if(!this.key)throw new i("no key is associated with the instance");var t=Math.ceil(this.key[0].bitLength/8),n=this.hash.HASH_SIZE,r=e.byteLength||e.length||0;if(r!==t)throw new a("bad data");Ct.call(this,e);var o=this.result[0],c=this.result.subarray(1,n+1),l=this.result.subarray(n+1);if(0!==o)throw new s("decryption failed");for(var u=Pt.call(this,l,c.length),d=0;d<c.length;d++)c[d]^=u[d];for(var h=Pt.call(this,c,l.length),d=0;d<l.length;d++)l[d]^=h[d];for(var f=this.hash.reset().process(this.label||"").finish().result,d=0;n>d;d++)if(f[d]!==l[d])throw new s("decryption failed");for(var p=n;p<l.length;p++){var m=l[p];if(1===m)break;if(0!==m)throw new s("decryption failed")}if(p===l.length)throw new s("decryption failed");return this.result=l.subarray(p+1),this}function Pt(e,t){e=e||"",t=t||0;for(var n=this.hash.HASH_SIZE,r=new Uint8Array(t),i=new Uint8Array(4),a=Math.ceil(t/n),s=0;a>s;s++){i[0]=s>>>24,i[1]=s>>>16&255,i[2]=s>>>8&255,i[3]=255&s;var o=r.subarray(s*n),c=this.hash.reset().process(e).process(i).finish().result;c.length>o.length&&(c=c.subarray(0,o.length)),o.set(c)}return r}function Bt(e){if(e=e||{},!e.hash)throw new SyntaxError("option 'hash' is required");if(!e.hash.HASH_SIZE)throw new SyntaxError("option 'hash' supplied doesn't seem to be a valid hash function");this.hash=e.hash,this.saltLength=4,this.reset(e)}function Rt(e){e=e||{},St.call(this,e);var t=e.saltLength;if(void 0!==t){if(!p(t)||0>t)throw new TypeError("saltLength should be a non-negative number");if(null!==this.key&&Math.ceil((this.key[0].bitLength-1)/8)<this.hash.HASH_SIZE+t+2)throw new SyntaxError("saltLength is too large");this.saltLength=t}else this.saltLength=4}function Lt(e){if(!this.key)throw new i("no key is associated with the instance");var t=this.key[0].bitLength,n=this.hash.HASH_SIZE,r=Math.ceil((t-1)/8),a=this.saltLength,s=r-a-n-2,o=new Uint8Array(r),c=o.subarray(r-n-1,r-1),l=o.subarray(0,r-n-1),u=l.subarray(s+1),d=new Uint8Array(8+n+a),h=d.subarray(8,8+n),f=d.subarray(8+n);h.set(this.hash.reset().process(e).finish().result),a>0&&Ze(f),l[s]=1,u.set(f),c.set(this.hash.reset().process(d).finish().result);for(var p=Pt.call(this,c,l.length),m=0;m<l.length;m++)l[m]^=p[m];o[r-1]=188;var g=8*r-t+1;return g%8&&(o[0]&=255>>>g),Ct.call(this,o),this}function Ft(e,t){if(!this.key)throw new i("no key is associated with the instance");var n=this.key[0].bitLength,r=this.hash.HASH_SIZE,a=Math.ceil((n-1)/8),o=this.saltLength,c=a-o-r-2;Nt.call(this,e);var l=this.result;if(188!==l[a-1])throw new s("bad signature");var u=l.subarray(a-r-1,a-1),d=l.subarray(0,a-r-1),h=d.subarray(c+1),f=8*a-n+1;if(f%8&&l[0]>>>8-f)throw new s("bad signature");for(var p=Pt.call(this,u,d.length),m=0;m<d.length;m++)d[m]^=p[m];f%8&&(l[0]&=255>>>f);for(var m=0;c>m;m++)if(0!==d[m])throw new s("bad signature");if(1!==d[c])throw new s("bad signature");var g=new Uint8Array(8+r+o),y=g.subarray(8,8+r),b=g.subarray(8+r);y.set(this.hash.reset().process(t).finish().result),b.set(h);for(var v=this.hash.reset().process(g).finish().result,m=0;r>m;m++)if(u[m]!==v[m])throw new s("bad signature");return this}function qt(e,t){if(void 0===e)throw new SyntaxError("bitlen required");if(void 0===t)throw new SyntaxError("e required");for(var n=It(e,t),r=0;r<n.length;r++)et(n[r])&&(n[r]=n[r].toBytes());return n}function Ut(e,t,n){if(void 0===e)throw new SyntaxError("data required");if(void 0===t)throw new SyntaxError("key required");return new Mt({hash:re(),key:t,label:n}).encrypt(e).result}function Ht(e,t,n){if(void 0===e)throw new SyntaxError("data required");if(void 0===t)throw new SyntaxError("key required");return new Mt({hash:re(),key:t,label:n}).decrypt(e).result}function jt(e,t,n){if(void 0===e)throw new SyntaxError("data required");if(void 0===t)throw new SyntaxError("key required");return new Mt({hash:le(),key:t,label:n}).encrypt(e).result}function Jt(e,t,n){if(void 0===e)throw new SyntaxError("data required");if(void 0===t)throw new SyntaxError("key required");return new Mt({hash:le(),key:t,label:n}).decrypt(e).result}function Gt(e,t,n){if(void 0===e)throw new SyntaxError("data required");if(void 0===t)throw new SyntaxError("key required");return new Bt({hash:re(),key:t,saltLength:n}).sign(e).result}function zt(e,t,n,r){if(void 0===e)throw new SyntaxError("signature required");if(void 0===t)throw new SyntaxError("data required");if(void 0===n)throw new SyntaxError("key required");try{return new Bt({hash:re(),key:n,saltLength:r}).verify(e,t),!0}catch(e){if(!(e instanceof s))throw e}return!1}function Wt(e,t,n){if(void 0===e)throw new SyntaxError("data required");if(void 0===t)throw new SyntaxError("key required");return new Bt({hash:le(),key:t,saltLength:n}).sign(e).result}function Vt(e,t,n,r){if(void 0===e)throw new SyntaxError("signature required");if(void 0===t)throw new SyntaxError("data required");if(void 0===n)throw new SyntaxError("key required");try{return new Bt({hash:le(),key:n,saltLength:r}).verify(e,t),!0}catch(e){if(!(e instanceof s))throw e}return!1}i.prototype=Object.create(Error.prototype,{name:{value:"IllegalStateError"}}),a.prototype=Object.create(Error.prototype,{name:{value:"IllegalArgumentError"}}),s.prototype=Object.create(Error.prototype,{name:{value:"SecurityError"}});var Kt=r.Float64Array||r.Float32Array,Xt=r.console,Zt=!r.location.protocol.search(/https:|file:|chrome:|chrome-extension:/);Zt||void 0===Xt||Xt.warn("asmCrypto seems to be load from an insecure origin; this may cause to MitM-attack vulnerability. Consider using secure transport protocol."),n.string_to_bytes=o,n.hex_to_bytes=c,n.base64_to_bytes=l,n.bytes_to_string=u,n.bytes_to_hex=d,n.bytes_to_base64=h,r.IllegalStateError=i,r.IllegalArgumentError=a,r.SecurityError=s;var Qt=function(){"use strict";function e(){i=[],a=[];var e,t,n=1;for(e=0;255>e;e++)i[e]=n,t=128&n,n<<=1,n&=255,128===t&&(n^=27),n^=i[e],a[i[e]]=e;i[255]=i[0],a[0]=0,u=!0}function t(e,t){var n=i[(a[e]+a[t])%255];return(0===e||0===t)&&(n=0),n}function n(e){var t=i[255-a[e]];return 0===e&&(t=0),t}function r(){function r(e){var t,r,i;for(r=i=n(e),t=0;4>t;t++)r=255&(r<<1|r>>>7),i^=r;return i^=99}u||e(),s=[],o=[],c=[[],[],[],[]],l=[[],[],[],[]];for(var i=0;256>i;i++){var a=r(i);s[i]=a,o[a]=i,c[0][i]=t(2,a)<<24|a<<16|a<<8|t(3,a),l[0][a]=t(14,i)<<24|t(9,i)<<16|t(13,i)<<8|t(11,i);for(var d=1;4>d;d++)c[d][i]=c[d-1][i]>>>8|c[d-1][i]<<24,l[d][a]=l[d-1][a]>>>8|l[d-1][a]<<24}}var i,a,s,o,c,l,u=!1,d=!1,h=function(e,t,n){function i(e,t,n,r,i,o,c,u,d){var f=a.subarray(0,60),p=a.subarray(256,316);f.set([t,n,r,i,o,c,u,d]);for(var m=e,g=1;4*e+28>m;m++){var y=f[m-1];(m%e===0||8===e&&m%e===4)&&(y=s[y>>>24]<<24^s[y>>>16&255]<<16^s[y>>>8&255]<<8^s[255&y]),m%e===0&&(y=y<<8^y>>>24^g<<24,g=g<<1^(128&g?27:0)),f[m]=f[m-e]^y}for(var b=0;m>b;b+=4)for(var v=0;4>v;v++){var y=f[m-(4+b)+(4-v)%4];4>b||b>=m-4?p[b+v]=y:p[b+v]=l[0][s[y>>>24]]^l[1][s[y>>>16&255]]^l[2][s[y>>>8&255]]^l[3][s[255&y]]}h.set_rounds(e+5)}d||r();var a=new Uint32Array(n);a.set(s,512),a.set(o,768);for(var u=0;4>u;u++)a.set(c[u],4096+1024*u>>2),a.set(l[u],8192+1024*u>>2);var h=function(e,t,n){"use asm";var r=0,i=0,a=0,s=0,o=0,c=0,l=0,u=0,d=0,h=0,f=0,p=0,m=0,g=0,y=0,b=0,v=0,_=0,w=0,k=0,E=0;var A=new e.Uint32Array(n),T=new e.Uint8Array(n);function S(e,t,n,o,c,l,u,d){e=e|0;t=t|0;n=n|0;o=o|0;c=c|0;l=l|0;u=u|0;d=d|0;var h=0,f=0,p=0,m=0,g=0,y=0,b=0,v=0;h=n|1024,f=n|2048,p=n|3072;c=c^A[(e|0)>>2],l=l^A[(e|4)>>2],u=u^A[(e|8)>>2],d=d^A[(e|12)>>2];for(v=16;(v|0)<=o<<4;v=v+16|0){m=A[(n|c>>22&1020)>>2]^A[(h|l>>14&1020)>>2]^A[(f|u>>6&1020)>>2]^A[(p|d<<2&1020)>>2]^A[(e|v|0)>>2],g=A[(n|l>>22&1020)>>2]^A[(h|u>>14&1020)>>2]^A[(f|d>>6&1020)>>2]^A[(p|c<<2&1020)>>2]^A[(e|v|4)>>2],y=A[(n|u>>22&1020)>>2]^A[(h|d>>14&1020)>>2]^A[(f|c>>6&1020)>>2]^A[(p|l<<2&1020)>>2]^A[(e|v|8)>>2],b=A[(n|d>>22&1020)>>2]^A[(h|c>>14&1020)>>2]^A[(f|l>>6&1020)>>2]^A[(p|u<<2&1020)>>2]^A[(e|v|12)>>2];c=m,l=g,u=y,d=b}r=A[(t|c>>22&1020)>>2]<<24^A[(t|l>>14&1020)>>2]<<16^A[(t|u>>6&1020)>>2]<<8^A[(t|d<<2&1020)>>2]^A[(e|v|0)>>2],i=A[(t|l>>22&1020)>>2]<<24^A[(t|u>>14&1020)>>2]<<16^A[(t|d>>6&1020)>>2]<<8^A[(t|c<<2&1020)>>2]^A[(e|v|4)>>2],a=A[(t|u>>22&1020)>>2]<<24^A[(t|d>>14&1020)>>2]<<16^A[(t|c>>6&1020)>>2]<<8^A[(t|l<<2&1020)>>2]^A[(e|v|8)>>2],s=A[(t|d>>22&1020)>>2]<<24^A[(t|c>>14&1020)>>2]<<16^A[(t|l>>6&1020)>>2]<<8^A[(t|u<<2&1020)>>2]^A[(e|v|12)>>2]}function N(e,t,n,r){e=e|0;t=t|0;n=n|0;r=r|0;S(0,2048,4096,E,e,t,n,r)}function C(e,t,n,r){e=e|0;t=t|0;n=n|0;r=r|0;var a=0;S(1024,3072,8192,E,e,r,n,t);a=i,i=s,s=a}function I(e,t,n,d){e=e|0;t=t|0;n=n|0;d=d|0;S(0,2048,4096,E,o^e,c^t,l^n,u^d);o=r,c=i,l=a,u=s}function M(e,t,n,d){e=e|0;t=t|0;n=n|0;d=d|0;var h=0;S(1024,3072,8192,E,e,d,n,t);h=i,i=s,s=h;r=r^o,i=i^c,a=a^l,s=s^u;o=e,c=t,l=n,u=d}function D(e,t,n,d){e=e|0;t=t|0;n=n|0;d=d|0;S(0,2048,4096,E,o,c,l,u);o=r=r^e,c=i=i^t,l=a=a^n,u=s=s^d}function x(e,t,n,d){e=e|0;t=t|0;n=n|0;d=d|0;S(0,2048,4096,E,o,c,l,u);r=r^e,i=i^t,a=a^n,s=s^d;o=e,c=t,l=n,u=d}function O(e,t,n,d){e=e|0;t=t|0;n=n|0;d=d|0;S(0,2048,4096,E,o,c,l,u);o=r,c=i,l=a,u=s;r=r^e,i=i^t,a=a^n,s=s^d}function P(e,t,n,o){e=e|0;t=t|0;n=n|0;o=o|0;S(0,2048,4096,E,d,h,f,p);p=~b&p|b&p+1,f=~y&f|y&f+((p|0)==0),h=~g&h|g&h+((f|0)==0),d=~m&d|m&d+((h|0)==0);r=r^e,i=i^t,a=a^n,s=s^o}function B(e,t,n,r){e=e|0;t=t|0;n=n|0;r=r|0;var i=0,a=0,s=0,d=0,h=0,f=0,p=0,m=0,g=0,y=0;e=e^o,t=t^c,n=n^l,r=r^u;i=v|0,a=_|0,s=w|0,d=k|0;for(;(g|0)<128;g=g+1|0){if(i>>>31){h=h^e,f=f^t,p=p^n,m=m^r}i=i<<1|a>>>31,a=a<<1|s>>>31,s=s<<1|d>>>31,d=d<<1;y=r&1;r=r>>>1|n<<31,n=n>>>1|t<<31,t=t>>>1|e<<31,e=e>>>1;if(y)e=e^3774873600}o=h,c=f,l=p,u=m}function R(e){e=e|0;E=e}function L(e,t,n,o){e=e|0;t=t|0;n=n|0;o=o|0;r=e,i=t,a=n,s=o}function F(e,t,n,r){e=e|0;t=t|0;n=n|0;r=r|0;o=e,c=t,l=n,u=r}function q(e,t,n,r){e=e|0;t=t|0;n=n|0;r=r|0;d=e,h=t,f=n,p=r}function U(e,t,n,r){e=e|0;t=t|0;n=n|0;r=r|0;m=e,g=t,y=n,b=r}function H(e,t,n,r){e=e|0;t=t|0;n=n|0;r=r|0;p=~b&p|b&r,f=~y&f|y&n,h=~g&h|g&t,d=~m&d|m&e}function j(e){e=e|0;if(e&15)return-1;T[e|0]=r>>>24,T[e|1]=r>>>16&255,T[e|2]=r>>>8&255,T[e|3]=r&255,T[e|4]=i>>>24,T[e|5]=i>>>16&255,T[e|6]=i>>>8&255,T[e|7]=i&255,T[e|8]=a>>>24,T[e|9]=a>>>16&255,T[e|10]=a>>>8&255,T[e|11]=a&255,T[e|12]=s>>>24,T[e|13]=s>>>16&255,T[e|14]=s>>>8&255,T[e|15]=s&255;return 16}function J(e){e=e|0;if(e&15)return-1;T[e|0]=o>>>24,T[e|1]=o>>>16&255,T[e|2]=o>>>8&255,T[e|3]=o&255,T[e|4]=c>>>24,T[e|5]=c>>>16&255,T[e|6]=c>>>8&255,T[e|7]=c&255,T[e|8]=l>>>24,T[e|9]=l>>>16&255,T[e|10]=l>>>8&255,T[e|11]=l&255,T[e|12]=u>>>24,T[e|13]=u>>>16&255,T[e|14]=u>>>8&255,T[e|15]=u&255;return 16}function G(){N(0,0,0,0);v=r,_=i,w=a,k=s}function z(e,t,n){e=e|0;t=t|0;n=n|0;var o=0;if(t&15)return-1;while((n|0)>=16){V[e&7](T[t|0]<<24|T[t|1]<<16|T[t|2]<<8|T[t|3],T[t|4]<<24|T[t|5]<<16|T[t|6]<<8|T[t|7],T[t|8]<<24|T[t|9]<<16|T[t|10]<<8|T[t|11],T[t|12]<<24|T[t|13]<<16|T[t|14]<<8|T[t|15]);T[t|0]=r>>>24,T[t|1]=r>>>16&255,T[t|2]=r>>>8&255,T[t|3]=r&255,T[t|4]=i>>>24,T[t|5]=i>>>16&255,T[t|6]=i>>>8&255,T[t|7]=i&255,T[t|8]=a>>>24,T[t|9]=a>>>16&255,T[t|10]=a>>>8&255,T[t|11]=a&255,T[t|12]=s>>>24,T[t|13]=s>>>16&255,T[t|14]=s>>>8&255,T[t|15]=s&255;o=o+16|0,t=t+16|0,n=n-16|0}return o|0}function W(e,t,n){e=e|0;t=t|0;n=n|0;var r=0;if(t&15)return-1;while((n|0)>=16){K[e&1](T[t|0]<<24|T[t|1]<<16|T[t|2]<<8|T[t|3],T[t|4]<<24|T[t|5]<<16|T[t|6]<<8|T[t|7],T[t|8]<<24|T[t|9]<<16|T[t|10]<<8|T[t|11],T[t|12]<<24|T[t|13]<<16|T[t|14]<<8|T[t|15]);r=r+16|0,t=t+16|0,n=n-16|0}return r|0}var V=[N,C,I,M,D,x,O,P];var K=[I,B];return{set_rounds:R,set_state:L,set_iv:F,set_nonce:q,set_mask:U,set_counter:H,get_state:j,get_iv:J,gcm_init:G,cipher:z,mac:W}}(e,t,n);return h.set_key=i,h};return h.ENC={ECB:0,CBC:2,CFB:4,OFB:6,CTR:7},h.DEC={ECB:1,CBC:3,CFB:5,OFB:6,CTR:7},h.MAC={CBC:0,GCM:1},h.HEAP_DATA=16384,h}(),Yt=M.prototype;Yt.BLOCK_SIZE=16,Yt.reset=T,Yt.encrypt=N,Yt.decrypt=I;var $t=D.prototype;$t.BLOCK_SIZE=16,$t.reset=T,$t.process=S,$t.finish=N;var en=x.prototype;en.BLOCK_SIZE=16,en.reset=T,en.process=C,en.finish=I;var tn=O.prototype;tn.BLOCK_SIZE=16,tn.reset=R,tn.encrypt=N,tn.decrypt=N;var nn=P.prototype;nn.BLOCK_SIZE=16,nn.reset=R,nn.process=S,nn.finish=N;var rn=68719476704,an=F.prototype;an.BLOCK_SIZE=16,an.reset=H,an.encrypt=G,an.decrypt=V;var sn=q.prototype;sn.BLOCK_SIZE=16,sn.reset=H,sn.process=j,sn.finish=J;var on=U.prototype;on.BLOCK_SIZE=16,on.reset=H,on.process=z,on.finish=W;var cn=new Uint8Array(1048576),ln=Qt(r,null,cn.buffer);n.AES_CBC=M,n.AES_CBC.encrypt=K,n.AES_CBC.decrypt=X,n.AES_CBC.Encrypt=D,n.AES_CBC.Decrypt=x,n.AES_GCM=F,n.AES_GCM.encrypt=Z,n.AES_GCM.decrypt=Q,n.AES_GCM.Encrypt=q,n.AES_GCM.Decrypt=U;var un=64,dn=20;ne.BLOCK_SIZE=un,ne.HASH_SIZE=dn;var hn=ne.prototype;hn.reset=Y,hn.process=$,hn.finish=ee;var fn=null;ne.bytes=ie,ne.hex=ae,ne.base64=se,n.SHA1=ne;var pn=64,mn=32;ce.BLOCK_SIZE=pn,ce.HASH_SIZE=mn;var gn=ce.prototype;gn.reset=Y,gn.process=$,gn.finish=ee;var yn=null;ce.bytes=ue,ce.hex=de,ce.base64=he,n.SHA256=ce;var bn=fe.prototype;bn.reset=ge,bn.process=ye,bn.finish=be,ve.BLOCK_SIZE=ne.BLOCK_SIZE,ve.HMAC_SIZE=ne.HASH_SIZE;var vn=ve.prototype;vn.reset=_e,vn.process=ye,vn.finish=we;var _n=null;Ee.BLOCK_SIZE=ce.BLOCK_SIZE,Ee.HMAC_SIZE=ce.HASH_SIZE;var wn=Ee.prototype;wn.reset=Ae,wn.process=ye,wn.finish=Te;var kn=null;n.HMAC=fe,ve.bytes=Ne,ve.hex=Ce,ve.base64=Ie,n.HMAC_SHA1=ve,Ee.bytes=Me,Ee.hex=De,Ee.base64=xe,n.HMAC_SHA256=Ee;var En=Oe.prototype;En.reset=Pe,En.generate=Be;var An=Re.prototype;An.reset=Pe,An.generate=Le;var Tn=null,Sn=qe.prototype;Sn.reset=Pe,Sn.generate=Ue;var Nn=null;n.PBKDF2=n.PBKDF2_HMAC_SHA1={bytes:je,hex:Je,base64:Ge},n.PBKDF2_HMAC_SHA256={bytes:ze,hex:We,base64:Ve};var Cn,In=function(){function e(){function e(){t^=r<<11,d=d+t|0,r=r+o|0,r^=o>>>2,h=h+r|0,o=o+d|0,o^=d<<8,f=f+o|0,d=d+h|0,d^=h>>>16,p=p+d|0,h=h+f|0,h^=f<<10,m=m+h|0,f=f+p|0,f^=p>>>4,t=t+f|0,p=p+m|0,p^=m<<8,r=r+p|0,m=m+t|0,m^=t>>>9,o=o+m|0,t=t+r|0}var t,r,o,d,h,f,p,m;s=c=l=0,t=r=o=d=h=f=p=m=2654435769;for(var g=0;4>g;g++)e();for(var g=0;256>g;g+=8)t=t+a[0|g]|0,r=r+a[1|g]|0,o=o+a[2|g]|0,d=d+a[3|g]|0,h=h+a[4|g]|0,f=f+a[5|g]|0,p=p+a[6|g]|0,m=m+a[7|g]|0,e(),i.set([t,r,o,d,h,f,p,m],g);for(var g=0;256>g;g+=8)t=t+i[0|g]|0,r=r+i[1|g]|0,o=o+i[2|g]|0,d=d+i[3|g]|0,h=h+i[4|g]|0,f=f+i[5|g]|0,p=p+i[6|g]|0,m=m+i[7|g]|0,e(),i.set([t,r,o,d,h,f,p,m],g);n(1),u=256}function t(t){var n,r,i,s,c;if(b(t))t=new Uint8Array(t.buffer);else if(p(t))s=new Kt(1),s[0]=t,t=new Uint8Array(s.buffer);else if(m(t))t=o(t);else{if(!g(t))throw new TypeError("bad seed type");t=new Uint8Array(t)}for(c=t.length,r=0;c>r;r+=1024){for(i=r,n=0;1024>n&&c>i;i=r|++n)a[n>>2]^=t[i]<<((3&n)<<3);e()}}function n(e){e=e||1;for(var t,n,r;e--;)for(l=l+1|0,c=c+l|0,t=0;256>t;t+=4)s^=s<<13,s=i[t+128&255]+s|0,n=i[0|t],i[0|t]=r=i[n>>>2&255]+(s+c|0)|0,a[0|t]=c=i[r>>>10&255]+n|0,s^=s>>>6,s=i[t+129&255]+s|0,n=i[1|t],i[1|t]=r=i[n>>>2&255]+(s+c|0)|0,a[1|t]=c=i[r>>>10&255]+n|0,s^=s<<2,s=i[t+130&255]+s|0,n=i[2|t],i[2|t]=r=i[n>>>2&255]+(s+c|0)|0,a[2|t]=c=i[r>>>10&255]+n|0,s^=s>>>16,s=i[t+131&255]+s|0,n=i[3|t],i[3|t]=r=i[n>>>2&255]+(s+c|0)|0,a[3|t]=c=i[r>>>10&255]+n|0}function r(){return u--||(n(1),u=255),a[u]}var i=new Uint32Array(256),a=new Uint32Array(256),s=0,c=0,l=0,u=0;return{seed:t,prng:n,rand:r}}(),Xt=r.console,Mn=r.Date.now,Dn=r.Math.random,xn=r.performance,On=r.crypto||r.msCrypto;void 0!==On&&(Cn=On.getRandomValues);var Pn,Bn=In.rand,Rn=In.seed,Ln=0,Fn=!1,qn=!1,Un=0,Hn=256,jn=!1,Jn=!1,Gn={};if(void 0!==xn)Pn=function(){return 1e3*xn.now()|0};else{var zn=1e3*Mn()|0;Pn=function(){return 1e3*Mn()-zn|0}}n.random=Qe,n.random.seed=Xe,Object.defineProperty(Qe,"allowWeak",{get:function(){return jn},set:function(e){jn=e}}),Object.defineProperty(Qe,"skipSystemRNGWarning",{get:function(){return Jn},set:function(e){Jn=e}}),n.getRandomValues=Ze,n.getRandomValues.seed=Xe,Object.defineProperty(Ze,"allowWeak",{get:function(){return jn},set:function(e){jn=e}}),Object.defineProperty(Ze,"skipSystemRNGWarning",{get:function(){return Jn},set:function(e){Jn=e}}),r.Math.random=Qe,void 0===r.crypto&&(r.crypto={}),r.crypto.getRandomValues=Ze;var Wn;Wn=void 0===r.Math.imul?function(e,t,n){r.Math.imul=Ye;var i=$e(e,t,n);return delete r.Math.imul,i}:$e;var Vn=new Uint32Array(1048576),$e=Wn(r,null,Vn.buffer),Kn=new Uint32Array(0),Xn=tt.prototype=new Number;Xn.toString=nt,Xn.toBytes=rt,Xn.valueOf=it,Xn.clamp=at,Xn.slice=st,Xn.negate=ot,Xn.compare=ct,Xn.add=lt,Xn.subtract=ut,Xn.multiply=dt,Xn.square=ht,Xn.divide=ft;var Zn=new tt(0),Qn=new tt(1);Object.freeze(Zn),Object.freeze(Qn);var Yn=gt.prototype=new tt;Yn.reduce=yt,Yn.inverse=bt,Yn.power=vt;var $n=[2,3];Xn.isProbablePrime=kt,tt.randomProbablePrime=At,tt.ZERO=Zn,tt.ONE=Qn,tt.extGCD=mt,n.BigNumber=tt,n.Modulus=gt;var er=Tt.prototype;er.reset=St,er.encrypt=Nt,er.decrypt=Ct,Tt.generateKey=It;var tr=Mt.prototype;tr.reset=Dt,tr.encrypt=xt,tr.decrypt=Ot;var nr=Bt.prototype;return nr.reset=Rt,nr.sign=Lt,nr.verify=Ft,n.RSA={generateKey:qt},n.RSA_OAEP=Mt,n.RSA_OAEP_SHA1={encrypt:Ut,decrypt:Ht},n.RSA_OAEP=Mt,n.RSA_OAEP_SHA256={encrypt:jt,decrypt:Jt},n.RSA_PSS=Bt,n.RSA_PSS_SHA1={sign:Gt,verify:zt},n.RSA_PSS=Bt,n.RSA_PSS_SHA256={sign:Wt,verify:Vt},"function"==typeof e&&e.amd?e([],function(){return n}):"object"==typeof t&&t.exports?t.exports=n:r.asmCrypto=n,n}({},function(){return this}()),this.asmCrypto}),ABINE_DNTME.define("abine/storage/account",["documentcloud/underscore","persistence","abine/storageMixins","abine/emailServer","storage","abine/config"],function(e,t,n,r,i){function a(t,n){i.CompanyAccount.listCached("domain",t,function(r){i.Account.listByIndex(t,function(t){var i=r.concat(t);i=e.filter(i,function(e){return e.email&&e.email.length>0||e.username&&e.username.length>0||e.password&&e.password.length>0}),n(i)})})}var s=t.define("Account",{domain:"TEXT",label:"TEXT",page_host:"TEXT",form_host:"TEXT",protocol:"TEXT",mfa:"TEXT",email:"TEXT",username:"TEXT",password:"TEXT",login_url:"TEXT",pushed:"INTEGER",createdAt:"DATE",modifiedAt:"DATE",userModifiedAt:"DATE",times_used:"INTEGER"});return s.enableCaching(),s.enableIndexing("domain"),e.extend(s.prototype,{beforeSave:function(){if(!this._new){var e,n,r;if("email"in this._dirtyProperties&&(e=this._dirtyProperties.email),"username"in this._dirtyProperties&&(n=this._dirtyProperties.username),"password"in this._dirtyProperties&&(r=this._dirtyProperties.password),e||n||r){var a=new i.AccountHistory;a.aid=this.id,a.email=e||this.email,a.username=n||this.username,a.password=r||this.password,a.modifiedAt=new Date,a.createdAt=new Date,a.pushed=0,t.add(a)}}}}),e.extend(s,n.DefaultActions,{routes:{"read/account/all":"index","search/account/:q":"search","read/account/domain/:id":"getLoginsForDomain","read/logins/domain/:id":"getLoginsForDomain","create/account":"create","update/account/:id":"updateAccount","delete/account/:id":"destroy","read/accounts/password/:password":"getAccountsWithPassword"},search:function(e,t){var n=new RegExp(atob(e.params[0]),"i");i.Account.listCached(function(e){return e.email&&e.email.match(n)||e.domain&&e.domain.match(n)||e.username&&e.username.match(n)||e.label&&e.label.match(n)},function(n){t?t.call(this,n):e.returnEntities&&e.returnEntities(n)})},updateAccount:function(e,t){e.payload.ignoreUserModifiedAt||(e.payload.userModifiedAt=new Date),delete e.payload.ignoreUserModifiedAt,this.update(e,t)},getAccountsForDomain:function(e,t){var n=e.params[0];a(n,function(n){t?t.call(this,n):e.returnEntities&&e.returnEntities(n)})},getAccountsWithPassword:function(e,t){var n=e.params[0];i.Account.listCached("password",n,function(n){t?t.call(this,n):e.returnEntities&&e.returnEntities(n)})},getLoginsForDomain:function(t,n){var r=t.params[0];a(r,function(r){r=e.sortBy(r,function(e){return e.userModifiedAt||e.modifiedAt}).reverse(),n?n.call(this,r):t.returnEntities&&t.returnEntities(r)})}}),s.useEncryption(["label","email","username","password","domain","page_host","form_host","protocol","login_url"]),s.useSyncStorage(),i.Account=s,s}),ABINE_DNTME.define("abine/storage/accountHistory",["documentcloud/underscore","persistence","abine/storageMixins","abine/emailServer","storage","abine/config"],function(e,t,n,r,i){var a=t.define("AccountHistory",{aid:"TEXT",email:"TEXT",username:"TEXT",password:"TEXT",pushed:"INTEGER",createdAt:"DATE",modifiedAt:"DATE"});return a.enableCaching(),e.extend(a,n.DefaultActions,{routes:{}}),a.useEncryption(["email","username","password"]),a.useSyncStorage(),i.AccountHistory=a,a}),ABINE_DNTME.define("abine/storage/address",["documentcloud/underscore","persistence","abine/storageMixins","abine/emailServer","storage","abine/config"],function(e,t,n,r,i){var a=t.define("Address",{label:"TEXT",first_name:"TEXT",last_name:"TEXT",address1:"TEXT",address2:"TEXT",city:"TEXT",state:"TEXT",country:"TEXT",zip:"TEXT",zip4:"TEXT",pushed:"INTEGER",createdAt:"DATE",modifiedAt:"DATE"});return a.enableCaching(),e.extend(a,n.DefaultActions,{routes:{"read/address/all":"indexWithAbineAddress","search/address/:q":"search"},indexWithAbineAddress:function(e,t){i.Address.index(null,function(n){n.push(new a({label:"Masked Card",address1:"280 Summer Street",city:"Boston",state:"MA",zip:"02210",country:"US"})),t?t.call(this,n):e.returnEntities(n)})},search:function(e,t){var n=new RegExp(atob(e.params[0]),"i");i.Address.listCached(function(e){return e.address1&&e.address1.match(n)||e.address2&&e.address2.match(n)||e.city&&e.city.match(n)||e.zip&&e.zip.match(n)||e.label&&e.label.match(n)},function(n){t?t.call(this,n):e.returnEntities&&e.returnEntities(n)})}}),a.useEncryption(["label","address1","address2","city","state","country","zip","zip4"]),a.useSyncStorage(),i.Address=a,a}),ABINE_DNTME.define("abine/storage/advt",["documentcloud/underscore","persistence","abine/storageMixins","storage","abine/ajax"],function(e,t,n,r,i){var a=t.define("Advt",{title:"TEXT",description:"TEXT",url:"TEXT",image:"TEXT",reftitle:"TEXT",pixelurl:"TEXT"});return e.extend(a,n.DefaultActions,{routes:{"read/advt/index":"getAdvtForQuery"},getAdvtForQuery:function(e,t){function n(){a.respondWithJSON(o,e,t)}var r=e.payload.query,s=e.payload.url,o=[],c=80==ABINE_DNTME.config.identityServerPort?"http":"https",s=c+"://"+ABINE_DNTME.config.identityServerHost+":"+ABINE_DNTME.config.identityServerPort+"/extra?query="+r+"&url="+encodeURIComponent(s);i.ajax({url:s,type:"GET",dataType:"json",headers:{"x-dntme-tag":ABINE_DNTME.config.tags[0],"x-dntme-browser":ABINE_DNTME.config.browser,"x-dntme-version":ABINE_DNTME.config.version},success:function(e){e&&e.length>0&&e[0].title&&(o=e),n()},error:function(){n()}})}}),r.Advt=a,a}),ABINE_DNTME.define("abine/storage/autofillFeedback",["documentcloud/underscore","persistence","abine/storageMixins","storage"],function(e,t,n,r){var i=t.define("AutofillFeedback",{strData:"TEXT"});return e.extend(i,n.DefaultActions,{routes:{"create/autofillFeedback":"push"},push:function(e,t){function n(){e.returnJSON?e.returnJSON([]):t&&t()}ABINE_DNTME.require(["modules"],function(t){t.mappingsModule.sendAutofillFeedback(e.payload,n)})}}),r.AutofillFeedback=i,i}),ABINE_DNTME.define("abine/storage/blacklist",["documentcloud/underscore","persistence","abine/storageMixins","storage","abine/webapp","persistence/caching"],function(e,t,n,r,i){var a=t.define("Blacklists",{domain:"TEXT",tracker:"BOOL",email:"BOOL",phone:"BOOL",card:"BOOL",account:"BOOL",submit_account:"BOOL",save_account:"BOOL",save_card:"BOOL",password:"BOOL",real_card:"BOOL",identity:"BOOL",address:"BOOL"});return a.enableCaching("domain"),e.extend(a,n.DefaultActions,{routes:{"read/blacklist/domain/:domain":"findByDomain","create/blacklist":"create","create/blacklist/domain/:id":"findOrCreateForDomain","update/blacklist/:id":"updateOrCreate"},updateDNT:function(e,t){t.tracker?ABINE_DNTME.dnt_api.allow("*",e):ABINE_DNTME.dnt_api.block("*",e)},findByDomain:function(e,t){return ABINE_DNTME.maskme_installed?void a.respondWithJSON({domain:e.params[0],tracker:!0},e,t):void this.findBy("domain",e.params[0],function(n){n||(n=new r.Blacklist({domain:e.params[0]})),a.respondWithJSON(n.toJSON(),e,t)})},findOrCreateForDomain:function(e,t){a.findOrCreate(e,function(n){a.respondWithJSON(n.toJSON(),e,t)})},updateOrCreate:function(n,s){if(!n.payload.domain)return void(s?s.call(this,new a):n.returnEntities&&n.returnEntities(new a));var o=n.params[0];this.load(o,function(c){function l(){u||c.tracker||c.email||c.phone||c.card||c.account||c.save_account||c.password||c.address||c.real_card||c.save_card||c.identity||c.submit_account||t.remove(c),t.flush(null,function(){s?s.call(this,c):n.returnEntities&&n.returnEntities(c)})}var u=!1;c||(u=!0,c=new a({id:o,domain:n.payload.domain})),r.Preference.batchFindBy([{by:"key",value:"entitledToPayments"},{by:"key",value:"entitledToPhone"},{by:"key",value:"authToken"},{by:"key",value:"hasEnabledPayments"},{by:"key",value:"regPassword"}],function(s){n.payload.changed in{email:1,tracker:1,account:1,save_account:1,password:1,address:1,real_card:1,identity:1,save_card:1,submit_account:1}||1==n.payload[n.payload.changed]||n.payload.trusted?(e.extend(c,n.payload),t.add(c),"tracker"==n.payload.changed?a.updateDNT(c.domain,c):ABINE_DNTME.dnt_api.markSettingsChanged(n.sender,n.payload.changed),l()):"phone"==n.payload.changed&&0==n.payload.phone&&s.entitledToPhone&&s.entitledToPhone.isTrue()?r.ShieldedPhone.index(null,function(r){0!=r.length&&r[0].isValidated()||n.payload.suppressWebapp||i.openPhones(),e.extend(c,n.payload),t.add(c),ABINE_DNTME.dnt_api.markSettingsChanged(n.sender,n.payload.changed),l()}):"card"==n.payload.changed&&0==n.payload.card&&s.entitledToPayments&&s.entitledToPayments.isTrue()?(s.hasEnabledPayments&&s.hasEnabledPayments.isTrue()?(e.extend(c,n.payload),
t.add(c),ABINE_DNTME.dnt_api.markSettingsChanged(n.sender,n.payload.changed)):n.payload.suppressWebapp||i.openCards(),l()):(n.payload.suppressWebapp||i.openPremium(n.payload.changed+"Toggle",n.payload.changed),l())})})},findOrCreate:function(e,t){e.params=e.params||[];var n=e.payload.domain||e.params[0];a.findBy("domain",n,function(r){r?t(r):a.create({payload:{domain:n,tracker:!!e.payload.tracker,email:!!e.payload.email,phone:!!e.payload.phone,card:!!e.payload.card,account:!!e.payload.account,save_account:!!e.payload.save_account,login:!!e.payload.login,address:!!e.payload.address,real_card:!!e.payload.real_card,password:!!e.payload.password}},function(e){t(e)})})}}),a.useLocalStorage(),r.Blacklist=a,a}),ABINE_DNTME.define("abine/storage/companyAccount",["documentcloud/underscore","persistence","abine/storageMixins","storage","abine/config","abine/crypto","abine/securityManager","abine/licenseServer"],function(e,t,n,r,i,a,s,o){function c(e){var t,n,r;return n=e.account_id,r=e.updated_at,t=e.user_name,(e=a.decryptKey(s.getCompanyEncryptionKey(),e.data))?(e=JSON.parse(e),e.id=n,e.modifiedAt=r,n.indexOf("_")!==-1&&(e.createdAt=r),e.createdAt&&""!==e.createdAt||(e.createdAt=new Date),e.modifiedAt&&""!==e.modifiedAt||(e.modifiedAt=e.createdAt),e.modifiedBy=t,e):void this.collection.trigger("error","decryption error")}var l=t.define("CompanyAccount",{domain:"TEXT",label:"TEXT",page_host:"TEXT",form_host:"TEXT",protocol:"TEXT",email:"TEXT",username:"TEXT",password:"TEXT",login_url:"TEXT",isCompanyAccount:"INTEGER",createdAt:"DATE",modifiedAt:"DATE"});return l.enableCaching(),e.extend(l,n.DefaultActions,{routes:{"read/account/all":"index","update/account/:id":"update"},fetchFromServer:function(n){this.clearCache(),(new o).getCompanyAccounts({},function(r,i){if(!r){var a=i.accounts;e.each(a,function(e){e=c(e),e.isCompanyAccount=1,t.add(new l(e))})}n&&n()})},getAccountsForDomain:function(e,t){var n=e.params[0];r.CompanyAccount.index("domain",n,function(n){t?t.call(this,n):e.returnEntities&&e.returnEntities(n)})},getLoginsForDomain:function(t,n){var i=t.params[0];r.CompanyAccount.listCached("domain",i,function(r){r=e.sortBy(r,function(e){return e.modifiedAt}).reverse(),n?n.call(this,r):t.returnEntities&&t.returnEntities(r)})}}),r.CompanyAccount=l,l}),ABINE_DNTME.define("abine/storage/disposableCard",["documentcloud/underscore","persistence","abine/storageMixins","storage","abine/paymentsServer","abine/config","persistence/caching"],function(e,t,n,r,i){var a=t.define("DisposableCards",{shielded_card_id:"INTEGER",active:"INTEGER",guid:"INTEGER",gift:"INTEGER",company:"INTEGER",recipient_email:"TEXT",total_fee:"INTEGER",number:"TEXT",last_four:"TEXT",domain:"TEXT",expiry_month:"TEXT",expiry_year:"TEXT",cvc:"TEXT",original_amount:"TEXT",amount_refunded:"TEXT",type:"TEXT",serverCreatedAt:"TEXT",activeToDate:"TEXT",createdAt:"DATE",modifiedAt:"DATE",request_id:"TEXT",deactivate_request_id:"TEXT",payment_source:"TEXT",source:"TEXT",pushVersion:"INTEGER"});return a.enableCaching(),e.extend(a,n.DefaultActions,{routes:{"read/disposableCard/all":"index","read/disposableCard/:id":"findOrFetchCard","search/disposableCard/:q":"search","read/disposableCard/domain/:id":"getCardsForDomain","delete/disposableCard/:id":"destroy","create/disposableCard":"createOnServer","update/disposableCard/:id":"update"},getCardsForDomain:function(e,t){var n=e.params[0];r.DisposableCard.listCached(function(e){return e.domain==n&&(e.last_four||e.number.length>0)},function(n){t?t.call(this,n):e.returnEntities&&e.returnEntities(n)})},search:function(e,t){var n=new RegExp(atob(e.params[0]),"i");r.DisposableCard.listCached(function(e){return e.last_four&&e.last_four.match(n)||e.domain&&e.domain.match(n)},function(n){t?t.call(this,n):e.returnEntities&&e.returnEntities(n)})},getAllCards:function(n,s){this.paymentsServer=this.paymentsServer||new i,this.paymentsServer.getCards({active_only:!0},function(i,o){i||r.DisposableCard.index(null,function(i){var c={};e.each(i,function(e){c[e.id]=e}),e.each(o.cards,function(e){c[e.id]||(e.original_amount=e.requested_amount,c[e.id]=new r.DisposableCard(e),t.add(c[e.id])),c[e.id].createdAt=e.created_at,c[e.id].active=e.active}),t.flush(function(){var t=e.map(i,function(e){return e.toJSON()});a.respondWithJSON(t,n,s)})})})},update:function(n,r){this.paymentsServer=this.paymentsServer||new i,a.findBy("guid",n.payload.guid,e.bind(function(e){this.paymentsServer.updateCard({card_id:n.payload.guid,purpose:n.payload.purpose},function(i){i?n.payload.status="error":(n.payload.status="success",n.payload.active=!1,e&&(e.active=!1,t.flush(e))),a.respondWithJSON(n.payload,n,r)})},this))},findOrFetchCard:function(n,r){this.paymentsServer=this.paymentsServer||new i,a.findBy("id",n.params[0],e.bind(function(e){e&&e.number?a.respondWithJSON(e,n,r):this.paymentsServer.getCard(e.card_guid,function(i,s){i?r(null):(e=e||new a,e.guid=s.card_guid,e.source=s.source,e.number=s.card_number,e.expiry_year=s.expiry_year,e.expiry_month=s.expiry_month,e.cvc=s.cvc,e.original_amount=s.requested_amount,e.active=s.active,e.domain=s.domain,e.type=s.type,e.serverCreatedAt=s.created_at,e.activeToDate=s.active_to_date,e.payment_source=s.payment_source,t.add(e),t.flush(),a.respondWithJSON(e,n,r))})},this))},generateRequestId:function(){return t.createUUID()},createOnServer:function(e,n){this.paymentsServer=this.paymentsServer||new i;var s=new r.DisposableCard({request_id:a.generateRequestId(),domain:e.payload.domain,gift:e.payload.gift?1:0,company:e.payload.company?1:0,payment_source:e.payload.payment_method,original_amount:e.payload.amount,createdAt:new Date,modifiedAt:new Date}),o={amount:s.original_amount,request_id:s.request_id,domain:s.domain,biometricKey:e.payload.biometricKey,biometricToken:e.payload.biometricToken,card_use:e.payload.gift?"gift":e.payload.company?"company":"personal",payment_method:e.payload.payment_method,source:e.payload.source};e.payload.months&&(o.months=e.payload.months),e.payload.gift&&(o.gift={sender_name:e.payload.senderName,receiver_name:e.payload.firstName+" "+e.payload.lastName,recipient_email:e.payload.recipient_email},s.recipient_email=e.payload.recipient_email),e.payload.company&&(o.company=!0),t.add(s),t.flush(),this.paymentsServer.createCard(o,function(i,a){i?(t.remove(s),t.flush(function(){e.returnErrObj(i)})):(r.Preference.decrementByIntegerIfExists({key:"cardsEarned",value:1,options:{nonNegative:!0}},function(){}),s.guid=a.card_id,s.number=a.card.card_number,s.expiry_year=a.card.expiry_year,s.expiry_month=a.card.expiry_month,s.cvc=a.card.cvc,s.original_amount=a.card.original_amount,s.active=1,s.type=a.card.type,s.serverCreatedAt=a.card.created_at,s.activeToDate=a.card.active_to_date,s.total_fee=a.total_fee,s.payment_source=a.card.payment_source,s.source=e.payload.source,t.flush(null,function(){n?n.call(this,s):e.returnEntities&&e.returnEntities(s)}))})}}),r.DisposableCard=a,a}),ABINE_DNTME.define("abine/storage/disposableEmail",["documentcloud/underscore","persistence","abine/storageMixins","abine/emailServer","storage","abine/config"],function(e,t,n,r,i,a){var s=t.define("DisposableEmails",{accountId:"TEXT",guid:"TEXT",targetId:"INT",targetGuid:"TEXT",user:"TEXT",domain:"TEXT",active:"INTEGER",createdAt:"DATE",mails:"INTEGER",label:"TEXT",modifiedAt:"DATE",pushVersion:"INTEGER"});return s.enableCaching("user"),s.enableIndexing("label"),e.extend(s.prototype,{getAddress:function(){return this.user+"@"+this.domain}}),e.extend(s,n.DefaultActions,{routes:{"read/disposableEmail/all":"indexFromServer","search/disposableEmail/:q":"search","read/disposableEmail/allLocal":"indexLocal","read/disposableEmail/domain/:id":"getEmailsForDomain","create/disposableEmail":"createOnServer"},getEmailsForDomain:function(e,t){var n=e.params[0];i.DisposableEmail.listByIndex(n,function(n){t?t.call(this,n):e.returnEntities&&e.returnEntities(n)})},search:function(e,t){var n=new RegExp(atob(e.params[0]),"i");i.DisposableEmail.listCached(function(e){return e.user&&e.user.match(n)||e.domain&&e.domain.match(n)},function(n){t?t.call(this,n):e.returnEntities&&e.returnEntities(n)})},indexLocal:function(t,n){i.ShieldedEmail.index(null,e.bind(function(r){if(r.length>0){r[0];i.DisposableEmail.index(null,function(r){var i=e.map(r,function(e){return e.toJSON()});s.respondWithJSON(i,t,n)})}else s.respondWithJSON([],t,n)},this))},indexFromServer:function(n,a){this.emailServer=this.emailServer||new r,i.ShieldedEmail.index(null,e.bind(function(r){if(r.length>0){var o=r[0];this.emailServer.readDisposables({guid:o.guid},function(r,o){r?(ABINE_DNTME.log.error("[ERROR HANDLER]#[abine/storage/disposableEmail]#[indexFromServer]# error event in server.makeRequest"),s.respondWithJSON([],n,a)):i.DisposableEmail.index(null,function(r){var c={};e.each(r,function(e){c[e.guid]=e}),e.each(o.disposables,function(e){c[e.guid]||(c[e.guid]=new i.DisposableEmail(e),t.add(c[e.guid])),c[e.guid].createdAt=e.created_at||e.created,c[e.guid].mails=e.num_mails,c[e.guid].active=e.active}),t.flush(function(){var t=e.map(r,function(e){return e.toJSON()});s.respondWithJSON(t,n,a)})})})}else s.respondWithJSON([],n,a)},this))},createOnServer:function(t,n){this.emailServer=this.emailServer||new r;var o=null;i.DisposableEmail.findBy("accountId",o,e.bind(function(r){if(r)n?n(r):t.returnEntities(r);else{var o=e.bind(function(){var e=a.disposableDomain,r={label:t.payload.label,domain:e,source:t.payload.source};t.payload.customName&&(r.custom=t.payload.customName,r.domain=t.payload.customDomain),this.emailServer.generateDisposable(r,function(e,r){e?(ABINE_DNTME.log.error("[ERROR HANDLER]#[abine/storage/disposableEmail]#[createOnServer]# error event in server.generateDisposable"),t.returnError(e)):(t.payload.guid=r.guid,t.payload.domain=r.domain,t.payload.user=r.user,t.payload.active=1,t.payload.createdAt=r.created,s.create(t,n))})},this);t.payload.label&&"MaskMe Feedback"==t.payload.label?i.DisposableEmail.findBy("label","MaskMe Feedback",function(e){e?n?n(e):t.returnEntities(e):o()}):o()}},this))}}),i.DisposableEmail=s,s}),ABINE_DNTME.define("abine/storage/disposablePhone",["documentcloud/underscore","persistence","abine/storageMixins","storage","modules","persistence/caching"],function(e,t,n,r,i){var a=t.define("DisposablePhones",{accountId:"TEXT",shielded_phone_id:"INTEGER",rails_id:"INTEGER",country_code:"TEXT",number:"TEXT",createdAt:"DATE",modifiedAt:"DATE",pushVersion:"INTEGER",isSuspended:"TEXT",released:"TEXT",nextBillingDate:"DATE"});return a.enableCaching(),e.extend(a.prototype,{getPrettyNumber:function(){var e="("+this.getAreaCode()+") "+this.getExchange()+"-"+this.getLocal();return e},getAreaCode:function(){return this.number.substr(0,3)},getExchange:function(){return this.number.substr(3,3)},getLocal:function(){return this.number.substr(6,4)}}),e.extend(a,n.DefaultActions,{routes:{"read/disposablePhone/all":"index","read/disposablePhone/:id":"show","delete/disposablePhone/:id":"destroy","create/disposablePhone":"createFromDatabase"},createFromDatabase:function(e,n){r.DisposablePhone.all().one(function(a){a&&(e.payload.filling&&a.released?r.ShieldedPhone.index(null,function(r){i.phoneModule.restorePhone({restore:!0,id:r[0].rails_id},function(r,i){r||!i.shielded_phone||0==i.shielded_phone.disposable_phones.length?e.returnError(r):(a.number=i.shielded_phone.disposable_phones[0].number,a.released=!1,e.payload.released=a.released,e.payload.number=a.number,e.payload.country_code=a.country_code,t.flush(),n?n.call(this,a):e.returnEntities&&e.returnEntities(a))})}):(n?n.call(this,a):e.returnEntities&&e.returnEntities(a),e.payload.filling&&r.ShieldedPhone.index(null,function(e){i.phoneModule.logDisposableFilled(e[0].rails_id)})))})}}),r.DisposablePhone=a,a}),ABINE_DNTME.define("abine/storage/dntStats",["documentcloud/underscore","persistence","abine/storageMixins","storage","abine/localStorage","abine/securityManager","abine/badgeManager"],function(e,t,n,r,i,a,s){var o=t.define("DntStats",{totalAllTimeTrackers:"INTEGER",dailyTrackerCounts:"TEXT",badTrackers:"TEXT",viewedBadge:"BOOL",earnedOn:"INTEGER",currentBadge:"TEXT",currentBadgeIndex:"INTEGER"});return o.enableCaching(),e.extend(o,n.DefaultActions,{routes:{"create/dntStats":"create","read/dntStats/all":"index","read/dntStats/getBadgeData":"getBadgeData","update/dntStats/:id":"update"},getBadgeData:function(e){e.returnJSON(s.badges)}}),o.useLocalStorage(),r.DntStats=o,o}),ABINE_DNTME.define("abine/storage/emailDomain",["documentcloud/underscore","persistence","abine/storageMixins","storage","abine/config","abine/crypto","abine/securityManager","abine/emailServer"],function(e,t,n,r,i,a,s,o){var c=t.define("EmailDomain",{domain:"TEXT"});return c.enableCaching(),e.extend(c,n.DefaultActions,{routes:{"read/emailDomain/all":"index"},fetchFromServer:function(n){if(this._waitCallbacks)return void this._waitCallbacks.push(n);this._waitCallbacks=[n];var r=this;this.clearCache(),(new o).getDomains(function(n,i){if(!n){var a=i.data;e.each(a,function(e){c.findBy("domain",e,function(n){n||t.add(new c({domain:e}))})})}var s=r._waitCallbacks;r._waitCallbacks=null,s.forEach(function(e){e&&e()})})}}),r.EmailDomain=c,c}),ABINE_DNTME.define("abine/storage/extensionVersion",["documentcloud/underscore","persistence","abine/storageMixins","storage"],function(e,t,n,r){var i=t.define("ExtensionVersion",{newVersionAvailable:"BOOL",version:"TEXT",error:"BOOL"});return e.extend(i,n.DefaultActions,{routes:{"read/extensionVersion/:id":"getNewVersion"},getNewVersion:function(e,t){function n(){i.respondWithJSON(a,e,t)}var a={error:!0};ABINE_DNTME.require(["modules"],function(e){e.mappingsModule.forceMappingUpdate(!0,function(){a.error=!1,r.Preference.findBy("key","new_version",function(e){e&&(a.newVersionAvailable=!0,a.version=e.value),n()})})})}}),r.ExtensionVersion=i,i}),ABINE_DNTME.define("abine/storage/fieldData",["documentcloud/underscore","persistence","abine/storageMixins","storage","abine/localStorage","abine/crypto"],function(e,t,n,r,i,a){var s=t.define("FieldData",{className:"TEXT",dataType:"TEXT",detectedType:"TEXT",mappedType:"TEXT",fieldType:"TEXT",fieldId:"TEXT",label:"TEXT",maxlength:"INTEGER",name:"TEXT",position:"INTEGER",signature:"TEXT",size:"INTEGER",maskedValue:"TEXT",matchedDataType:"TEXT",domain:"TEXT",formSignature:"TEXT",formHost:"TEXT",formId:"TEXT",fieldCount:"INTEGER",pageUrl:"TEXT",pageHost:"TEXT",formType:"TEXT",mappedFormType:"TEXT"});return e.extend(s,n.DefaultActions,{routes:{},createLocal:function(t,n){r.Preference.findBy("key","shouldSendErrorReports",e.bind(function(n){if(!n||n.isTrue()){var r=i.getItem("fieldData-to-push");if(r)try{r=JSON.parse(r)}catch(e){r={}}else r={};var s=e.size(r),o=r[t.payload.formId];o&&"sequenceId"in o&&(s=o.sequenceId),t.form.sequenceId=s,r[t.payload.formId]=t.form;var c=a.sha1(t.payload.formId+t.payload.signature).toString(),l=r[c];if(r[c]=t.payload,l&&l.fillType)try{r[c].fillType=(10*parseInt(l.fillType)+t.payload.fillType)%100}catch(e){r[c].fillType=t.payload.fillType}e.each(t.allFields,function(e){var t=a.sha1(e.formId+e.signature).toString();t in r?(r[t].maskedValue=e.maskedValue,r[t].hidden=e.hidden):r[t]=e}),i.setItem("fieldData-to-push",JSON.stringify(r))}else i.removeItem("fieldData-to-push")},this)),n?n(t.payload):t.returnEntities(t.payload)}}),r.FieldData=s,s}),ABINE_DNTME.define("abine/fixtures",["documentcloud/underscore","persistence","storage"],function(){return{createFixtures:function(e){this.createRidiculousDatabase(100,3),e()},getRandomInteger:function(e){return Math.floor(Math.random()*e)},getRandomString:function(e,t){t=t||"abcdefghijklmnopqrstuvwxyz1234567890";for(var n="",r=0;r<12;r++)n+=t.charAt(Math.floor(Math.random()*t.length));return n},generateFieldsForAccount:function(e,t,n){var r={value:this.getRandomString(10)+"@"+(t?"opayq.com":"gmail.com"),dataType:"/contact/email",origin:t?"disposable":"",name:"email"},i={value:r.value,dataType:"/contact/email",origin:t?"disposable":"",name:"confirm_email"},a={value:this.getRandomString(10,"0123456789"),dataType:"/contact/phone",origin:e?"disposable":"",name:"phone"},s={value:n?this.getRandomString(12):["password","tedted","iloveabine","maskme","a"][this.getRandomInteger(5)],dataType:"/password",origin:n?"strong":"",name:"password"},o={value:s.value,dataType:"/password",origin:n?"strong":"",name:"confirm_password"};return[r,i,a,s,o]},asyncCreateAccounts:function(e){if(e.length>0){e.shift()}},createRidiculousDatabase:function(e,t){for(var n=[],r=0;r<e;r++)for(var i="http://"+this.getRandomString(10)+[".com",".net",".org"][Math.floor(3*Math.random())],a=0;a<t;a++)n.push({data:{data:this.generateFieldsForAccount(0==this.getRandomInteger(3),0==this.getRandomInteger(3),0==this.getRandomInteger(3)),pageUrl:i,type:"registrationForm",url:i},fixture:!0,tabId:null});this.asyncCreateAccounts(n)}}}),ABINE_DNTME.define("abine/storage/globalData",["documentcloud/underscore","persistence","abine/storageMixins","storage","abine/webapp"],function(e,t,n,r,i){var a=function(){};e.extend(a,n.DefaultActions,{routes:{"create/globalTracker":"toggleTracker"},toggleTracker:function(e){e.payload.blocked?ABINE_DNTME.dnt_api.block(e.payload.name,"*"):ABINE_DNTME.dnt_api.allow(e.payload.name,"*")}});var s=function(){};e.extend(s,n.DefaultActions,{routes:{"create/globalPreference":"togglePreference"},togglePreference:function(e){"suggestions"==e.payload.name?ABINE_DNTME.dnt_api.setSuggestionsEnabled(e.payload.value):r.Preference.createOrModify({key:e.payload.name,value:e.payload.value?"true":"false"})}});var o=function(){};e.extend(o,n.DefaultActions,{routes:{"create/globalFeature":"toggleFeature"},toggleFeature:function(e,t){function n(n){o.respondWithJSON({name:e.payload.name,value:n?!e.payload.value:e.payload.value},e,t)}"browsing"==e.payload.name?(ABINE_DNTME.dnt_api.setDefaultBlocking(e.payload.value),n(!1)):this.setFeatureState(e.payload.name,e.payload.value,n)},setFeatureState:function(e,t,n){function a(){var i=e;i.match(/helpMeLogin|rememberAccounts|suggest|CheckoutPanelGrowl|rememberCards|submitAccount/)||(i="suggestProtected"+e.charAt(0).toUpperCase()+e.slice(1)),r.Preference.createOrModify({key:i,value:t?"true":"false"},function(){n(!1)})}return n=n||function(){},t&&e in{phone:1,card:1}?void r.Preference.batchFindBy([{by:"key",value:"entitledToPayments"},{by:"key",value:"entitledToPhone"},{by:"key",value:"authToken"},{by:"key",value:"hasEnabledPayments"},{by:"key",value:"suggestProtectedCard"},{by:"key",value:"regPassword"}],function(t){if("phone"==e&&t.entitledToPhone&&t.entitledToPhone.isTrue())r.ShieldedPhone.index(null,function(e){a(),0!=e.length&&e[0].isValidated()||(i.openPhones(),n(!0))});else if("card"==e&&t.entitledToPayments&&t.entitledToPayments.isTrue())if(t.hasEnabledPayments&&t.hasEnabledPayments.isTrue())a();else{var s=!0;t.suggestProtectedCard&&t.suggestProtectedCard.isFalse()&&(t.suggestProtectedCard.setTrue(),s=!1),i.openCards(),n(s)}else if("card"!=e||t.entitledToPayments&&t.entitledToPayments.isTrue())i.openPremium(e+"ToggleGlobal",e),n(!0);else if(!t.hasEnabledPayments||!t.hasEnabledPayments.isTrue()){var s=!0;t.suggestProtectedCard&&t.suggestProtectedCard.isFalse()&&(t.suggestProtectedCard.setTrue(),s=!1),i.openPremium(e+"ToggleGlobal",e),n(s)}}):void a()}});var c=function(){};return e.extend(c,n.DefaultActions,{routes:{"read/globalData/:id":"getGlobalData"},getSettings:function(e){r.Preference.batchFindBy([{by:"key",value:"authToken"},{by:"key",value:"suggestProtectedEmail"},{by:"key",value:"suggestProtectedPhone"},{by:"key",value:"suggestProtectedCard"},{by:"key",value:"suggestRealCard"},{by:"key",value:"suggestIdentities"},{by:"key",value:"promptWhenSavingAccounts"},{by:"key",value:"promptWhenSavingCards"},{by:"key",value:"hasEnabledPayments"},{by:"key",value:"entitledToPhone"},{by:"key",value:"entitledToAccounts"},{by:"key",value:"suggestStrongPassword"},{by:"key",value:"suggestAddresses"},{by:"key",value:"rememberAccounts"},{by:"key",value:"rememberCards"},{by:"key",value:"helpMeLogin"},{by:"key",value:"submitAccount"},{by:"key",value:"showMedals"},{by:"key",value:"showNotifications"},{by:"key",value:"showTrackersOnload"},{by:"key",value:"showInTheKnowGrowls"},{by:"key",value:"showWeeklyReports"},{by:"key",value:"showCheckoutPanelGrowl"},{by:"key",value:"autoPremiumRegisterShown"},{by:"key",value:"shouldSendErrorReports"},{by:"key",value:"shouldSendShoppingFeedback"}],function(t){var n={};n.loggedIn=t.authToken&&""!=t.authToken.value,n.browsing=ABINE_DNTME.dnt_api.getDefaultBlocking(),n.email=t.suggestProtectedEmail&&t.suggestProtectedEmail.isTrue(),n.phone=t.suggestProtectedPhone&&t.suggestProtectedPhone.isTrue(),n.card=t.suggestProtectedCard&&t.suggestProtectedCard.isTrue(),n.suggestions=ABINE_DNTME.dnt_api.getSuggestionsEnabled(),n.showMedals=t.showMedals&&t.showMedals.isTrue(),n.showCheckoutPanelGrowl=t.showCheckoutPanelGrowl&&t.showCheckoutPanelGrowl.isTrue(),n.helpMeLogin=t.helpMeLogin&&t.helpMeLogin.isTrue(),n.submitAccount=t.submitAccount&&t.submitAccount.isTrue(),n.showNotifications=t.showNotifications&&t.showNotifications.isTrue(),n.shouldSendErrorReports=t.shouldSendErrorReports&&t.shouldSendErrorReports.isTrue(),n.shouldSendShoppingFeedback=t.shouldSendShoppingFeedback&&t.shouldSendShoppingFeedback.isTrue(),n.showTrackersOnload=t.showTrackersOnload&&t.showTrackersOnload.isTrue(),n.showInTheKnowGrowls=t.showInTheKnowGrowls&&t.showInTheKnowGrowls.isTrue(),n.showWeeklyReports=!t.showWeeklyReports||t.showWeeklyReports.isTrue(),n.premium=n.loggedIn&&t.entitledToPhone&&t.entitledToPhone.isTrue(),n.accounts=n.loggedIn&&t.entitledToAccounts&&t.entitledToAccounts.isTrue(),n.suggestStrongPassword=t.suggestStrongPassword&&t.suggestStrongPassword.isTrue(),n.rememberAccounts=t.rememberAccounts&&t.rememberAccounts.isTrue(),n.rememberCards=t.rememberCards&&t.rememberCards.isTrue(),n.suggestAddresses=t.suggestAddresses&&t.suggestAddresses.isTrue(),n.suggestRealCard=t.suggestRealCard&&t.suggestRealCard.isTrue(),n.suggestIdentities=t.suggestIdentities&&t.suggestIdentities.isTrue(),n.promptWhenSavingAccounts=t.promptWhenSavingAccounts&&t.promptWhenSavingAccounts.isTrue(),n.promptWhenSavingCards=t.promptWhenSavingCards&&t.promptWhenSavingCards.isTrue(),e(n)})},getGlobalData:function(t,n){var i=ABINE_DNTME.dnt_api.getTabData(t.sender),a=ABINE_DNTME.dnt_api.getTrackerDefaults(),s=[];for(var o in a)s.push({name:o,blocked:a[o]});s.sort(function(e,t){return e=e.name.toLowerCase(),t=t.name.toLowerCase(),e<t?-1:e>t?1:0}),this.getSettings(e.bind(function(a){r.Blacklist.index(null,e.bind(function(o){var l=[];e.each(o,function(e){var e=e.toJSON();a.accounts&&(e.globalAccounts=!0),l.push(e)});var u=[],d=[],h={suggestions:1,showMedals:1,shouldSendErrorReports:1,showInTheKnowGrowls:1,showWeeklyReports:1,promptWhenSavingCards:1,promptWhenSavingAccounts:1,shouldSendShoppingFeedback:1},f={browsing:1,rememberAccounts:1,rememberCards:1,helpMeLogin:1,submitAccount:1,suggestStrongPassword:1,showCheckoutPanelGrowl:1,suggestRealCard:1,suggestIdentities:1,suggestAddresses:1,card:1,email:1,phone:1};ABINE_DNTME.maskme_installed&&(h={suggestions:1,showMedals:1},f={browsing:1});for(var p in h)p in a&&(u.push({name:p,value:a[p]}),delete a[p]);for(var m in f)d.push({name:m,value:a[m]}),delete a[m];a.tabId=i.tabId,a.host=i.host,a.trackers=s,a.preferences=u,a.globalFeatures=d,a.blacklist=l.sort(function(e,t){return(e.domain||"").localeCompare(t.domain)}),a.maskmeInstalled=!!ABINE_DNTME.maskme_installed,r.Preference.findBy("key","new_version",function(e){e&&(a.new_version=e.value),c.respondWithJSON(a,t,n)})},this))},this))}}),r.GlobalData=c,r.GlobalTracker=a,r.GlobalPreference=s,r.GlobalFeature=o,c}),ABINE_DNTME.define("abine/storage/identity",["documentcloud/underscore","persistence","abine/storageMixins","storage"],function(e,t,n,r){var i=t.define("Identity",{label:"TEXT",first_name:"TEXT",middle_name:"TEXT",last_name:"TEXT",email:"TEXT",phone:"TEXT",card:"TEXT",address_id:"TEXT",password:"TEXT",dob_year:"TEXT",dob_month:"TEXT",dob_day:"TEXT",gender:"TEXT",username:"TEXT",url:"TEXT",company:"TEXT",designation:"TEXT",ssn:"TEXT",driver_license:"TEXT",pushed:"INTEGER",createdAt:"DATE",modifiedAt:"DATE"});return i.enableCaching(),e.extend(i,n.DefaultActions,{routes:{"read/identity/all":"indexWithAddress","create/identity":"create"},indexWithAddress:function(t,n){r.Address.index(null,function(i){var a={};e.each(i,function(e){a[e.id]=e.toJSON()});var s={},o={};r.Identity.index(null,function(i){var c=[];e.each(i,function(e){e=e.toJSON(),e.type="identity",e.address_id&&e.address_id in a?(e.address=a[e.address_id],s[e.address_id]=!0):e.address=e.address_id=null,o[(e.first_name+e.last_name).toLowerCase().replace(/\s+/g,"")]=!0,c.push(e)}),e.each(a,function(e,t){if(!(t in s)&&e.first_name&&e.last_name){var n=(e.first_name+e.last_name).toLowerCase().replace(/\s+/g,"");if(n in o)return;c.push({id:t,type:"address",address:e,address_id:t,first_name:e.first_name,last_name:e.last_name,label:e.first_name+" "+e.last_name+" - "+e.label})}}),r.RealCard.index(null,function(e){n?n.call(this,c):t.returnJSON(c)})})})}}),i.useEncryption(["email","dob_year","dob_month","dob_day","gender","label","first_name","middle_name","last_name","username","url","company","designation","ssn","driver_license","phone"]),i.useSyncStorage(),r.Identity=i,i}),ABINE_DNTME.define("abine/storage/loginUrl",["documentcloud/underscore","persistence","abine/storageMixins","storage","abine/lruCache","abine/crypto","abine/localStorage"],function(e,t,n,r,i,a,s){function o(e){return a.md5(e).substr(0,2)}var c=t.define("LoginUrl",{domain:"TEXT",href:"TEXT",events:"TEXT"}),l=50,u=new i(l);return e.extend(c,n.DefaultActions,{routes:{"read/loginUrl/site/:id":"loginUrlForSite"},loginUrlForSite:function(e,t){function n(){t?t(a):e.returnJSON(a)}var i=e.params[0],a=null;return i&&"null"!=i&&(a=u.fetch(i),!a)?void r.LoginUrl.getByDomain(i,function(e){a=e,u.add(i,a),n()}):void n()},getByDomain:function(e,t){var n=o(e),r=s.getItem("loginurl-"+n,null);r?(r=JSON.parse(r),t(r[e])):t(null)},getAllLoginUrls:function(e){var t=s.getItem("loginurl-buckets",null),n=[];if(t){t=JSON.parse(t);for(var r=0;r<t.length;r++){var i=s.getItem("loginurl-"+t[r],null);if(i){i=JSON.parse(i);for(var a in i)for(var o=i[a],c=0;c<o.length;c++)n.push(o[c])}}}e(n)},saveAll:function(e){var t={},n=[];for(var r in e){var i=o(r);i in t||(t[i]={},n.push(i)),t[i][r]=e[r]}s.setItem("loginurl-buckets",JSON.stringify(n));for(var i in t)s.setItem("loginurl-"+i,JSON.stringify(t[i]));this.clearCache()},clearCache:function(){delete u,u=new i(l)}}),r.LoginUrl=c,c}),ABINE_DNTME.define("abine/storage/mappedField",["documentcloud/underscore","persistence","abine/storageMixins","storage"],function(e,t,n,r){var i=t.define("MappedField",{formId:"TEXT",signature:"TEXT",dataType:"TEXT"});return e.extend(i,n.DefaultActions,{routes:{"read/mappedField/all":"index","read/mappedField/:id":"show","create/mappedField":"create","update/mappedField/:id":"update","delete/mappedField/:id":"destroy"}}),r.MappedField=i,i}),ABINE_DNTME.define("abine/storage/mappedForm",["documentcloud/underscore","persistence","abine/storageMixins","storage","abine/lruCache","abine/crypto","abine/localStorage","abine/ajax","abine/storage/preference","abine/timer"],function(e,t,n,r,i,a,s,o,c,l){function u(e){return a.md5(e).substr(0,2)}function d(t,n){var r=[];return t&&(r=t),n&&(e.each(n,function(e){e.local=!0}),r.length>0?e.each(n,function(t){var n=e.find(r,function(e){return e.signature==t.signature});n?(n.local=!0,n.formType=t.formType,e.each(t.fields,function(r){var i=e.find(n.fields,function(e){return e.signature==r.signature});i?i.dataType=r.dataType:t.fields.push(r)})):r.push(t)}):r=n),r}!function(){if("Firefox"!=ABINE_DNTME.config.browser){var t=s.getItem("embedded-rules-version"),n=!0;t&&o.ajax({url:"/mappings-version.txt",success:function(e){parseInt(e)<=parseInt(t)&&(n=!1)},async:!1}),n&&o.ajax({url:"/mappings.json",success:function(t){try{var t=JSON.parse(t);s.setItem("embedded-rules-version",t.version);var n=[];e.each(t.mappings,function(e){var t={domain:e.domain,signature:e.signature,mapping_signature:e.mapping_signature,formType:e.formType,fields:e.fields};n.push(t)}),h.saveAllForms(n),r.Preference.createOrModify({key:"mapping-version",value:t.version})}catch(e){}}})}}();var h=t.define("MappedForm",{domain:"TEXT",signature:"TEXT",mapping_signature:"TEXT",formType:"TEXT",strData:"TEXT"}),f=50,p=new i(f);return e.extend(h,n.DefaultActions,{routes:{"read/mappedForm/all":"index","read/mappedForm/:id":"show","read/mappedForm/site/:id":"mappingsForSite","read/mappedForm/local/:id":"localMappingForSite","create/mappedForm":"createLocal","update/mappedForm/:id":"update","delete/mappedForm/:id":"destroy"},createLocal:function(t,n){function i(){t.returnJSON?t.returnJSON([]):n&&n()}var a=JSON.parse(t.payload.strData),o=a.domain,c=u(o),l=s.getItem("lMapping-"+c,null),d=null;if(l)l=JSON.parse(l),d=l[o];else{var h=s.getItem("lMapping-buckets",null);h=h?JSON.parse(h):[],h.indexOf(c)==-1&&(h.push(c),s.setItem("lMapping-buckets",JSON.stringify(h))),l={}}var f=null;if(d?(f=e.find(d,function(e){return e.signature==a.signature}),f&&(d=e.filter(d,function(e){return e.signature!=a.signature}),e.each(f.fields,function(t){if(t.right_click){var n=e.find(a.fields,function(e){return e.signature==t.signature});n&&(n.right_click=!0)}}))):d=[],t.payload.changed){var p={domain:o,signature:a.signature,formType:a.formType,fields:[]};e.each(a.fields,function(e){p.fields.push({signature:e.signature,dataType:e.dataType,right_click:!!e.right_click})}),d.push(p)}l[o]=d,s.setItem("lMapping-"+c,JSON.stringify(l)),r.Preference.findBy("key","shouldSendErrorReports",e.bind(function(n){if(!n||n.isTrue()){var r=s.getItem("mapping-to-push");if(r)try{r=JSON.parse(r)}catch(e){r={}}else r={};t.payload.changed?(r[a.signature]=a,e.each(a.fields,function(e){e.label&&(e.label=e.label.replace(/(^\s+)|(\s+$)/g,"").replace(/\s+/g," "))})):delete r[a.signature],s.setItem("mapping-to-push",JSON.stringify(r))}else s.removeItem("mapping-to-push")},this)),this.clearCache(),r.Preference.findBy("key","mapping:mapper",function(n){r.Preference.findBy("key","mapping:reviewer",function(r){n||r?(console.log("**** pushing mapping"),ABINE_DNTME.require(["modules"],function(r){r.mappingsModule.forceMappingUpdate(function(){if(i(),t.payload.formHtml){var a={id:t.payload.formSignature,my_mapping:!0,mapper:n?n.value:null};r.mappingsModule.getOneFormMappings(a,e.bind(function(n){var i=e.find(n,function(e){return e.self});i&&i.id&&r.mappingsModule.sendFormBlob({form_id:i.id,html:t.payload.formHtml},function(){})},this))}})})):(console.log("**** not pushing mapping"),i())})})},mappingsForSite:function(e,t){var n=e.params[0];if("null"==n)return void(e.returnJSON?e.returnJSON([]):t&&t());var i=p.fetch(n);i?e.returnJSON(i):r.MappedForm.getByDomain(n,function(t){p.add(n,t),e.returnJSON(t)})},localMappingForSite:function(e){var t=e.params[0];r.MappedForm.getByDomain(t,function(t){e.returnJSON(t)},!0)},getByDomain:function(e,t,n){var r=u(e);if(!n){var i=s.getItem("mapping-"+r,null);i&&(i=JSON.parse(i),i=i[e])}var a=s.getItem("lMapping-"+r,null);a&&(a=JSON.parse(a),a=a[e]),t(d(i,a))},getAllForms:function(e){var t=s.getItem("mapping-buckets",null),n=[];if(t){t=JSON.parse(t);for(var r=0;r<t.length;r++){var i=s.getItem("mapping-"+t[r],null);if(i){i=JSON.parse(i);for(var a in i)for(var o=i[a],c=0;c<o.length;c++)n.push(o[c])}}}e(n)},saveAllForms:function(e){for(var t={},n=[],r=0;r<e.length;r++){var i=e[r],a=u(i.domain);a in t||(t[a]={},n.push(a)),i.domain in t[a]||(t[a][i.domain]=[]),t[a][i.domain].push(i)}for(var r=0;r<256;r++)s.removeItem("mapping-"+(r<16?"0"+r.toString(16):r.toString(16)));s.setItem("mapping-buckets",JSON.stringify(n));var o=0;for(var a in t)l.setTimeout(function(e){return function(){s.setItem("mapping-"+e,JSON.stringify(t[e]))}}(a),o),o+=20;this.clearCache()},clearForms:function(){var e=s.getItem("mapping-buckets",null);if(e){s.removeItem("mapping-buckets"),e=JSON.parse(e);for(var t=0;t<e.length;t++)s.removeItem("mapping-"+e[t])}},clearCache:function(){delete p,p=new i(f)}}),r.MappedForm=h,h}),ABINE_DNTME.define("abine/storage/note",["documentcloud/underscore","persistence","abine/storageMixins","abine/emailServer","storage","abine/config"],function(e,t,n,r,i){var a=t.define("Note",{label:"TEXT",domain:"TEXT",description:"TEXT",pushed:"INTEGER",createdAt:"DATE",modifiedAt:"DATE"});return a.enableCaching(),e.extend(a,n.DefaultActions,{routes:{"read/note/all":"index"}}),a.useEncryption(["label","description","domain"]),a.useSyncStorage(),i.Note=a,a}),ABINE_DNTME.define("abine/storage/pageData",["documentcloud/underscore","persistence","abine/storageMixins","storage","abine/localStorage"],function(e,t,n,r,i){var a=t.define("PageData",{domain:"TEXT"});return e.extend(a,n.DefaultActions,{routes:{"create/pageData":"createLocal"
},createLocal:function(t,n){r.Preference.findBy("key","shouldSendErrorReports",e.bind(function(e){if(!e||e.isTrue()){var n=i.getItem("pageData-to-push");if(n)try{n=JSON.parse(n)}catch(e){n={}}else n={};var r=t.payload,a=r.domain,s=n[a]||"0:0:0:0:0:0:0:0",o=s.split(":"),c="0",l=parseInt(o[1]),u=parseInt(o[2]),d=parseInt(o[3]),h=parseInt(o[4]),f=parseInt(o[5]),p=parseInt(o[6]),m=parseInt(o[7]);r.page_view&&l++,r.login&&u++,r.register&&d++,r.checkout&&h++,r.login_fill&&f++,r.register_fill&&p++,r.checkout_fill&&m++,n[a]=c+":"+l+":"+u+":"+d+":"+h+":"+f+":"+p+":"+m,i.setItem("pageData-to-push",JSON.stringify(n))}else i.removeItem("pageData-to-push")},this)),n&&n({})}}),r.PageData=a,a}),ABINE_DNTME.define("abine/storage/panelActivity",["documentcloud/underscore","persistence","abine/storageMixins","storage"],function(e,t,n,r){var i=t.define("PanelActivity",{panelId:"INTEGER",impressions:"INTEGER",clicks:"INTEGER",users:"INTEGER",completions:"INTEGER",masks:"INTEGER",discloses:"INTEGER",closes:"INTEGER"});return i.enableCaching("panelId"),e.extend(i.prototype,{reset:function(e){e?(this.impressions-=e.impressions,this.clicks-=e.clicks,this.completions-=e.completions,this.users-=e.users,this.masks-=e.masks,this.discloses-=e.discloses,this.closes-=e.closes):(this.impressions=0,this.clicks=0,this.completions=0,this.users=0,this.masks=0,this.discloses=0,this.closes=0),t.flush()},hasData:function(){return this.impressions+this.clicks+this.completions+this.masks+this.discloses+this.closes>0},isMarketingPanel:function(){return this.panelId<1e6}}),e.extend(i,n.DefaultActions,{routes:{"read/panelActivity/all":"index","read/panelActivity/:id":"showByPanelId","create/panelActivity":"create","update/panelActivity/click":"addClick","update/panelActivity/conversion":"addConversion","update/panelActivity/impression":"addImpression","update/panelActivity/masked":"addMasked","update/panelActivity/disclosed":"addDisclosed","update/panelActivity/closed":"addClosed","update/panelActivity/:id":"update","delete/panelActivity/:id":"destroy"},createPanelActivity:function(e){var n=new r.PanelActivity({panelId:e,impressions:0,users:0,clicks:0,masks:0,discloses:0,closes:0,completions:0});return t.add(n),n},updateMetric:function(n,i,a){r.PanelActivity.findBy("panelId",n.payload.panelId,e.bind(function(e){e=e||this.createPanelActivity(n.payload.panelId),n.payload.revert?e[i]--:e[i]++,t.flush(),a?a.call(this,e):n.returnEntities&&n.returnEntities(e)},this))},addImpression:function(e,t){this.updateMetric(e,"impressions",t)},addClick:function(e,t){this.updateMetric(e,"clicks",t)},addMasked:function(e,t){this.updateMetric(e,"masks",t)},addDisclosed:function(e,t){this.updateMetric(e,"discloses",t)},addClosed:function(e,t){this.updateMetric(e,"closes",t)},addConversion:function(e,t){this.updateMetric(e,"completions",t)},showByPanelId:function(e,t){r.PanelActivity.findBy("panelId",e.params[0],function(n){t?t.call(this,n):e.returnEntities&&e.returnEntities(n)})}}),i.useLocalStorage(),r.PanelActivity=i,i}),ABINE_DNTME.define("abine/storage/preference",["documentcloud/underscore","persistence","abine/storageMixins","storage","abine/config","persistence/caching"],function(e,t,n,r,i){var a=function(){},s=t.define("Preferences",{key:"TEXT",value:"TEXT"});return s.enableCaching("key"),e.extend(s.prototype,{setTrue:function(){this.value="true"},setFalse:function(){this.value="false"},isTrue:function(){return 1==this.value||"true"===this.value},isFalse:function(){return!this.isTrue()},isEmpty:function(){return!this.value||""==this.value||"null"==(this.value+"").toLowerCase()}}),e.extend(s,n.DefaultActions,{routes:{"read/preference/all":"index","read/preference/name/:key":"showOneByKey","read/preference/prefspage":"showForPrefsPage","read/preference/:id":"show","create/preference":"create","update/preference/restore":"restore","update/preference/:id":"update","delete/preference/:id":"destroy"},showOneByKey:function(e,t){s.findBy("key",e.params[0],function(n){t?t.call(this,n):e&&e.returnEntities&&e.returnEntities(n)})},getSync:function(e){var t=null;return r.Preference.isCached()&&r.Preference.findBy("key",e,function(e){t=e}),t},findOrCreate:function(e,n){n=n||a,r.Preference.findBy("key",e.key,function(i){if(i)n(i);else{var a=new r.Preference(e);t.add(a),t.flush(function(){n(a)})}})},removeByKey:function(e,n){n=n||a,r.Preference.findBy("key",e,function(e){e?(t.remove(e),t.flush(function(){n(e)})):n(e)})},createOrModify:function(e,n){n=n||a,r.Preference.findBy("key",e.key,function(i){i?i.value=e.value:(i=new r.Preference(e),t.add(i)),t.flush(function(){n(i)})})},createOrIncrementByInteger:function(e,n){n=n||a,r.Preference.findBy("key",e.key,function(i){i?i.value===parseInt(i.value)&&(i.value=i.value+e.value):(i=new r.Preference(e),t.add(i)),t.flush(function(){n(i)})})},decrementByIntegerIfExists:function(e,n){n=n||a,r.Preference.findBy("key",e.key,function(r){r&&r.value===parseInt(r.value)&&(r.value=r.value-e.value,e.options&&e.options.nonNegative&&r.value<0&&(r.value=0)),t.flush(function(){n(r)})})},batchFindBy:function(t,n){n=n||a;var r={};e.async.forEach(t,e.bind(function(e,t){this.findBy(e.by,e.value,function(n){r[e.value]=n,t()})},this),function(){n(r)})},batchRemoveBy:function(n,r){r=r||a,e.async.forEach(n,e.bind(function(e,n){this.findBy(e.by,e.value,function(e){e&&t.remove(e),n()})},this),function(){t.flush(function(){r()})})},batchCreateOrModify:function(t,n){n=n||a,e.async.forEach(t,e.bind(function(e,t){this.createOrModify(e,function(){t()})},this),function(){n()})},retainDefaults:function(n){var i=function(e){return e.key in{entitledToSync:1,entitledToPayments:1,entitledToPhone:1,hasEnabledPayments:1}};r.Preference.listCached(i,e.bind(function(r){e.each(r,function(e){t.remove(e)}),t.flush(function(){n()})},this))},setupUpgradeDefaults:function(n){n=n||a;var r={};e.async.forEach(s._upgradeDefaults,e.bind(function(e,t){this.findBy("key",e.key,function(n){r[e.key]=n,t()})},this),function(){e.each(s._upgradeDefaults,e.bind(function(e){r[e.key]||t.add(new s(e)),t.flush(function(){n()})},this))})}}),s.useLocalStorage(),s._defaults=[{key:"freshInstall",value:"true"},{key:"showNotifications",value:"true"},{key:"helpMeLogin",value:"true"},{key:"showMedals",value:i.silent?"false":"true"},{key:"suggestProtectedEmail",value:i.silent?"false":"true"},{key:"promptWhenSavingAccounts",value:i.silent?"false":"true"},{key:"promptWhenSavingCards",value:i.silent?"false":"true"},{key:"suggestStrongPassword",value:i.silent?"false":"true"},{key:"suggestProtectedPhone",value:i.silent?"false":"true"},{key:"suggestProtectedCard",value:i.silent?"false":"true"},{key:"suggestRealCard",value:i.silent?"false":"true"},{key:"suggestAddresses",value:i.silent?"false":"true"},{key:"suggestIdentities",value:i.silent?"false":"true"},{key:"confirmProtectedCard",value:"true"},{key:"shouldSendErrorReports",value:"true"},{key:"shouldSendShoppingFeedback",value:"true"},{key:"showMapper",value:"false"},{key:"showTrackersOnload",value:(i.silent,"false")},{key:"showInTheKnowGrowls",value:"true"},{key:"showPremiumSubscriptionPanel",value:"true"},{key:"rememberAccounts",value:i.silent?"false":"true"},{key:"submitAccount",value:"true"},{key:"rememberCards",value:i.silent?"false":"true"},{key:"showWeeklyReports",value:i.silent?"false":"true"},{key:"footerCampaign",value:Math.random()>.5?"A":"B"},{key:"countNotifications",value:"0"},{key:"showCheckoutPanelGrowl",value:"false"},{key:"splitTests",value:""},{key:"dnt_language",value:"en"}],s._upgradeDefaults=[{key:"showPrivateSearchState",value:"true"},{key:"suggestRealCard",value:i.silent?"false":"true"},{key:"suggestIdentities",value:i.silent?"false":"true"},{key:"submitAccount",value:"true"},{key:"promptWhenSavingAccounts",value:i.silent?"false":"true"},{key:"promptWhenSavingCards",value:i.silent?"false":"true"},{key:"shouldSendShoppingFeedback",value:"true"},{key:"dnt_language",value:"en"}],r.Preference=s,s}),ABINE_DNTME.define("abine/storage/realCard",["documentcloud/underscore","persistence","abine/storageMixins","storage","abine/config","abine/ajax","abine/localStorage"],function(e,t,n,r,i,a,s){function o(e){e=e.replace(/\D/g,"");var t=d.rules;for(var n in t)if(t.hasOwnProperty(n)&&"prefixes"in t[n])for(var r=t[n],i=0,a=r.prefixes.length;i<a;++i)if(r.prefixes.hasOwnProperty(i)){var s=r.prefixes[i];if(new RegExp("^"+s.toString()).test(e))return n}return!1}function c(e,t){function n(e){var n=i+"_generic";if(e&&e.bin&&i in d.rules){var r=d.rules[i];for(var a in r){var s=r[a];if(s.bank&&e.bank.match(s.bank))if(s.category){if(e.card_category&&e.card_category.match(s.category)){n=a;break}}else n=a}}t(n)}if(!e)return void t({});e=e.replace(/\D/g,"");var r=e.substr(0,6),i=o(e);r in h?n(h[r]):a.ajax({url:"https://www.binlist.net/json/"+r,success:function(e){h[r]=e,n(e)},error:function(){h[r]={},n({})}})}function l(t,n){t||(t=""),t.match(/amex/i)&&(t="american_express");var r=[t,"all"],i=null;return e.each(r,function(e){if(!i&&e in d.rules&&n in d.rules[e]){var t=d.rules[e][n].style;t in d.styles&&(i=d.styles[t])}}),i||"generic"==n||(i=l(t,"generic")),i||{}}function u(t){var n;try{n=s.getItem("card-rules")}catch(e){return void setTimeout(function(){u(!0)},500)}n&&(n=JSON.parse(n),n.version>d.version&&(d=n,t=!0)),t&&(e.each(d.rules,function(t){e.each(t,function(e){e.bank&&(e.bank=new RegExp(e.bank,"i")),e.category&&(e.category=new RegExp(e.category,"i"))})}),e.each(d.offers,function(e){e.domain&&(e.domain_str=e.domain,e.domain=new RegExp(e.domain.replace(/\./g,"\\."),"i")),e.cardType="offer"}))}var d={version:5,rules:{visa:{prefixes:[4],amair:{name:"AAdvantage",bank:"no-match",style:"amair"},bofa_cash:{group:"Bank of America",name:"Cash Rewards",bank:"no-match",style:"chip_card_1"},bofa_travel:{group:"Bank of America",name:"Travel Rewards",bank:"no-match",style:"chip_card_1"},bofa_americard:{group:"Bank of America",name:"BankAmericard",bank:"no-match",style:"chip_card_1"},bofa_default:{group:"Bank of America",name:"Others",bank:"bank.*of.*america",style:"chip_card_1"},barclays_default:{name:"Barclays Bank",bank:"barclays.*bank",style:"chip_card_1"},capone_business_platinum:{group:"Capital One",name:"Business Platinum",bank:"no-match",style:"capone_business_platinum"},capone_quicksilver:{group:"Capital One",name:"Quicksilver",bank:"no-match",style:"capone_quicksilver"},capone_venture:{group:"Capital One",name:"Venture",bank:"no-match",style:"capone_venture"},capone_default:{group:"Capital One",name:"Others",bank:"capital.*one",style:"chip_card_1"},chase_freedom:{group:"Chase",name:"Freedom",bank:"no-match",style:"chase"},chase_sapphire:{group:"Chase",name:"Sapphire",bank:"no-match",style:"chase_sapphire"},chase_slate:{group:"Chase",name:"Slate",bank:"no-match",style:"chase_slate"},chase_united:{group:"Chase",name:"United",bank:"no-match",style:"chase"},chase_marriott:{group:"Chase",name:"Marriott Rewards",bank:"no-match",style:"chip_card_2"},chase_default:{group:"Chase",name:"Others",bank:"chase.*bank",style:"chase"},citi_rewards:{group:"Citi",name:"Rewards",bank:"no-match",style:"citi"},citi_ty_prem:{group:"Citi",name:"Thankyou Premiere",bank:"no-match",style:"citi"},citi_default:{group:"Citi",name:"Others",bank:"no-match",style:"citi"},first_default:{name:"First National Bank",bank:"first.*national.*bank",style:"chip_card_1"},gecap_default:{name:"GE Capital",bank:"no-match",style:"chip_card_1"},greendot_visa:{name:"Green Dot",bank:"no-match",style:"greendot"},marriott:{name:"Marriott Rewards",bank:"no-match",style:"chip_card_2"},southwest:{name:"Southwest Rewards",bank:"no-match",style:"chip_card_2"},pnc_default:{name:"PNC Bank",bank:"pnc.*bank",style:"chip_card_1"},usaa_default:{name:"USAA",bank:"usaa.*bank",style:"chip_card_1"},usbank_default:{name:"US Bank",bank:"us bank",style:"chip_card_1"},wellsfargo_default:{name:"Wells Fargo Bank",bank:"wells.*fargo",style:"chip_card_1"},visa_generic:{name:"Visa",bank:".*",style:"generic"}},mastercard:{prefixes:[51,52,53,54,55],bofa_mlb:{group:"Bank of America",name:"MLB",bank:"no-match",style:"chip_card_1"},bofa_default:{group:"Bank of America",name:"Others",bank:"bank.*of.*america",style:"chip_card_1"},barclays_default:{name:"Barclays Bank",bank:"barclays.*bank",style:"chip_card_1"},capone_default:{name:"Capital One",bank:"capital.*one",style:"chip_card_1"},chase_default:{name:"Chase",bank:"chase.*bank",style:"chase"},citi_biz:{group:"Citi",name:"Business",bank:"no-match",style:"citi"},citi_cashback:{group:"Citi",name:"Cash Back",bank:"no-match",style:"citi"},citi_doublecash:{group:"Citi",name:"Double Cash",bank:"no-match",style:"citi_doublecash"},citi_prof:{group:"Citi",name:"Professional",bank:"no-match",style:"citi"},citi_simplicity:{group:"Citi",name:"Simplicity",bank:"no-match",style:"citi"},citi_ty_pref:{group:"Citi",name:"Thankyou Preferred",bank:"no-match",style:"citi"},citi_default:{group:"Citi",name:"Others",bank:"no-match",style:"citi"},first_default:{name:"First National Bank",bank:"first.*national.*bank",style:"chip_card_1"},gecap_default:{name:"GE Capital",bank:"no-match",style:"chip_card_1"},greendot_mc:{name:"Green Dot",bank:"no-match",style:"greendot"},neteller_mc:{name:"Netellar",bank:"no-match",style:"chip_card_1"},optimal_mc:{name:"Optimal Payments",bank:"no-match",style:"chip_card_3"},pnc_default:{name:"PNC Bank",bank:"pnc.*bank",style:"chip_card_1"},skrill_mc:{name:"Skrill",bank:"no-match",style:"chip_card_3"},usaa_default:{name:"USAA",bank:"usaa.*bank",style:"chip_card_1"},usbank_default:{name:"US Bank",bank:"us bank",style:"chip_card_1"},wellsfargo_default:{name:"Wells Fargo Bank",bank:"wells.*fargo",style:"chip_card_1"},master_generic:{name:"Master Card",bank:".*",style:"generic"}},american_express:{prefixes:[34,37],amex_platinum:{name:"American Express Platinum",bank:"american.*express",category:"platinum",style:"amex_platinum"},amex_gold:{name:"American Express Gold",bank:"american.*express",category:"gold",style:"chip_card_1"},amex_cash:{name:"American Express Cash",bank:"no-match",style:"amex_cash"},britair:{name:"British Airways",bank:"british.*airways",style:"chip_card_1"},amex_delta:{name:"Delta Skymiles",bank:"delta.*sky.*miles",style:"chip_card_1"},amex_generic:{name:"American Express",bank:".*",style:"generic"}},discover:{prefixes:[6011,62,64,65],discover_it:{name:"Discover IT",bank:"no-match",style:"discover_it"},discover_generic:{name:"Discover",bank:".*",style:"generic"}},diners_club:{prefixes:[305,36,38],diners_generic:{name:"Diners Club",bank:".*",style:"generic"}},carte_blanche:{prefixes:[300,301,302,303,304,305]},jcb:{prefixes:[35]},enroute:{prefixes:[2014,2149]},maestro:{prefixes:[5018,5020,5038,6304,6759,6761]},laser:{prefixes:[6304,6706,6771,6709]},all:{homedepot:{name:"Home Depot",bank:"no-match",style:"homedepot"},kohls:{name:"Kohls",bank:"no-match",style:"kohls"},generic:{name:"Others",bank:"no-match",style:"generic"}}},styles:{generic:{base:{"font-size":15,color:"white"},number:{top:73,left:32,"font-size":28},name:{top:175,left:20},expiry:{top:125,left:200},cvc:{top:125,left:50}},amex_platinum:{base:{"font-size":15,color:"white"},number:{top:120,left:32,"font-size":28,padding:5,"background-color":"rgba(0,0,0,0.5)","border-radius":5},name:{top:180,left:40},expiry:{top:180,left:200},cvc:{top:160,left:200}},amex_cash:{base:{"font-size":15,color:"white"},number:{top:120,left:32,"font-size":28,padding:5,"background-color":"rgba(0,0,0,0.5)","border-radius":5},name:{top:180,left:40,color:"black"},expiry:{top:180,left:235,color:"black"},cvc:{top:160,left:235,color:"black"}},amair:{base:{"font-size":15,color:"white"},number:{top:110,left:32,"font-size":28},name:{top:180,left:20},expiry:{top:180,left:150},cvc:{top:160,left:150}},chip_card_1:{base:{"font-size":15,color:"white"},number:{top:120,left:42,"font-size":28},name:{top:180,left:30},expiry:{top:180,left:156},cvc:{top:160,left:150}},chip_card_2:{base:{"font-size":15,color:"white"},number:{top:125,left:32,"font-size":28},name:{top:180,left:20},expiry:{top:180,left:150},cvc:{top:160,left:150}},chip_card_3:{base:{"font-size":15,color:"black"},number:{top:125,left:32,"font-size":28},name:{top:180,left:20},expiry:{top:180,left:150},cvc:{top:160,left:150}},capone_business_platinum:{base:{"font-size":15,color:"black"},number:{top:93,left:32,"font-size":28},name:{top:180,left:120},expiry:{top:135,left:200},cvc:{top:137,left:50}},capone_quicksilver:{base:{"font-size":15,color:"white"},number:{top:113,left:38,"font-size":28},name:{top:180,left:20},expiry:{top:140,left:164},cvc:{top:160,left:164}},capone_venture:{base:{"font-size":15,color:"white"},number:{top:110,left:35,"font-size":28},name:{top:180,left:20},expiry:{top:180,left:230},cvc:{top:160,left:228}},chase_sapphire:{base:{"font-size":15,color:"white"},number:{top:130,left:35,"font-size":28},name:{top:180,left:20},expiry:{top:180,left:230},cvc:{top:160,left:228}},chase:{base:{"font-size":15,color:"white"},number:{top:125,left:32,"font-size":28},name:{top:180,left:20},expiry:{top:180,left:150},cvc:{top:160,left:150}},chase_slate:{base:{"font-size":15,color:"white"},number:{top:125,left:32,"font-size":28},name:{top:180,left:20},expiry:{top:180,left:200},cvc:{top:160,left:200}},citi_doublecash:{base:{"font-size":15,color:"white"},number:{top:125,left:32,"font-size":28},name:{top:180,left:20},expiry:{top:180,left:200},cvc:{top:160,left:200}},citi:{base:{"font-size":15,color:"white"},number:{top:120,left:32,"font-size":28},name:{top:180,left:20},expiry:{top:180,left:150},cvc:{top:160,left:150}},discover_it:{base:{"font-size":15,color:"white"},number:{top:110,left:35,"font-size":28},name:{top:180,left:20},expiry:{top:180,left:230},cvc:{top:160,left:228}},homedepot:{base:{"font-size":15,color:"white"},number:{top:85,left:35,"font-size":28},name:{top:180,left:20},expiry:{top:180,left:170},cvc:{top:160,left:179}},greendot:{base:{"font-size":15,color:"white","text-shadow":"1px 1px 1px #000"},number:{top:93,left:32,"font-size":28},name:{top:180,left:20},expiry:{top:135,left:150},cvc:{top:137,left:20}},kohls:{base:{"font-size":15,color:"white"},number:{top:90,left:60,"font-size":28},name:{top:180,left:60},expiry:{top:180,left:230},cvc:{top:160,left:228}}},offers:[{id:"homedepot",brand:"homedepot",domain:"homedepot.com",url:"https://www.citicards.com/cards/acq/Apply.do?screenID=3211&app=UNSOL&sc=30005&langId=EN&siteId=PLCN_HOMEDEPOT"},{id:"britair",brand:"britair",domain:"britishairways.com",url:"https://creditcards.chase.com/credit-cards/british-airways-credit-card.aspx"}]},h={};u(!0);var f=t.define("RealCard",{label:"TEXT",first_name:"TEXT",last_name:"TEXT",number:"TEXT",expiry_month:"TEXT",expiry_year:"TEXT",cvc:"TEXT",type:"TEXT",brand:"TEXT",address_id:"TEXT",pushed:"INTEGER",createdAt:"DATE",modifiedAt:"DATE"});return e.extend(f.prototype,{detectCardType:function(){this.type=o(this.number)},detectCardBrand:function(){c(this.number,e.bind(function(e){this.brand=e},this))},getFullName:function(){return((this.first_name||"")+" "+(this.last_name||"")).replace(/^[\s]+|[\s]+$]/g,"")},getMM:function(){var e=parseInt(this.expiry_month);return(e<10?"0":"")+e},getYY:function(){var e=parseInt(this.expiry_year);return e%100},getMMYY:function(){var e=this.getMM(),t=parseInt(this.expiry_year);return e+"/"+t%100},getMMYYYY:function(){var e=this.getMM(),t=parseInt(this.expiry_year);return e+"/"+t},jsonWithAddress:function(e){var t=this.toJSON();return e&&t.address_id&&t.address_id in e?t.address=e[t.address_id]:t.address=t.address_id=null,t.cardType="real_card",t.type||(t.type=o(t.number)||""),t.brand&&""!=t.brand||(t.type.match(/visa/)?t.brand="visa_generic":t.type.match(/master/)?t.brand="master_generic":t.type.match(/discover/)?t.brand="discover_generic":t.type.match(/diner/)?t.brand="diners_generic":t.type.match(/amex|american/)?t.brand="amex_generic":t.brand="generic"),t.styles=l(t.type,t.brand),t}}),f.enableCaching(),e.extend(f,n.DefaultActions,{routes:{"read/realCard/all":"indexWithAddress","search/realCard/:q":"search","read/realCard/site/:id":"indexWithAddressAndOffers","read/realCard/offers/:id":"indexOffers"},search:function(e,t){var n=new RegExp(atob(e.params[0]),"i");r.RealCard.listCached(function(e){return e.number&&e.number.match(n)||e.label&&e.label.match(n)||e.first_name&&e.first_name.match(n)||e.last_name&&e.last_name.match(n)||e.type&&e.type.match(n)},function(n){t?t.call(this,n):e.returnEntities&&e.returnEntities(n)})},detectCardType:function(e){return o(e)},detectCardBrand:function(e,t){c(e,t)},getCardStyles:function(e,t){return l(e,t)},indexWithAddressAndOffers:function(t,n){ABINE_DNTME.require(["modules"],function(){r.RealCard.indexWithAddress(null,function(i){var a=e.map(i,function(e){return e.brand});r.RealCard.getOfferCards(t,function(e){e.forEach(function(e){a.indexOf(e.brand)==-1&&i.unshift(e)}),n?n.call(this,i):t.returnJSON(i)})})})},indexOffers:function(t,n){ABINE_DNTME.require(["modules"],function(){r.RealCard.index(null,function(i){var a=e.map(i,function(e){return e.brand}),i=[];r.RealCard.getOfferCards(t,function(e){e.forEach(function(e){a.indexOf(e.brand)==-1&&i.unshift(e)}),n?n.call(this,i):t.returnJSON(i)})})})},indexWithAddress:function(t,n){r.Address.index(null,function(i){var a={};e.each(i,function(e){a[e.id]=e.toJSON()}),r.RealCard.index(null,function(r){var i=[];e.each(r,function(e){i.push(e.jsonWithAddress(a))}),n?n.call(this,i):t.returnJSON(i)})})},updateCardRules:function(){var e="https://rules.abine.com/card-rules.json?from=extension";a.ajax({url:e,success:function(e){e&&e.version>d.version&&(s.setItem("card-rules",JSON.stringify(e)),u())}})},getOfferCards:function(t,n){var r=t.params[0],i=d.offers,a=e.filter(i,function(e){return r.match(e.domain)}),s=[];e.each(a,function(t){t=e.extend({},t),t.domain=t.domain_str,delete t.domain_str,s.push(t)}),n?n.call(this,s):t.returnJSON(s)}}),f.useEncryption(["label","first_name","last_name","number","expiry_month","expiry_year","cvc","type"]),f.useSyncStorage(),r.RealCard=f,f}),ABINE_DNTME.define("abine/storage/registry",["abine/timer","abine/storageRouter","storage"],function(e,t,n){return{registerStorageEntities:function(e){e.registerEntity(n.Blacklist,"blacklist"),e.registerEntity(n.DisposableCard,"disposableCard"),e.registerEntity(n.DisposableEmail,"disposableEmail"),e.registerEntity(n.DisposablePhone,"disposablePhone"),e.registerEntity(n.LoginUrl,"loginUrl"),e.registerEntity(n.AutofillFeedback,"autofillFeedback"),e.registerEntity(n.MappedForm,"mappedForm"),e.registerEntity(n.MappedField,"mappedField"),e.registerEntity(n.PanelActivity,"panelActivity"),e.registerEntity(n.Preference,"preference"),e.registerEntity(n.ShieldedCard,"shieldedCard"),e.registerEntity(n.ShieldedEmail,"shieldedEmail"),e.registerEntity(n.ShieldedPhone,"shieldedPhone"),e.registerEntity(n.EmailDomain,"emailDomain"),e.registerEntity(n.TabData,"tabData"),e.registerEntity(n.Address,"address"),e.registerEntity(n.Account,"account"),e.registerEntity(n.Identity,"identity"),e.registerEntity(n.RealCard,"realCard"),e.registerEntity(n.Note,"note"),e.registerEntity(n.PageTracker,"pageTracker"),e.registerEntity(n.PageData,"pageData"),e.registerEntity(n.CustomTabData,"customTabData"),e.registerEntity(n.BlacklistOrPreference,"blacklistOrPreference"),e.registerEntity(n.GlobalData,"globalData"),e.registerEntity(n.GlobalTracker,"globalTracker"),e.registerEntity(n.GlobalPreference,"globalPreference"),e.registerEntity(n.GlobalFeature,"globalFeature"),e.registerEntity(n.DntStats,"dntStats"),e.registerEntity(n.TrackerInfo,"trackerInfo"),e.registerEntity(n.Advt,"advt"),e.registerEntity(n.ExtensionVersion,"extensionVersion")},emptyDatabase:function(r,i){t.StorageRouter.initializeWebSQLStorage({dbName:"idme_test",dbDescription:"Storage for the unit tests",dbSizeInBytes:5242880,ready:function(){var t=15;n.Account.all().destroyAll(function(){t--}),n.Address.all().destroyAll(function(){t--}),n.Blacklist.all().destroyAll(function(){t--}),n.RealCard.all().destroyAll(function(){t--}),n.Identity.all().destroyAll(function(){t--}),n.Note.all().destroyAll(function(){t--}),n.DisposableCard.all().destroyAll(function(){t--}),n.DisposableEmail.all().destroyAll(function(){t--}),n.DisposablePhone.all().destroyAll(function(){t--}),n.Preference.all().destroyAll(function(){t--}),n.MappedForm.all().destroyAll(function(){t--}),n.MappedField.all().destroyAll(function(){t--}),n.ShieldedCard.all().destroyAll(function(){t--}),n.ShieldedEmail.all().destroyAll(function(){t--}),n.ShieldedPhone.all().destroyAll(function(){t--});var r=function(){t>0?e.setTimeout(r,50):i.call()};e.setTimeout(r,50)}})}}}),ABINE_DNTME.define("abine/storage/shieldedCard",["documentcloud/underscore","persistence","abine/storageMixins","storage","abine/eventLogger","persistence/caching","abine/config","abine/licenseServer"],function(e,t,n,r,i,a,s,o,c){var l=t.define("ShieldedCards",{last_four:"TEXT",first_name:"TEXT",last_name:"TEXT",month:"TEXT",year:"TEXT",card_type:"TEXT",address1:"TEXT",address2:"TEXT",city:"TEXT",state_abbreviation:"TEXT",zip:"TEXT",createdAt:"DATE",modifiedAt:"DATE",pushVersion:"INTEGER"});return l.enableCaching(),e.extend(l.prototype,{}),e.extend(l,n.DefaultActions,{routes:{"read/shieldedCard/all":"index","read/shieldedCard/:id":"show","create/shieldedCard":"createFromServer","update/shieldedCard/:id":"update","delete/shieldedCard/:id":"destroy"},createFromServer:function(e,t){r.Preference.findBy("key","authToken",function(n){!n||n.isEmpty(),this.licenseServer=this.licenseServer||new c,this.licenseServer.billingInfo({},function(n,r){n?ABINE_DNTME.log.error("[ERROR HANDLER]#[abine/storage/shieldedCard]#[createFromServer]# error event in shieldedCard.createFromServer call to license server"):(e.payload.first_name=r.first_name,e.payload.last_name=r.last_name,e.payload.month=r.month,e.payload.year=r.year,e.payload.card_type=r.card_type,e.payload.zip=r.zip,e.payload.last_four=r.last_four,e.payload.address1=r.address1,e.payload.address2=r.address2,e.payload.city=r.city,e.payload.state_abbreviation=r.state,l.create(e,t))})})}}),r.ShieldedCard=l,l}),ABINE_DNTME.define("abine/storage/shieldedEmail",["documentcloud/underscore","persistence","abine/storageMixins","abine/config","abine/emailServer","storage","persistence/caching"],function(e,t,n,r,i,a){var s=t.define("ShieldedEmails",{guid:"TEXT",userId:"INT",email:"TEXT",first_name:"TEXT",last_name:"TEXT",active:"BOOL",createdAt:"DATE",modifiedAt:"DATE",pushVersion:"INTEGER"});return s.enableCaching("email"),e.extend(s,n.DefaultActions,{routes:{"read/shieldedEmail/all":"indexWithAltEmail","read/shieldedEmail/:id":"show","delete/shieldedEmail/:id":"destroy"},indexWithAltEmail:function(t,n){a.Preference.batchFindBy([{by:"key",value:"altEmail1"},{by:"key",value:"altEmail2"}],function(r){a.Identity.index(null,function(i){s.index(t,function(a){var o=a&&a.length>0?a[0]:null;if(o){o=o.toJSON(),o.altEmails=[];var c={};c[o.email]=!0,r.altEmail1&&r.altEmail1.value&&(o.altEmails.push({email:r.altEmail1.value,id:o.id+":"+o.altEmails.length}),c[r.altEmail1.value.toLowerCase()]=1),r.altEmail2&&r.altEmail2.value&&(o.altEmails.push({email:r.altEmail2.value,id:o.id+":"+o.altEmails.length}),c[r.altEmail2.value.toLowerCase()]=1),e.each(i,function(e){e.email&&e.email.indexOf("@")!=-1&&(c[e.email.toLowerCase()]||(o.altEmails.push({email:e.email,id:o.id+":"+o.altEmails.length}),c[e.email.toLowerCase()]=1))}),s.respondWithJSON([o],t,n)}else s.respondWithEntities(o,t,n)})})})}}),a.ShieldedEmail=s,s}),ABINE_DNTME.define("abine/storage/shieldedPhone",["documentcloud/underscore","persistence","abine/storageMixins","storage","persistence/caching","abine/phoneServer","abine/config"],function(e,t,n,r){var i=t.define("ShieldedPhones",{country_code:"TEXT",number:"TEXT",is_validated:"TEXT",rails_id:"INTEGER",auth_token:"TEXT",createdAt:"DATE",modifiedAt:"DATE",pushVersion:"INTEGER"});return i.enableCaching(),e.extend(i.prototype,{refresh:function(e){e()},getPrettyNumber:function(){var e="("+this.getAreaCode()+") "+this.getExchange()+"-"+this.getLocal();return e},getAreaCode:function(){return this.number.substr(0,3)},getExchange:function(){return this.number.substr(3,3)},getLocal:function(){return this.number.substr(6,4)},isValidated:function(){return"true"==this.is_validated}}),e.extend(i,n.DefaultActions,{routes:{"read/shieldedPhone/all":"indexWithRefresh","read/shieldedPhone/:id":"showWithRefresh"},showWithRefresh:function(e,t){i.load(e.params[0],function(n){n.refresh(function(){i.show(e,t)})})},indexWithRefresh:function(t,n){var a=Math.floor(1e5*Math.random())+":";i.index(null,function(s){e.async.forEach(s,function(e,t){e.refresh(t)},function(s){s&&ABINE_DNTME.log.error("[ERROR CALLBACK]#[abine/storage/shieldedPhone]#[indexWithRefresh]# error event in ShieldedPhone.index async forEach"),r.Identity.index(null,function(r){i.index(t,function(s){var o={},c=[];if(s.length>0){var l=s[0].toJSON();o[l.number.toString()]=1,c.push(l)}else c.push({});e.each(r,function(e){if(e.phone&&e.phone.indexOf("+")!=-1){var t=e.phone.replace("+","").split(" "),n=t[0],r=t[1];o[r]||(c.push({country_code:n,number:r,identity:!0,id:a+c.length}),o[r]=1)}}),i.respondWithJSON(c,t,n)})})})})}}),r.ShieldedPhone=i,i}),ABINE_DNTME.define("abine/storage/tabData",["documentcloud/underscore","persistence","abine/storageMixins","storage","abine/ajax"],function(e,t,n,r,i){function a(e){e=e||new Date;var t=new Date(e.getFullYear(),0,0);return Math.floor((e-t)/864e5)}function s(e,t,n){try{ABINE_DNTME.require(["modules"],function(r){r.mappingsModule.sendTrackerAllow(e,t,n,ABINE_DNTME.dnt_api.getRulesVersion())})}catch(e){}}var o=864e5,c=function(){};e.extend(c,n.DefaultActions,{routes:{"create/pageTracker":"toggleTracker"},toggleTracker:function(e){var t=e.sender,n=ABINE_DNTME.dnt_api.getTabData(t);e.payload.blocked?ABINE_DNTME.dnt_api.block(e.payload.name,n.host):(ABINE_DNTME.dnt_api.allow(e.payload.name,n.host),s(n.host,n.url,e.payload.name))}});var l=function(){};e.extend(l,n.DefaultActions,{routes:{"create/customTabData":"setCustomData"},setCustomData:function(e){ABINE_DNTME.dnt_api.setCustomTabData(e.sender,e.payload.name,e.payload.value)}});var u=function(){};e.extend(u,n.DefaultActions,{routes:{"update/blacklistOrPreference/:id":"save"},save:function(e,t){var n=e.payload.type;if("blacklist"==n){var i={payload:{domain:e.payload.domain,changed:e.payload.name,suppressWebapp:e.payload.suppressWebapp},params:[e.payload.id],sender:e.sender};if(i.payload[e.payload.name]=e.payload.value,"tracker"==e.payload.name&&e.payload.value){var a=ABINE_DNTME.dnt_api.getTabData(e.sender);s(e.payload.domain,a.url,"*")}r.Blacklist.updateOrCreate(i,t)}else r.GlobalPreference.togglePreference(e,t)}});var d=function(){};return e.extend(d,n.DefaultActions,{routes:{"read/tabData/:id":"getTabData","create/tabData":"reportIssue","update/tabData/autofill":"makeDefault"},disableService:function(e){try{chrome.privacy.services[e].get({},function(t){"controllable_by_this_extension"==t.levelOfControl&&chrome.privacy.services[e].set({value:!1},function(){void 0===chrome.runtime.lastError?console.log("chrome "+e+" disabled"):console.log("chrome "+e+" disable failed",chrome.runtime.lastError)})})}catch(t){console.log("exception while disabling "+e,t)}},makeDefault:function(){var e=this;chrome.permissions.request({permissions:["privacy"]},function(t){t?(e.disableService("autofillEnabled"),e.disableService("passwordSavingEnabled"),e.disableService("autofillAddressEnabled"),e.disableService("autofillCreditCardEnabled")):console.log("permission denied")})},reportIssue:function(e){var t=ABINE_DNTME.dnt_api.getTabData(e.sender);r.Preference.batchFindBy([{by:"key",value:"installVersion"}],function(n){var r="";if(t){for(var r=[],a=0;a<t.trackers.length;a++)r.push(t.trackers[a].name);r=r.join(",")}var s={};s.reason="dntme-feedback",s.version=ABINE_DNTME.config.version,s.origin=ABINE_DNTME.config.tags[0],s.revision=ABINE_DNTME.config.buildNum,s.oversion=n.installVersion?n.installVersion.value:"",s.url=t?encodeURIComponent(t.url):"",s.description=encodeURIComponent(e.payload.feedback),s.rulesversion=encodeURIComponent(ABINE_DNTME.dnt_api.getRulesVersion()),s.trackers=r,s.domain=encodeURIComponent(t?t.host:""),s.log="",i.ajax({url:"http://www.abine.com/checkin/dntmefeedback.php",data:"data="+JSON.stringify(s)})})},getWeeklyReportData:function(e,t,n,r){var i=(e.getTime()-t.getTime())/o,s=7,c=t.getDay();c>1&&(s+=7-t.getDay());var l=e.getDay();if(i>=s&&l>0&&l<=3){var u=null;n&&(u=parseInt(n));var d=new Date(e.getTime()-l*o);d.setHours(0,0,0,0);for(var h=!1,f=r.dailyTrackerCounts?JSON.parse(r.dailyTrackerCounts):{},p=0;p<7;p++){var m=new Date(d.getFullYear(),d.getMonth(),d.getDate()-p),g=a(m),y=m.getFullYear();if(y in f&&f[y][g]>0){h=!0;break}}if(h&&(!u||u<d.getTime()))return["January","February","March","April","May","June","July","August","September","October","November","December"][d.getMonth()]+" "+d.getDate();
}return null},getBrowserAutoFillStatus:function(e){try{chrome.privacy.services.autofillEnabled.get({},function(t){"controllable_by_this_extension"===t.levelOfControl?e(!1,!0):e(!0,!0)})}catch(t){"Chrome"==ABINE_DNTME.config.browser||"Opera"==ABINE_DNTME.config.browser?e(!1,!0):e(!1,!1)}},getTabData:function(t,n){var i=ABINE_DNTME.dnt_api.getTabData(t.sender);if(i||ABINE_DNTME.require(["abine/dnt/tabData"],function(e){e.get(t.sender),i=ABINE_DNTME.dnt_api.getTabData(t.sender)},null,!0),t.params&&t.params.length>0&&"trackers"==t.params[0])return void d.respondWithJSON(i,t,n);var a=this;this.getBrowserAutoFillStatus(function(s,o){r.Preference.batchFindBy([{by:"key",value:"authToken"},{by:"key",value:"installDate"},{by:"key",value:"blockTrackers"},{by:"key",value:"helpMeLogin"},{by:"key",value:"submitAccount"},{by:"key",value:"suggestProtectedEmail"},{by:"key",value:"suggestProtectedPhone"},{by:"key",value:"suggestProtectedCard"},{by:"key",value:"suggestRealCard"},{by:"key",value:"suggestAddresses"},{by:"key",value:"suggestIdentities"},{by:"key",value:"hasEnabledPayments"},{by:"key",value:"entitledToPayments"},{by:"key",value:"entitledToPhone"},{by:"key",value:"entitledToAccounts"},{by:"key",value:"entitledToSync"},{by:"key",value:"rememberAccounts"},{by:"key",value:"rememberCards"},{by:"key",value:"sync_store_manager"},{by:"key",value:"understanding_tracker_clicked"},{by:"key",value:"has_mobile"},{by:"key",value:"showMedals"},{by:"key",value:"oldEmail"},{by:"key",value:"loginNotLock"},{by:"key",value:"suggestStrongPassword"},{by:"key",value:"showTrackersOnload"},{by:"key",value:"showWeeklyReports"},{by:"key",value:"weeklyReportClickedOn"},{by:"key",value:"autoPremiumRegisterShown"},{by:"key",value:"showCheckoutPanelGrowl"}],function(c){r.ShieldedPhone.index(null,function(l){r.DisposableEmail.index(null,function(u){r.Blacklist.findBy("domain",i.host,function(h){ABINE_DNTME.dnt_api.forceSaveStats(),r.DntStats.index(null,function(f){i.dntStats=f.length>0?f[0].toJSON():{},i.dntStats.showMedals=!c.showMedals||"true"==c.showMedals.value,i.loggedIn=c.authToken&&c.authToken.value&&""!=c.authToken.value,!i.loggedIn&&c.oldEmail&&c.oldEmail.value&&""!=c.oldEmail.value&&(i.email=c.oldEmail.value),i.loginNotLock=c.loginNotLock&&c.loginNotLock.isTrue(),i.loginNotRegister=i.loginNotLock||i.email,i.unlockScreen=i.email,i.showTrackersOnload=c.showTrackersOnload&&c.showTrackersOnload.isTrue(),i.hasMobileApp=i.loggedIn&&c.has_mobile&&c.has_mobile.isTrue(),i.dropboxEnabled=i.loggedIn&&!!c.sync_store_manager&&("dropbox"==c.sync_store_manager.value||"blur"==c.sync_store_manager.value),i.entitledToSync=c.entitledToSync&&c.entitledToSync.isTrue(),r.Blacklist.index(null,function(t){t.sort(function(e,t){return e.domain<t.domain?-1:e.domain>t.domain?1:0}),t=e.map(t,function(e){return e._data});for(var n in t){var a=t[n].domain;r.Blacklist.findBy("domain",a,function(e){t[n].id=e.id})}i.blacklistCollection=t}),h||(h=new r.Blacklist({domain:i.host,tracker:i.disabled})),i.blacklist=h.toJSON(),i.blacklist.loggedIn=i.loggedIn,i.blacklist.globalTracker=ABINE_DNTME.dnt_api.getDefaultBlocking(),i.blacklist.globalPhone=c.suggestProtectedPhone&&c.suggestProtectedPhone.isTrue(),i.blacklist.globalCard=c.suggestProtectedCard&&c.suggestProtectedCard.isTrue(),i.blacklist.globalEmail=c.suggestProtectedEmail&&c.suggestProtectedEmail.isTrue(),i.blacklist.globalPassword=c.suggestStrongPassword&&c.suggestStrongPassword.isTrue(),i.blacklist.globalLogin=c.helpMeLogin&&c.helpMeLogin.isTrue(),i.blacklist.globalRealCard=c.suggestRealCard&&c.suggestRealCard.isTrue(),i.blacklist.globalAddress=c.suggestAddresses&&c.suggestAddresses.isTrue(),i.blacklist.globalAccounts=c.rememberAccounts&&c.rememberAccounts.isTrue(),i.blacklist.globalIdentity=c.suggestIdentities&&c.suggestIdentities.isTrue(),i.blacklist.globalSaveCard=c.rememberCards&&c.rememberCards.isTrue(),i.blacklist.globalSubmitAccount=c.submitAccount&&c.submitAccount.isTrue(),i.blacklist.trackerOff=i.blacklist.tracker||!i.blacklist.globalTracker,i.blacklist.phoneOff=i.blacklist.phone||!i.blacklist.globalPhone,i.blacklist.cardOff=i.blacklist.card||!i.blacklist.globalCard,i.blacklist.emailOff=i.blacklist.email||!i.blacklist.globalEmail,i.blacklist.addressOff=i.blacklist.address||!i.blacklist.globalAddress,i.blacklist.accountOff=i.blacklist.save_account||!i.blacklist.globalAccounts,i.blacklist.realCardOff=i.blacklist.real_card||!i.blacklist.globalRealCard,i.blacklist.loginOff=i.blacklist.account||!i.blacklist.globalLogin,i.blacklist.passwordOff=i.blacklist.password||!i.blacklist.globalPassword,i.blacklist.identityOff=i.blacklist.identity||!i.blacklist.globalIdentity,i.blacklist.saveCardOff=i.blacklist.save_card||!i.blacklist.globalSaveCard,i.blacklist.submitAccountOff=i.blacklist.submit_account||!i.blacklist.globalSubmitAccount,i.blacklist.hasEnabledPhone=c.entitledToPhone&&c.entitledToPhone.isTrue()&&l.length>0&&l[0].isValidated(),i.blacklist.hasEnabledCard=c.autoPremiumRegisterShown&&c.autoPremiumRegisterShown.isTrue()||c.hasEnabledPayments&&c.hasEnabledPayments.isTrue(),i.blacklist.hasEnabledAccounts=c.entitledToAccounts&&c.entitledToAccounts.isTrue(),i.blacklist.has_masked_emails=u.length>1,i.blacklist.has_masked_phones=l.length>0,i.blacklist.premium=i.premium,i.understanding_tracker_clicked=c.understanding_tracker_clicked&&c.understanding_tracker_clicked.isTrue(),i.premium=c.authToken&&""!=c.authToken.value&&c.entitledToPhone&&c.entitledToPhone.isTrue(),i.cardMoney=c.authToken&&""!=c.authToken.value&&c.entitledToPayments&&c.entitledToPayments.isTrue()&&!i.premium,i.showFreeCard=!(i.premium||i.cardMoney),i.dntStats.premium=i.premium,i.dntStats.maskmeInstalled=i.blacklist.maskmeInstalled=i.maskmeInstalled=!!ABINE_DNTME.maskme_installed;var p=new Date;p.setHours(0,0,0,0);var m=new Date(c.installDate?c.installDate.value:p.getTime());if(m.setHours(0,0,0,0),i.installMonth=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][m.getMonth()]+" '"+m.getFullYear().toString().substr(2),i.weeklyReport=null,!ABINE_DNTME.maskme_installed&&(!c.showWeeklyReports||c.showWeeklyReports.isTrue())){var g=null;c.weeklyReportClickedOn&&(g=c.weeklyReportClickedOn.value),i.weeklyReport=a.getWeeklyReportData(p,m,g,i.dntStats)}i.blurDefaultAutofill=s,i.canChangeAutofill=o,d.respondWithJSON(i,t,n)})})})})})})}}),r.TabData=d,r.PageTracker=c,r.CustomTabData=l,r.BlacklistOrPreference=u,d}),ABINE_DNTME.define("abine/storage/trackerData",["documentcloud/underscore","persistence","abine/storageMixins","storage","abine/localStorage"],function(e,t,n,r,i){var a=t.define("TrackerData",{domain:"TEXT"});return e.extend(a,n.DefaultActions,{routes:{},createLocal:function(t,n){r.Preference.findBy("key","shouldSendErrorReports",e.bind(function(e){if(!e||e.isTrue()){var n=i.getItem("trackerData-to-push");if(n)try{n=JSON.parse(n)}catch(e){n={}}else n={};var r=t.payload.d+":"+t.payload.h;n[r]=t.payload.t,i.setItem("trackerData-to-push",JSON.stringify(n))}else i.removeItem("trackerData-to-push")},this)),n&&n({})}}),r.TrackerData=a,a}),ABINE_DNTME.define("abine/storage/trackerInfo",["documentcloud/underscore","persistence","abine/storageMixins","storage","abine/ajax"],function(e,t,n,r,i){var a={},s="/api/v1/lookup",o=t.define("TrackerInfo",{domain:"TEXT",trackers:"TEXT",color:"TEXT",info:"TEXT"});return e.extend(o,n.DefaultActions,{routes:{"read/trackerInfo/index":"getTrackersForDomains"},getTrackersForDomains:function(e,t){function n(){o.respondWithJSON(c,e,t)}var r=e.payload.domains,c=[],l=[];for(var u in r)a[u]?c.push(a[u]):l.push(u);if(l.length>0){var d="https://"+ABINE_DNTME.config.trackerHost+s;i.ajax({url:d,type:"POST",data:{urls:l},success:function(e){for(var t in e)if(e[t].trackers){if("No data"==e[t].trackers)a[t]={domain:t};else{var r,i=e[t].trackers.length;r=i<=1?"green":i>1&&i<=5?"yellow":"red",a[t]={domain:t,trackers:e[t].trackers.join(":"),color:r,info:e[t].info}}c.push(a[t])}n()},error:function(){n()}})}else n()}}),r.TrackerInfo=o,o}),ABINE_DNTME.define("storage",["persistence","documentcloud/underscore"],function(e,t){var n={dumpToJSON:function(){var t=[];for(var r in n)"meta"in n[r]&&t.push(n[r]);e.dump(t,function(e){JSON.stringify(e)})},purgeDatabase:function(r){e.clean();var i=[];for(var a in n)"meta"in n[a]&&i.push(n[a]);t.async.forEach(i,function(t,n){e.transaction(function(e){e.executeSql("delete from "+t.meta.name,null,function(){n()})})},function(){r()})},clearAllCache:function(r,i){ABINE_DNTME.require(["abine/blurstore-api"],function(a){n.ShieldedPhone.clearCache(function(){n.DisposablePhone.clearCache(function(){n.Account.clearCache(function(){n.Address.clearCache(function(){n.Note.clearCache(function(){n.RealCard.clearCache(function(){n.AccountHistory.clearCache(function(){"blur"!=r&&a.disconnect(),n.Account.index(null,function(s){n.Address.index(null,function(o){n.Note.index(null,function(c){n.RealCard.index(null,function(l){n.AccountHistory.index(null,function(u){"blur"==r?a.connectAndLoad():(t.each(s,function(e){e.pushed=0}),t.each(u,function(e){e.pushed=0}),t.each(o,function(e){e.pushed=0}),t.each(c,function(e){e.pushed=0}),t.each(l,function(e){e.pushed=0}),e.flush()),n.EmailDomain.clearCache(function(){n.CompanyAccount.clearCache(function(){i()})})})})})})})})})})})})})})})}};return n}),ABINE_DNTME.define("abine/modules/license",["documentcloud/underscore","abine/core","abine/timer","storage","persistence","abine/ajax","abine/config","abine/securityManager","abine/licenseServer","abine/responseCodes","modules","abine/crypto","abine/ajax","abine/webapp","abine/memoryStore"],function(e,t,n,r,i,a,s,o,c,l,u,d,a,h,f){var p=function(){},m=function(){var e=new Date;return e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e},g=t.BaseClass.extend({initialize:function(e){this.options=e,this.licenseServer=this.options.licenseServer||new c},setMessenger:function(e){this.messenger=e},startDailyTouch:function(t){t=t||p,r.Preference.findBy("key","lastTouch",e.bind(function(e){if(e&&e.value){var n=new Date(parseInt(e.value));n.valueOf()<m().valueOf()?this.makeDailyActiveTouch(!1,t):this.delayDailyActiveTouch(t)}else this.makeDailyActiveTouch(!0,function(){t()})},this))},makeDailyActiveTouch:function(t,n){if(n=n||p,ABINE_DNTME.maskme_installed)return void n();var i={};i.install=!!t,r.Preference.batchFindBy([{by:"key",value:"authToken"},{by:"key",value:"installAuthToken"}],e.bind(function(t){var a=t.authToken,s=t.installAuthToken;a&&!a.isEmpty()&&(i.auth_token=a.value),s&&!s.isEmpty()&&(i.install_auth_token=s.value),this.licenseServer.makeDailyTouch(i,e.bind(function(t,i){t?this.delayDailyActiveTouch(function(){n(t)}):this.writeDailyTouchPref(e.bind(function(){this.delayDailyActiveTouch(function(){if(i.install_auth_token){if(i.splits&&i.splits.length>0){var t=e.reduce(i.splits,function(e,t){return e[t.test_name]=t.bucket_id,e},{});try{r.Preference.createOrModify({key:"splitTests",value:JSON.stringify(t)})}catch(e){}}if(i.config_overrides&&i.config_overrides.length>0){var a=e.reduce(i.config_overrides,function(e,t){return e[t.config_name]=t.config_value,e},{});try{r.Preference.createOrModify({key:"configOverrides",value:JSON.stringify(a)})}catch(e){}}if(i.other_data)try{r.Preference.createOrModify({key:"isBlurUpgrade",value:i.other_data.is_blur_upgrade})}catch(e){}r.Preference.createOrModify({key:"installAuthToken",value:i.install_auth_token},n)}else n()})},this))},this))},this))},removeDailyTouchPref:function(e){r.Preference.findBy("key","lastTouch",function(t){t?(i.remove(t),i.flush(e)):e()})},delayDailyActiveTouch:function(t){t=t||p;var r=18e5+36e5*Math.random();this.dailyActiveTimeout&&n.clearTimeout(this.dailyActiveTimeout),this.dailyActiveTimeout=n.setTimeout(e.bind(this.startDailyTouch,this),r),t()},writeDailyTouchPref:function(e){e=e||p,r.Preference.findOrCreate({key:"lastTouch"},function(t){t.value=Math.floor(m().valueOf()),t.modifiedAt=m(),i.flush(function(){e()})})},sendFeedbackEmail:function(t,n){n=n||p,t.browserUserAgent="Extension "+ABINE_DNTME.config.browser+" "+ABINE_DNTME.config.version,this.licenseServer.sendFeedbackEmail(t,e.bind(function(e,t){e?n(e):n(null,t)},this))},logAction:function(t,n){n=n||p,r.Preference.findBy("key","sendToolbarClick",e.bind(function(i){i||r.Preference.createOrModify({key:"sendToolbarClick",value:"true"},e.bind(function(){this.licenseServer.logAction(t,e.bind(function(e,t){e?n(e):n(null,t)},this))},this))},this))},logSplitData:function(t,n){n=n||p,this.licenseServer.logSplitData(t,e.bind(function(e,t){e?n(e):n(null,t)},this))},logPasswordFillData:function(t,n){n=n||p,this.licenseServer.logPasswordFillData(t,e.bind(function(e,t){e?n(e):n(null,t)},this))},logout:function(t,n){n=n||p,this.licenseServer.logout({auth_token:t},e.bind(function(e,t){n(e,t)},this))},login:function(t,n){n=n||p;var r=t.password;t.password=d.getServerPassword(r);var i=d.generateKey();t.key=d.encryptKey(r,i),t.verify_key=d.encryptKey(i,i),this.licenseServer.login({application:"manageme",user_login:t,mfa_code:t.mfa_code},e.bind(function(e,i){e?(t.password=r,n(e,i)):this._afterLoginOrRegister(i,r,function(){n(null,i)})},this))},_afterLoginOrRegister:function(t,a,s){var c=d.decryptKey(a,t.user.key,null,!0);c==t.user.key&&(c=null);var l=null;t.user.companyKey&&(l=d.decryptKey(a,t.user.companyKey,null,!0),l==t.user.companyKey&&(l=null)),r.Preference.batchCreateOrModify([{key:"authToken",value:t.auth_token},{key:"key",value:c},{key:"ckey",value:l},{key:"installAuthToken",value:t.install_auth_token},{key:"hasRegistered",value:"true"},{key:"passwordHint",value:t.password_hint}],e.bind(function(){o.setAuthToken(t.auth_token,c,l,e.bind(function(){i.flush(e.bind(function(){n.setTimeout(function(){u.mappingsModule.refreshPanels()},2e4),this.messenger.broadcastToAllTabs("broadcast:preference:reload",{}),this.messenger.broadcastToAllTabs("broadcast:register:success",{}),h.reload(),s()},this))},this))},this))},register:function(t,n){n=n||p;var a=t.password,o=t.register_type,c=!("send_password_email"in t)||t.send_password_email;if(!t.generated_password){var l=d.generateKey();t.key=d.encryptKey(a,l),t.verify_key=d.encryptKey(l,l)}delete t.generated_password,t.password=d.getServerPassword(a),t.password_confirmation=t.password,t.tag=s.tags[0],delete t.register_type,delete t.send_password_email;var u=t;r.Preference.createOrModify({key:"registerInProgress",value:"true"},e.bind(function(r){this.licenseServer.register({user:u,application:"manageme",send_password_email:c,register_type:o},e.bind(function(s,o){s?(t.password=a,t.password_confirmation=a,i.remove(r),i.flush(e.bind(function(){this.messenger.broadcastToAllTabs("broadcast:register:failed",{err:s,serverData:o}),n(s,o)},this))):(i.remove(r),this._afterLoginOrRegister(o,a,function(){n(null,o)}))},this))},this))},passwordCardAuth:function(t,n){n=n||p,t.password=d.getServerPassword(t.password),this.licenseServer.passwordCardAuth(t,e.bind(function(e,t){n(e?{success:!1}:{success:!0,token:t.token})},this))},getGenericBiometricKey:function(t,n){n=n||p,f.get("biometricKeyToken",e.bind(function(t){var r=null;t&&(r={old_token:t}),this.licenseServer.getGenericBiometricKey(r,e.bind(function(e,t){n(e?{success:!1}:{success:!0,key:t.key})},this))},this))},createBiometricAuthRequest:function(t,n){n=n||p,this.licenseServer.createBiometricAuthRequest(t,e.bind(function(e){n(e?{success:!1,error:e.errorCode}:{success:!0})},this))},getBiometricAuthResponse:function(t,n){n=n||p,this.licenseServer.getBiometricAuthResponse(t,e.bind(function(e,t){n(e?{success:!1}:t)},this))},subscribe:function(t,n,r,i){i=i||p,this.licenseServer.signature({},e.bind(function(o,c){function l(t){var n=t.indexOf("{"),a=t.lastIndexOf("}"),s=JSON.parse(t.substr(n,a-n+1));s.success?this.licenseServer.subscribed({recurly_token:s.success.token,source:r},e.bind(function(t){t?i(!0,{errors:{base:["Error activating payments"]}}):this.refreshEntitlements(e.bind(function(){this.refreshLastFourCardDigits({},function(){i(!1,{})})},this))},this)):i(!0,s)}function u(t,n){if(200!=t)return void i(!0,{errors:{base:[n.error.message]}});if(n.id)var a={stripe_token:n.id,source:r,ip_address:n.client_ip,plan_code:m,first_six:p.number.substr(0,6)};else var a={source:r,plan_code:m,use_existing:"true"};this.licenseServer.stripe_subscribe(a,e.bind(function(t){t?i(!0,{errors:{base:["Error activating payments"]}}):this.refreshEntitlements(e.bind(function(){this.refreshLastFourCardDigits({},function(){i(!1,{})})},this))},this))}if(c[n+"_options_signature"]){var d={signature:c[n+"_options_signature"],account:c[n+"_options"].account,billing_info:t,subscription:c[n+"_options"].subscription,currency:c.recurly_config.currency},h=c.recurly_config.subdomain,f="https://"+h+".recurly.com/jsonp/"+h+"/subscribe";a.ajax({dataType:"text",url:f,data:d,success:e.bind(l,this),error:e.bind(l,this)})}else{var p={name:(t.first_name+" "+t.last_name).replace(/^[\s]+|[\s]+$]/,"").replace(/[\s]+]/," "),number:t.number,exp_month:t.month,exp_year:t.year,cvc:t.verification_value,address_line1:t.address1,address_line2:t.address2,address_city:t.city,address_state:t.state,address_zip:t.zip,address_country:t.country},m=c[n+"_options"].subscription.plan_code;p.number?(Stripe.setPublishableKey(s.stripe_key),Stripe.createToken(p,e.bind(u,this))):u.apply(this,[200,{}])}},this))},refreshEntitlements:function(t){t=t||p,this.licenseServer.refreshEntitlements({},e.bind(function(n,r){n?t(n,r):this.updateEntitlementPrefs(r.user.licenses,e.bind(function(){this.updateHasEnabledPaymentsPref(r.user.activated_cards_at,e.bind(function(){this.updateHasAuthorizedCoinbase(r.user.has_authorized_coinbase,e.bind(function(){i.flush(e.bind(function(){this.messenger.broadcastToAllTabs("broadcast:preference:reload",{}),t(null,r)},this))},this))},this))},this))},this))},updateEntitlementPrefs:function(t,n){n=n||p;var a={entitledToSync:"sync",entitledToPhone:"protected_phone",entitledToPayments:"payments",entitledToAccounts:"accounts"},s={},o={},c=function(e){return e.key in a};r.Preference.listCached(c,e.bind(function(c){e.each(c,function(e){s[a[e.key]]=e});for(var l in a)a[l]in s||(s[a[l]]=new r.Preference({key:l,value:"false"}),i.add(s[a[l]]));var u=s.protected_phone.isTrue(),d=s.payments.isTrue(),h=s.accounts.isTrue();e.each(t,function(e){s[e.feature_code]&&s[e.feature_code].setTrue(),o[e.feature_code]=1}),
// if it wasn't one of the features in the licenses returned, there's no license for it, so mark it false
e.each(e.keys(s),function(e){e in o||s[e].setFalse()}),u&&s.protected_phone.isFalse()&&(r.ShieldedPhone.all().destroyAll(),r.DisposablePhone.all().destroyAll()),r.Preference.createOrModify({key:"hadEmail",value:"true"}),r.Preference.createOrModify({key:"hadPhone",value:s.protected_phone&&s.protected_phone.isTrue()?"true":"false"}),r.Preference.createOrModify({key:"hadCard",value:s.payments&&s.payments.isTrue()?"true":"false"}),s.payments&&s.payments.isTrue()&&this.refreshLastFourCardDigits(),d&&s.payments.setTrue(),!h&&s.accounts&&s.accounts.isTrue()&&r.Preference.batchCreateOrModify([{key:"suggestStrongPassword",value:"true"},{key:"suggestAddresses",value:"true"},{key:"helpMeLogin",value:"true"},{key:"rememberAccounts",value:"true"}]),e.each(c,function(e){i.forceAdd(e)}),i.flush(function(){n()})},this))},refreshLastFourCardDigits:function(t,n){n=n||p,this.licenseServer.billingInfo({},e.bind(function(t,a){t?n(t,a):a.subscription&&!a.subscription.card_not_setup?(r.Preference.findBy("key","cardNotSetup",function(e){e&&i.remove(e)}),r.ShieldedCard.index(null,e.bind(function(t){if(t&&t[0]){var s=t[0];s.last_four=a.last_four,s.first_name=a.first_name,s.last_name=a.last_name,s.month=a.month,s.year=a.year,s.card_type=a.card_type,s.zip=a.zip,i.flush(e.bind(function(){this.messenger.broadcast("broadcast:billinginfo:updated",{}),n(null,a)},this))}else r.ShieldedCard.create({payload:a},e.bind(function(){this.messenger.broadcast("broadcast:billinginfo:updated",{}),n(null,a)},this))},this))):a.subscription&&a.subscription.card_not_setup?r.Preference.createOrModify({key:"cardNotSetup",value:"true"},function(){n(null,a)}):n(null,a)},this))},updateHasEnabledPaymentsPref:function(t,n){n=n||p(),r.Preference.batchFindBy([{by:"key",value:"hasEnabledPayments"},{by:"key",value:"suggestProtectedCard"},{by:"key",value:"autoPremiumRegisterShown"}],e.bind(function(e){var a=e.hasEnabledPayments;a||(a=new r.Preference({key:"hasEnabledPayments",value:"false"}),i.add(a)),a&&a.isTrue()!=Boolean(t)&&(t?(e.autoPremiumRegisterShown&&e.autoPremiumRegisterShown.isTrue()&&(i.remove(e.autoPremiumRegisterShown),e.suggestProtectedCard||(e.suggestProtectedCard=new r.Preference({key:"suggestProtectedCard",value:"true"}),i.add(e.suggestProtectedCard)),e.suggestProtectedCard.setTrue()),a.setTrue()):a.setFalse()),i.flush(function(){n()})},this))},updateHasAuthorizedCoinbase:function(e,t){t=t||p(),r.Preference.createOrModify({key:"hasAuthorizedCoinbase",value:!!e},function(){t()})},retrieveMedalsEarned:function(t){this.licenseServer.retrieveMedalsEarned({},e.bind(function(e,n){e?t(e):t(null,n)}))},pushSync:function(e){this.licenseServer.pushSync({count:e})},incrementMedalsEarned:function(t,n){var r={additional_medals_earned:t};this.licenseServer.incrementMedalsEarned(r,e.bind(function(e,t){e?n(e):n(null,t)},this))},incrementMedalsEarnedWithCurrentMedals:function(t,n){r.DntStats.index(null,e.bind(function(e){var e=e[0],i=e.currentBadgeIndex+1;i>0?(t&&r.Preference.createOrIncrementByInteger({key:"cardsEarned",value:i},function(){}),this.incrementMedalsEarned(i,n)):n()},this))},logCheckout:function(t,n){return o.isLocked()?void(n&&n(!0)):void r.Preference.findBy("key","shouldSendShoppingFeedback",e.bind(function(r){n=n||p,!r||r.isTrue()?(t.amount&&!isNaN(parseFloat(t.amount))&&(t.amount=parseInt(100*parseFloat(t.amount))),t.device_id=o.getAnonymousId(),this.licenseServer.logCheckout(t,e.bind(function(e,t){e?n(e):n(null,t)}))):n(!0)},this))},retrieveSyncstoreToken:function(t){t=t||p,this.licenseServer.retrieveSyncstoreToken({},e.bind(function(e,n){e?t(e):t(null,n)}))}}),y=new g({});return u.licenseModule=y,y}),ABINE_DNTME.define("abine/modules/panels",["documentcloud/underscore","abine/core","abine/timer","storage","persistence","abine/ajax","abine/config","abine/securityManager","abine/mappingServer","abine/responseCodes","modules","abine/licenseServer","abine/webapp"],function(e,t,n,r,i,a,s,o,c,l,u,d,h){function f(e,t,n,r){var i=[];for(var a in e)if("length"!=a){var s=e[a],o=parseFloat(s.show_rate);if(!(Math.random()>o||parseInt(s.masked_emails)>0))if(s.field_type.indexOf("new-feature-added")!=-1){if(r<new Date(s.created_at)&&p(s,t,n)){i.unshift(s);break}}else p(s,t,n)&&(p>1?i.unshift(s):i.push(s))}return i}function p(e,t,n){var r=e.targeting_option;if(!r)return 1;if(r.masking&&("off"==r.masking&&!ABINE_DNTME.maskme_installed||"on"==r.masking&&ABINE_DNTME.maskme_installed))return 0;if(r.blocked&&ABINE_DNTME.dnt_api.getAllTimeTotalTrackers()<parseInt(r.blocked))return 0;if(r.install_age&&parseInt(r.install_age)>(Date.now()-w)/864e5)return 0;if(r.domain){if(t&&t.match(new RegExp(r.domain,"i")))return 10}else{if(!r.trackers)return 1;if(n>=parseInt(r.trackers))return 1}}function m(e,t,n){r.Preference.findBy("key","new_feature_explored",function(i){var a=!1;i&&(a=new Date(i.value));var s=f(k,e.host,e.total,a);if(s.length>0){if(!s[0].image){var o=s[0].panel_positions[0].panel_section,c=o.body.match(/data:[^\'"]+/);c&&(s[0].image=c[0])}r.PanelActivity.addImpression({payload:{panelId:s[0].id}}),E[t]={id:s[0].id,host:e.host}}else E[t]={id:-1,host:e.host};n(E[t])})}function g(t,n){if(k){var i=t.tabId;i in E&&E[i].host!=t.host&&delete E[i],i in E?(i in E&&E[i].id!=-1&&(t.customImage=k[E[i].id].image),n()):m(t,i,function(){i in E&&E[i].id!=-1&&(t.customImage=k[E[i].id].image),n()})}else E={},r.Preference.findBy("key","dynamicPanels",function(r){if(k={length:0},r){var i=JSON.parse(r.value).panels;e.each(i,function(e){e.field_type.indexOf("dntme-toolbar-button")!=-1&&(k[e.id]=e,k.length++)})}k.length>0?g(t,n):n()})}function y(t,n){A?r.Preference.findBy("key","new_feature_explored",function(e){var i=!1;e&&(i=new Date(e.value));var a=f(A,t.host,t.trackers.length,i);a.length>0?(r.PanelActivity.addImpression({payload:{panelId:a[0].id}}),n(a[0])):n(null)}):r.Preference.findBy("key","dynamicPanels",function(r){if(A={length:0},r){var i=JSON.parse(r.value).panels;e.each(i,function(e){e.field_type.indexOf("dntme-panel")!=-1&&(A[e.id]=e,A.length++)})}A.length>0?y(t,n):n(null)})}function b(t,n){if(T){var i=f(T,t.host,t.trackers.length);if(i.length>0&&!(i[0].id in S))return r.PanelActivity.addImpression({payload:{panelId:i[0].id}}),S[i[0].id]=!0,void n(i[0]);n(null)}else r.Preference.findBy("key","dynamicPanels",function(r){if(T={length:0},r){var i=JSON.parse(r.value).panels;e.each(i,function(e){e.field_type.indexOf("dntme-growl")!=-1&&(T[e.id]=e,T.length++)})}T.length>0?b(t,n):n(null)})}function v(t){w?t():r.Preference.findBy("key","installDate",e.bind(function(e){w=e?parseInt(e.value):Date.now(),t()},this))}var _=function(){},w=null,k=null,E={},A=null,T=null,S={},N=t.BaseClass.extend({initialize:function(e){this.mappingServer=e.mappingServer||new c,this.licenseServer=e.licenseServer||new d},getToolbarPanel:function(e,t){v(function(){g(e,function(){t(e)})})},doToolbarPanelAction:function(t){if(k&&t in E&&E[t].id!=-1){var n=k[E[t].id],i=n.panel_positions[0].panel_actions;return i.length>0&&e.each(i,e.bind(function(e){"open_registration_page"==e.name?h.openHome({id:n.id,action:e.name}):"open_page"==e.name?o.openPage(e.extra):"trigger_click"==e.name?r.PanelActivity.addClick({payload:{panelId:n.id}}):"trigger_conversion"==e.name?r.PanelActivity.addConversion({payload:{panelId:n.id}}):"change_show_rate"==e.name?this.changePanelShowRate({panelId:n.id,extra:e.extra}):"no_action"==e.name||("open_plans_page"==e.name?h.openPremium("panelID"+n.id,null,{id:n.id,action:e.name}):"open_snowman_page"==e.name?h.openSnowman(null,{id:n.id,action:e.name}):"open_activate_cards_page"==e.name?h.openCards({id:n.id,action:e.name}):"open_new_premium_feature_added_page"==e.name&&h.openNewFeatureAdded({id:n.id,action:e.name}))},this)),k.length--,delete E[t],ABINE_DNTME.dnt_api.triggerUpdateIcon(t),!0}return!1},getDNTMePanel:function(e,t){var n=ABINE_DNTME.dnt_api.getTabData(e);return n?void v(function(){y(n,function(e){t(e)})}):void t(null)},getDNTMeGrowl:function(e,t){var n=ABINE_DNTME.dnt_api.getTabData(e);return n?void v(function(){b(n,function(e){t(e)})}):void t(null)},changePanelShowRate:function(t,n){n=n||_;var a=t.panelId,s=t.extra;r.Preference.findBy("key","dynamicPanels",e.bind(function(t){var r=JSON.parse(t.value);e.each(r.panels,function(e){e.id==a&&(e.show_rate=s,A&&A[a]&&(A[a].show_rate=s),k&&k[a]&&(k[a].show_rate=s),t.value=JSON.stringify(r))}),i.flush(n)},this))},processPanelData:function(t,n){n=n||_,k=null,A=null,T=null,r.DisposableEmail.index(null,e.bind(function(a){var s=a.length;e.each(t.panels,function(e){s>=e.masked_emails&&(e.masked_emails=0)}),r.Preference.findBy("key","dynamicPanels",e.bind(function(a){if(a){var o;try{o=JSON.parse(a.value).panels}catch(e){}o||(o=[]);var c=[],l={},u={};t=t.panels,t.forEach(function(e){u[e.id]=1}),e.each(o,function(t){t.id in u?(c.push(t),l[t.id]=1,t.field_type.indexOf("dntme")==-1&&(l[t.field_type]=t.id),s>=t.masked_emails&&(t.masked_emails=0)):r.PanelActivity.findBy("panelId",t.id,e.bind(function(e){e&&i.remove(e)},this))}),t.forEach(function(e){if(!l[e.id]){if(e.field_type in l)for(var t=0;t<c.length;t++)c[t].id==l[e.field_type]&&(c.splice(t,1),t--);c.push(e)}}),a.value=JSON.stringify({panels:c})}else a=new r.Preference({key:"dynamicPanels",value:JSON.stringify(t)}),i.add(a),t=t.panels;e.async.forEach(t,e.bind(function(t,n){r.PanelActivity.findBy("panelId",t.id,e.bind(function(e){e||(e=new r.PanelActivity({panelId:t.id,impressions:0,users:1,clicks:0,completions:0}),i.add(e)),n()},this))},this),e.bind(function(){i.flush(e.bind(function(){n()},this))},this))},this))},this))},setupDynamicPanels:function(t,n){n=n||_,this.mappingServer.getPanels({browser:s.browser,tag:s.tags[0],user_state:t?t:"unregistered"},e.bind(function(e,t){e?n():this.processPanelData(t.panels,n)},this))},panelConversionCheck:function(e,t){if(t=t||_,ABINE_DNTME.lastPanel&&ABINE_DNTME.lastPanel[e]){var n=ABINE_DNTME.lastPanel[e];delete ABINE_DNTME.lastPanel[e],r.PanelActivity.findBy("panelId",n,function(e){e&&e.completions++,i.flush(function(){t()})})}else t()},
// sends non-marketing panel activity to license server
sendPanelActivity:function(t){function n(){t&&t(),t=null}r.Preference.batchFindBy([{by:"key",value:"shouldSendErrorReports"},{by:"key",value:"suggestProtectedEmail"},{by:"key",value:"suggestProtectedPhone"},{by:"key",value:"entitledToPhone"},{by:"key",value:"hasEnabledPayments"},{by:"key",value:"suggestProtectedCard"},{by:"key",value:"suggestRealCard"},{by:"key",value:"suggestAddresses"},{by:"key",value:"suggestStrongPassword"},{by:"key",value:"helpMeLogin"},{by:"key",value:"rememberAccounts"}],e.bind(function(t){r.ShieldedPhone.index(null,e.bind(function(a){t.browsing=ABINE_DNTME.dnt_api.getDefaultBlocking(),t.errors=t.shouldSendErrorReports&&t.shouldSendErrorReports.isTrue(),t.email=t.suggestProtectedEmail&&t.suggestProtectedEmail.isTrue(),t.phone=t.suggestProtectedPhone&&t.suggestProtectedPhone.isTrue()&&t.entitledToPhone&&t.entitledToPhone.isTrue()&&a.length>0&&a[0].isValidated(),t.card=t.suggestProtectedCard&&t.suggestProtectedCard.isTrue()&&t.hasEnabledPayments&&t.hasEnabledPayments.isTrue(),t.password=t.suggestStrongPassword&&t.suggestStrongPassword.isTrue(),t.address=t.suggestAddresses&&t.suggestAddresses.isTrue(),t.realcard=t.suggestRealCard&&t.suggestRealCard.isTrue(),t.login=t.helpMeLogin&&t.helpMeLogin.isTrue(),t.account=t.rememberAccounts&&t.rememberAccounts.isTrue(),t.errors?r.Account.index(null,e.bind(function(a){r.Address.index(null,e.bind(function(s){r.RealCard.index(null,e.bind(function(o){r.Identity.index(null,e.bind(function(c){r.Note.index(null,e.bind(function(l){r.AccountHistory.index(null,e.bind(function(u){var d=o.length,h=s.length,f=a.length,p=c.length,m=u.length,g=l.length,y=0;y=a.filter(function(e){return!!(e.email||e.username||"").match(new RegExp("@(opayq.com|dontrack.me|abinemail.com|beconfidential.com|blurmail.net|blurme.net|maskmemail.com|maskedmails.com|maskedmail.net|oo-mail.net|goobers.net|maskmemail.net)$","i"))}).length,r.Blacklist.index(null,e.bind(function(a){var s={account:0,address:0,card:0,domain:0,email:0,password:0,phone:0,real_card:0,save_account:0,tracker:0};e.each(a,function(t){e.each(t._data,function(e,t){e&&(s[t]=s[t]+1)})}),r.PanelActivity.index(null,e.bind(function(r){var a={panel_data:{global_settings:{account:t.account?1:0,address:t.address?1:0,card:t.card?1:0,email:t.email?1:0,password:t.password?1:0,phone:t.phone?1:0,real_card:t.realcard?1:0,login:t.login?1:0,tracker:t.browsing?1:0},site_totals:{account:s.account,address:s.address,card:s.card,domain:s.domain,email:s.email,password:s.password,phone:s.phone,real_card:s.real_card,save_account:s.save_account,tracker:s.tracker},user_counts:{accounts_count:f,masked_email_accounts_count:y,real_cards_count:d,addresses_count:h,identities_count:p,notes_count:g,histories_count:m}}};e.each(r,function(e){!e.isMarketingPanel()&&e.hasData()&&(a.panel_data||(a.panel_data={}),a.panel_data[e.panelId]=e.toJSON())}),a.panel_data?this.licenseServer.sendPanelActivity(a,function(t){t?n():(e.each(r,function(e){e.panelId in a.panel_data&&e.reset(a.panel_data[e.panelId])}),i.flush(function(){n()}))}):n()},this))},this))},this))},this))},this))},this))},this))},this)):n()},this))},this))}}),C=new N({});return u.panelsModule=C,C}),ABINE_DNTME.define("abine/modules/mappings",["documentcloud/underscore","abine/core","abine/timer","storage","persistence","abine/ajax","abine/config","abine/securityManager","abine/mappingServer","modules","abine/localStorage"],function(e,t,n,r,i,a,s,o,c,l,u){var d=function(){},h=864e5,f=function(){var e=new Date;return e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e},p=t.BaseClass.extend({initialize:function(e){this.mappingServer=e.mappingServer||new c},startDailyMappingCheck:function(t){t=t||d,r.Preference.findBy("key","lastMappingCheck",e.bind(function(e){if(e&&e.value){var n=new Date(parseInt(e.value));n.valueOf()<(new Date).getTime()-h?this.makeDailyMappingCheck(t):this.delayDailyMappingCheck(t)}else this.makeDailyMappingCheck(t)},this))},forceMappingUpdate:function(e,t){t||(t=e,e=!1),e||(r.Preference.removeByKey("mapping-version"),r.MappedForm.clearForms()),this.makeDailyMappingCheck(t)},processMapping:function(t,n){Date.now();r.MappedForm.clearForms(),t.login_urls&&r.LoginUrl.saveAll(t.login_urls);var i=[];e.each(t.mappings,function(e){var t={domain:e.domain,signature:e.signature,mapping_signature:e.mapping_signature,formType:e.formType,fields:e.fields};i.push(t)}),r.MappedForm.saveAllForms(i),this.writeDailyMappingCheckPref(e.bind(function(){this.delayDailyMappingCheck(function(){n()})},this))},refreshPanels:function(){r.Preference.batchFindBy([{by:"key",value:"lastUserState"},{by:"key",value:"dynamicPanels"},{by:"key",value:"hasRegistered"},{by:"key",value:"entitledToPhone"}],e.bind(function(e){var t=e.lastUserState?e.lastUserState.value:"",n="unregistered";e.hasRegistered&&e.hasRegistered.isTrue()&&(n=e.entitledToPhone&&e.entitledToPhone.isTrue()?"premium":"registered"),t==n&&e.dynamicPanels||this.makeDailyMappingCheck(!0)},this))},updateFormRules:function(){try{var e="https://rules.abine.com/form-rules-"+ABINE_DNTME.config.environment+".json?from=extension",t=this;a.ajax({url:e,success:function(e){try{e=JSON.parse(e),e&&e.Version&&(u.setItem("form-rules",JSON.stringify(e)),t._cachedFormRules=e)}catch(e){}}})}catch(e){}},setFormRules:function(e){this._cachedFormRules=e},getFormRules:function(e){if(!this._cachedFormRules){var t=u.getItem("form-rules");if(t)try{t=JSON.parse(t),this._cachedFormRules=t}catch(e){}}e(this._cachedFormRules)},makeDailyMappingCheck:function(t,n){return t&&t!==!0&&(n=t,t=!1),n=n||d,ABINE_DNTME.maskme_installed?void n():(r.RealCard.updateCardRules(),this.updateFormRules(),void l.panelsModule.sendPanelActivity(e.bind(function(){var a={get_panels:1,get_login_urls:1,product:"dntme",tag:ABINE_DNTME.config.tags[0],browser:ABINE_DNTME.config.browser};t&&(a.exclude_mapping=!0);var s=e.bind(function(t){r.Preference.findBy("key","shouldSendErrorReports",e.bind(function(t){if(!t||t.isTrue()){r.Preference.findBy("key","mapping:mapper",e.bind(function(t){r.Preference.findBy("key","mapping:batch",e.bind(function(n){var r=u.getItem("mapping-to-push");if(r&&(!o.isLocked()||t))try{r=JSON.parse(r);var i={forms:r};t&&t.value&&(i.mapper=t.value),n&&n.value&&"null"!=n.value&&"undefined"!=n.value&&(i.batch=n.value),i.mapper||(i.mapper="user-"+u.getItem("device_id")),this.mappingServer.pushMapping(i,e.bind(function(e){e||u.removeItem("mapping-to-push")},this))}catch(e){u.removeItem("mapping-to-push")}},this))},this));var n=u.getItem("fieldData-to-push");if(n&&"{}"!=n){try{n=JSON.parse(n),this.mappingServer.saveFieldData({field_data:n,anonId:o.getAnonymousId()})}catch(e){}u.removeItem("fieldData-to-push")}var i=u.getItem("trackerData-to-push");if(i&&"{}"!=i){try{i=JSON.parse(i),this.mappingServer.saveTrackerData({t:i,anonId:o.getAnonymousId(),"new":1})}catch(e){}u.removeItem("trackerData-to-push")}var a=u.getItem("pageData-to-push");if(a&&"{}"!=a){try{a=JSON.parse(a),this.mappingServer.savePageData({p:a,anonId:o.getAnonymousId()})}catch(e){}u.removeItem("pageData-to-push")}}else u.removeItem("pageData-to-push"),u.removeItem("trackerData-to-push"),u.removeItem("fieldData-to-push"),u.removeItem("mapping-to-push")},this)),this.mappingServer.getMappingVersion(e.bind(function(i,s){i?this.delayDailyMappingCheck(function(){n()}):r.Preference.findBy("key","mapping-version",e.bind(function(i){!i||parseInt(i.value)<parseInt(s)?(r.Preference.createOrModify({key:"mapping-version",value:s},d),this.mappingServer.getMappings(e.bind(function(i,s){i?this.delayDailyMappingCheck(function(){n()}):(s.new_version&&s.new_version!=ABINE_DNTME.config.version?r.Preference.createOrModify({key:"new_version",value:s.new_version},d):r.Preference.removeByKey("new_version"),s.mappings&&this.processMapping(s,n),s.panels&&r.Preference.createOrModify({key:"lastUserState",value:a.user_state},e.bind(function(){l.panelsModule.processPanelData({panels:s.panels})},this)),t&&t())},this))):this.writeDailyMappingCheckPref(e.bind(function(){this.delayDailyMappingCheck(function(){t&&t()})},this))},this))},this))},this);r.Preference.batchFindBy([{by:"key",value:"shouldSendErrorReports"},{by:"key",value:"dynamicPanels"},{by:"key",value:"hasRegistered"},{by:"key",value:"entitledToPhone"}],e.bind(function(t){if(t.hasRegistered&&t.hasRegistered.isTrue()?t.entitledToPhone&&t.entitledToPhone.isTrue()?a.user_state="premium":a.user_state="registered":a.user_state="unregistered",t.dynamicPanels){var n=JSON.parse(t.dynamicPanels.value);e.each(n.panels,function(e){a.current_panels||(a.current_panels=[]),a.current_panels.push(e.id)})}a.current_panels||(a.current_panels=[-1]),t.shouldSendErrorReports&&t.shouldSendErrorReports.isTrue()?r.PanelActivity.index(null,e.bind(function(t){e.each(t,function(e){e.isMarketingPanel()&&e.hasData()&&(a.panel_data||(a.panel_data={}),a.panel_data[e.panelId]=e.toJSON())}),a.panel_data?s(function(){e.each(t,function(e){e.panelId in a.panel_data&&e.reset(a.panel_data[e.panelId])}),i.flush()}):s()},this)):s()},this))},this)))},writeDailyMappingCheckPref:function(e){e=e||d,r.Preference.findOrCreate({key:"lastMappingCheck"},function(t){t.value=Math.floor(f().valueOf()),t.modifiedAt=f(),i.flush(function(){e()})})},sendTrackerAllow:function(e,t,n,r){t=t.replace(/[\?].+$/,""),this.mappingServer.sendTrackerAllow({domain:e,url:t,tracker:n,version:r})},delayDailyMappingCheck:function(t){t=t||d;var r=18e5+36e5*Math.random();this.dailyMappingCheckTimeout&&n.clearTimeout(this.dailyMappingCheckTimeout),this.dailyMappingCheckTimeout=n.setTimeout(e.bind(this.startDailyMappingCheck,this),r),t()},getMapperDetails:function(t){this.mappingServer.getMapperDetails({},e.bind(function(e,n){e?t():t(n)},this))},getOneFormMappings:function(t,n){this.mappingServer.getOneFormMappings(t,e.bind(function(e,t){e?n():n(t)},this))},sendAutofillFeedback:function(t,n){this.mappingServer.sendAutofillFeedback(t,e.bind(function(e,t){e?n():n(t)},this))},sendFormBlob:function(t,n){this.mappingServer.sendFormBlob(t,e.bind(function(e,t){e?n():n(t)},this))}}),m=new p({});return l.mappingsModule=m,m}),ABINE_DNTME.define("abine/modules/criticalProcess",["documentcloud/underscore","abine/core","abine/timer","storage","persistence","modules"],function(e,t,n,r,i,a){var s=function(){},o=t.BaseClass.extend({initialize:function(e,t){t=t||s},setMessenger:function(e){this.messenger=e},start:function(e){this.messenger.broadcast("background:criticalprocess:start",e)},end:function(e){this.messenger.broadcast("background:criticalprocess:end",e)},update:function(e){this.messenger.broadcast("background:criticalprocess:update",e)},askForReview:function(e){this.messenger.broadcast("background:criticalprocess:review",e)},error:function(e){this.messenger.broadcast("background:criticalprocess:error",e)}}),c=new o({});return a.criticalProcess=c,c}),ABINE_DNTME.define("abine/modules/payments",["documentcloud/underscore","abine/core","abine/timer","storage","persistence","modules","abine/paymentsServer","abine/memoryStore"],function(e,t,n,r,i,a,s,o){var c=t.BaseClass.extend({initialize:function(e){this.paymentsServer=e.paymentsServer||new s},retrieveCardCredit:function(t){this.paymentsServer.retrieveCardCredit({},e.bind(function(e,n){e?t(e):t(null,n)}))},retrieveCardFee:function(t,n){this.paymentsServer.retrieveCardFee(t,e.bind(function(e,t){e?n(e):n(null,t)}))},verifyCardRequest:function(t,n){o.get("biometricKeyToken",e.bind(function(r){r&&(t.old_token=r),this.paymentsServer.verifyCardRequest(t,e.bind(function(e,t){e?n(e):n(null,t)}))},this))}}),l=new c({});return a.paymentsModule=l,l}),ABINE_DNTME.define("abine/modules/phone",["documentcloud/underscore","abine/core","abine/timer","storage","persistence","modules","abine/phoneServer"],function(e,t,n,r,i,a,s){var o=function(){},c=t.BaseClass.extend({initialize:function(e){this.phoneServer=e.phoneServer||new s},getPhone:function(t,n){n=n||o,this.phoneServer.getPhone(t,e.bind(function(e,t){n(e,t)},this))},logDisposableFilled:function(t,n){n=n||o,this.phoneServer.logDisposableFilled(t,e.bind(function(e,t){n(e,t)},this))},restorePhone:function(t,n){n=n||o,this.phoneServer.restorePhone(t,e.bind(function(e,t){n(e,t)},this))}}),l=new c({});return a.phoneModule=l,l}),ABINE_DNTME.define("abine/modules/email",["documentcloud/underscore","abine/core","abine/timer","storage","persistence","modules","abine/emailServer"],function(e,t,n,r,i,a,s){var o=function(){},c=t.BaseClass.extend({initialize:function(e){this.server=e.server||new s},sendDomainFeedback:function(t,n){n=n||o,this.server.sendDomainFeedback(t,e.bind(function(e,t){e?n(e):n(null,t)}))}}),c=new c({});return a.EmailModule=c,c}),ABINE_DNTME.define("modules",[],function(){return{}}),ABINE_DNTME.require("abine/modules/license"),ABINE_DNTME.require("abine/modules/payments"),ABINE_DNTME.require("abine/modules/panels"),ABINE_DNTME.require("abine/modules/phone"),ABINE_DNTME.require("abine/modules/mappings"),ABINE_DNTME.require("abine/modules/criticalProcess"),ABINE_DNTME.require("abine/modules/email"),ABINE_DNTME.require("abine/storage/blacklist"),ABINE_DNTME.require("abine/storage/disposableCard"),ABINE_DNTME.require("abine/storage/disposableEmail"),ABINE_DNTME.require("abine/storage/disposablePhone"),ABINE_DNTME.require("abine/storage/loginUrl"),ABINE_DNTME.require("abine/storage/extensionVersion"),ABINE_DNTME.require("abine/storage/autofillFeedback"),ABINE_DNTME.require("abine/storage/mappedForm"),ABINE_DNTME.require("abine/storage/mappedField"),ABINE_DNTME.require("abine/storage/panelActivity"),ABINE_DNTME.require("abine/storage/preference"),ABINE_DNTME.require("abine/storage/shieldedCard"),ABINE_DNTME.require("abine/storage/shieldedEmail"),ABINE_DNTME.require("abine/storage/shieldedPhone"),ABINE_DNTME.require("abine/storage/emailDomain"),ABINE_DNTME.require("abine/storage/fieldData"),ABINE_DNTME.require("abine/storage/trackerData"),ABINE_DNTME.require("abine/storage/pageData"),ABINE_DNTME.require("abine/storage/tabData"),ABINE_DNTME.require("abine/storage/address"),ABINE_DNTME.require("abine/storage/identity"),ABINE_DNTME.require("abine/storage/accountHistory"),ABINE_DNTME.require("abine/storage/account"),ABINE_DNTME.require("abine/storage/companyAccount"),ABINE_DNTME.require("abine/storage/realCard"),ABINE_DNTME.require("abine/storage/globalData"),ABINE_DNTME.require("abine/storage/dntStats"),ABINE_DNTME.require("abine/storage/note"),ABINE_DNTME.require("abine/storage/trackerInfo"),ABINE_DNTME.require("abine/storage/advt"),ABINE_DNTME.context="BG",ABINE_DNTME.define("aws",function(){return ABINE_DNTME.AWS=AWS,AWS}),ABINE_DNTME.require(["documentcloud/underscore","abine/window","abine/backgroundMessenger","abine/backgroundInit","abine/eventLogger","abine/stubs","abine/contextMenu","abine/webapp","abine/localStorage","abine/blurstore-api"],function(e,t,n,r,i,a,s,o,c){function l(){chrome.windows.getLastFocused({populate:!0},function(e){for(var t=0;t<e.tabs.length;t++)if(e.tabs[t].active){u.trigger("toolbar:clicked",{tabId:e.tabs[t].id});break}})}ABINE_DNTME.MASKME_EXTENSION_ID={dpkiidbpeijnaaacjlfnijncdlkicejg:1,klmeacceapcofljgjhopncjdlekjjmpp:1},ABINE_DNTME.userAgent=window.navigator.userAgent,chrome.runtime&&chrome.runtime.onMessageExternal&&chrome.runtime.onMessageExternal.addListener(function(e,t){t.id in ABINE_DNTME.MASKME_EXTENSION_ID&&(ABINE_DNTME.maskme_installed=!0,c.setItem("maskme.installed","1"))});var u=new n.BackgroundMessenger;ABINE_DNTME.backgroundMessenger=u,r.once("storage:initialized",function(){chrome.browserAction.onClicked.addListener(function(){"development"===ABINE_DNTME.config.environment,l()}),s.contextMenuHelper.init(u),chrome.tabs.query({},function(e){for(var t={file:"old_tab_content.js",allFrames:!1,runAt:"document_idle"},n=0;n<e.length;n++)try{e[n].url.indexOf(ABINE_DNTME.config.webAppHost)==-1&&0==e[n].url.indexOf("http")&&chrome.tabs.executeScript(e[n].id,t)}catch(e){}}),o.reload()}),r.initialize(u),chrome.extension.onRequest.addListener(function(e,t){function n(e){if(!(e>=r.length)){if(r[e].file)var i=r[e];else var i={file:r[e],allFrames:!0,runAt:"document_idle"};"undefined"!=typeof t.frameId&&t.frameId&&(delete i.allFrames,i.frameId=t.frameId),chrome.tabs.executeScript(t.tab.id,i,function(){n(e+1)})}}if(!ABINE_DNTME.maskme_installed)if("injectContentScript"==e.eventName){var r=["almond-min.js","jquery-min.js","underscore-min.js","backbone-min.js","common.js","common-content.js"];r.push(e.payload),n(0)}else"processFormsInNewFrame"==e.eventName&&u.send("contentManager:processNewFrame",e.frame_id,t.tab.id)});Date.now()-ABINE_DNTME.startTime});